"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[64088],{3905:(e,n,a)=>{a.d(n,{Zo:()=>u,kt:()=>m});var t=a(67294);function l(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function r(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function s(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(Object(a),!0).forEach((function(n){l(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function i(e,n){if(null==e)return{};var a,t,l=function(e,n){if(null==e)return{};var a,t,l={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||(l[a]=e[a]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var o=t.createContext({}),c=function(e){var n=t.useContext(o),a=n;return e&&(a="function"==typeof e?e(n):s(s({},n),e)),a},u=function(e){var n=c(e.components);return t.createElement(o.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},p=t.forwardRef((function(e,n){var a=e.components,l=e.mdxType,r=e.originalType,o=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(a),m=l,h=p["".concat(o,".").concat(m)]||p[m]||d[m]||r;return a?t.createElement(h,s(s({ref:n},u),{},{components:a})):t.createElement(h,s({ref:n},u))}));function m(e,n){var a=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=a.length,s=new Array(r);s[0]=p;var i={};for(var o in n)hasOwnProperty.call(n,o)&&(i[o]=n[o]);i.originalType=e,i.mdxType="string"==typeof e?e:l,s[1]=i;for(var c=2;c<r;c++)s[c]=a[c];return t.createElement.apply(null,s)}return t.createElement.apply(null,a)}p.displayName="MDXCreateElement"},7209:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var t=a(87462),l=(a(67294),a(3905));const r={slug:"elasticsearch-cheat-sheet",title:"Elasticsearch Cheat Sheet",authors:"mpolinowski",tags:["LINUX","Elasticsearch"]},s=void 0,i={unversionedId:"DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/cheat-sheet",id:"DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/cheat-sheet",title:"Elasticsearch Cheat Sheet",description:"Source: JoliCode",source:"@site/docs/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/cheat-sheet.md",sourceDirName:"DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries",slug:"/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/elasticsearch-cheat-sheet",permalink:"/docs/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/elasticsearch-cheat-sheet",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/cheat-sheet.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"},{label:"Elasticsearch",permalink:"/docs/tags/elasticsearch"}],version:"current",frontMatter:{slug:"elasticsearch-cheat-sheet",title:"Elasticsearch Cheat Sheet",authors:"mpolinowski",tags:["LINUX","Elasticsearch"]},sidebar:"tutorialSidebar",previous:{title:"Log all the searches going through Elasticsearch",permalink:"/docs/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/2021-03-25"},next:{title:"Logstash 7 and Common Log Pattern",permalink:"/docs/DevOps/Elasticsearch/2021-03-24-logstash-common-grok-pattern/2021-03-24"}},o={},c=[{value:"Queries",id:"queries",level:2},{value:"Control total hit count",id:"control-total-hit-count",level:2},{value:"QueryString syntax",id:"querystring-syntax",level:2},{value:"Search After - Pagination cursor",id:"search-after---pagination-cursor",level:2},{value:"Indexes and mapping",id:"indexes-and-mapping",level:2},{value:"Get the mapping and the settings",id:"get-the-mapping-and-the-settings",level:2},{value:"Create a document (auto-generated ID)",id:"create-a-document-auto-generated-id",level:2},{value:"Create or update a document",id:"create-or-update-a-document",level:2},{value:"Delete a document",id:"delete-a-document",level:2},{value:"Open and close indexes to save memory and CPU",id:"open-and-close-indexes-to-save-memory-and-cpu",level:2},{value:"Remove and create aliases",id:"remove-and-create-aliases",level:2},{value:"List aliases",id:"list-aliases",level:2},{value:"Full custom analyzer declaration",id:"full-custom-analyzer-declaration",level:2},{value:"Indices monitoring and information",id:"indices-monitoring-and-information",level:2},{value:"Indices status and management",id:"indices-status-and-management",level:2},{value:"Reindex API",id:"reindex-api",level:2},{value:"Simple Reindex Operation",id:"simple-reindex-operation",level:3},{value:"Selective Reindex Operation",id:"selective-reindex-operation",level:3},{value:"Debug and development",id:"debug-and-development",level:2},{value:"Queries",id:"queries-1",level:3},{value:"Analysis",id:"analysis",level:3},{value:"Slowlog",id:"slowlog",level:2},{value:"Cluster and node information",id:"cluster-and-node-information",level:2},{value:"Updating settings",id:"updating-settings",level:2},{value:"Snapshots and Restore",id:"snapshots-and-restore",level:2}],u={toc:c};function d(e){let{components:n,...a}=e;return(0,l.kt)("wrapper",(0,t.Z)({},u,a,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"Source: ",(0,l.kt)("a",{parentName:"em",href:"https://github.com/jolicode/elasticsearch-cheatsheet"},"JoliCode"))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#queries"},"Queries")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#control-total-hit-count"},"Control total hit count")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#querystring-syntax"},"QueryString syntax")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#search-after---pagination-cursor"},"Search After - Pagination cursor")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#indexes-and-mapping"},"Indexes and mapping")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#get-the-mapping-and-the-settings"},"Get the mapping and the settings")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#create-a-document-auto-generated-id"},"Create a document (auto-generated ID)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#create-or-update-a-document"},"Create or update a document")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#delete-a-document"},"Delete a document")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#open-and-close-indexes-to-save-memory-and-cpu"},"Open and close indexes to save memory and CPU")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#remove-and-create-aliases"},"Remove and create aliases")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#list-aliases"},"List aliases")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#full-custom-analyzer-declaration"},"Full custom analyzer declaration")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#indices-monitoring-and-information"},"Indices monitoring and information")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#indices-status-and-management"},"Indices status and management")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#reindex-api"},"Reindex API"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#simple-reindex-operation"},"Simple Reindex Operation")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#selective-reindex-operation"},"Selective Reindex Operation")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#debug-and-development"},"Debug and development"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#queries-1"},"Queries")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#analysis"},"Analysis")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#slowlog"},"Slowlog")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#cluster-and-node-information"},"Cluster and node information")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#updating-settings"},"Updating settings")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#snapshots-and-restore"},"Snapshots and Restore"))),(0,l.kt)("h2",{id:"queries"},"Queries"),(0,l.kt)("p",null,"There are two syntaxes for the basic queries: a simple one on the left, where you can't use any option, and an extended one on the right. Most of the beginner headache with the DSL come from this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET _search\n{\n  "query": {\n    "match": {\n      "FIELD": "TEXT"\n    }\n  }\n}\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET _search\n{\n  "query": {\n    "match": {\n      "FIELD": {\n        "query": "TEXT",\n        "OPTION": "VALUE"\n      }\n    }\n  }\n}\n')),(0,l.kt)("p",null,"Full search example with aggregation, highlight, filter..."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET /_search\n{\n  "query": {\n    "bool": {\n      "must": [\n        {\n          "match": {\n            "title": "smith"\n          }\n        }\n      ],\n      "must_not": [\n        {\n          "match_phrase": {\n            "title": "granny smith"\n          }\n        }\n      ],\n      "filter": [\n        {\n          "exists": {\n            "field": "title"\n          }\n        }\n      ]\n    }\n  },\n  "aggs": {\n    "my_agg": {\n      "terms": {\n        "field": "user",\n        "size": 10\n      }\n    }\n  },\n  "highlight": {\n    "pre_tags": [\n      "<em>"\n    ],\n    "post_tags": [\n      "</em>"\n    ],\n    "fields": {\n      "body": {\n        "number_of_fragments": 1,\n        "fragment_size": 20\n      },\n      "title": {}\n    }\n  },\n  "size": 20,\n  "from": 100,\n  "_source": [\n    "title",\n    "id"\n  ],\n  "sort": [\n    {\n      "_id": {\n        "order": "desc"\n      }\n    }\n  ]\n}\n')),(0,l.kt)("h2",{id:"control-total-hit-count"},"Control total hit count"),(0,l.kt)("p",null,"Accept true, false or a fixed number, default to 10000."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET /_search\n{\n  "track_total_hits": true,\n  "query": {}\n}\nCommon queries\n"multi_match": {\n  "query": "Elastic",\n  "fields": ["user.*", "title^3"],\n  "type": "best_fields"\n}\n"bool": {\n  "must": [],\n  "must_not": [],\n  "filter": [],\n  "should": [],\n  "minimum_should_match" : 1\n}\n"range": {\n  "age": {\n    "gte": 10,\n    "lte": 20,\n    "boost": 2\n  }\n}\n')),(0,l.kt)("h2",{id:"querystring-syntax"},"QueryString syntax"),(0,l.kt)("p",null,"Search in the default ",(0,l.kt)("em",{parentName:"p"},"_","all field"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},"GET /_search?q=pony\n")),(0,l.kt)("p",null,"Complex search with operator and exact phrase search with boost:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET /_search?q=title:(joli OR code) AND author:"Damien Alexandre"^2\n')),(0,l.kt)("p",null,"Search with wildcard and special queries:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},"GET /_search?q=_exists_:title OR title:singl? noneOrAnyChar*cter\n")),(0,l.kt)("p",null,"Search with fuzzyness and range:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},"GET /_search?q=title:elastichurch~3 AND date:[2016-01-01 TO 2018-12-31]\n")),(0,l.kt)("p",null,"Use in Query DSL (not recommended for user search):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET /_search\n{\n  "query": {\n    "query_string": {\n      "default_field": "content",\n      "query": "elastic AND (title:lucene OR title:solr)"\n    }\n  }\n}\n')),(0,l.kt)("h2",{id:"search-after---pagination-cursor"},"Search After - Pagination cursor"),(0,l.kt)("p",null,"Search with a custom sort:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET products/_search\n{\n    "size": 10,\n    "sort": [\n        {"date": "asc"},\n        {"_id": "desc"}\n    ]\n}\n')),(0,l.kt)("p",null,'On the next "page", pass the sort values from the last result:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET product/_search\n{\n    "size": 10,\n    "search_after": [1463538857, "654323"],\n    "sort": [\n        {"date": "asc"},\n        {"_id": "desc"}\n    ]\n}\n')),(0,l.kt)("h2",{id:"indexes-and-mapping"},"Indexes and mapping"),(0,l.kt)("p",null,"Create an index with settings and mapping"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'PUT /my_index_name\n{\n  "settings": {\n    "number_of_replicas": 1,\n    "number_of_shards": 3,\n    "analysis": {},\n    "refresh_interval": "1s"\n  },\n  "mappings": {\n    "dynamic": false,\n    "properties": {\n      "title": {\n        "type": "text",\n        "analyzer": "english"\n      }\n    }\n  }\n}\n')),(0,l.kt)("h2",{id:"get-the-mapping-and-the-settings"},"Get the mapping and the settings"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"GET /my_index_name\nGET /my_index_name/_mapping\nGET /my_index_name/_settings\n")),(0,l.kt)("h2",{id:"create-a-document-auto-generated-id"},"Create a document (auto-generated ID)"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'POST /my_index_name/_doc\n{\n  "title": "Elastic is funny",\n  "tag": [\n    "lucene"\n  ]\n}\n')),(0,l.kt)("h2",{id:"create-or-update-a-document"},"Create or update a document"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'PUT /my_index_name/_doc/12abc\n{\n  "title": "Elastic is funny",\n  "tag": [\n    "lucene"\n  ]\n}\n')),(0,l.kt)("h2",{id:"delete-a-document"},"Delete a document"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"DELETE /my_index_name/_doc/12abc\n")),(0,l.kt)("h2",{id:"open-and-close-indexes-to-save-memory-and-cpu"},"Open and close indexes to save memory and CPU"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"POST /my_index_name/_close\nPOST /my_index_name/_open\n")),(0,l.kt)("h2",{id:"remove-and-create-aliases"},"Remove and create aliases"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'POST /_aliases\n{\n  "actions": [\n    {\n      "remove": {\n        "index": "my_index_name",\n        "alias": "foo"\n      }\n    },\n    {\n      "add": {\n        "index": "my_index_name",\n        "alias": "bar",\n        "filter" : { "term" : { "user" : "damien" } }\n      }\n    }\n  ]\n}\n')),(0,l.kt)("h2",{id:"list-aliases"},"List aliases"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"GET /_aliases\nGET /my_index_name/_alias/*\nGET /*/_alias/*\nGET /*/_alias/foo\n")),(0,l.kt)("h2",{id:"full-custom-analyzer-declaration"},"Full custom analyzer declaration"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'PUT /english_example\n{\n  "settings": {\n    "analysis": {\n      "filter": {\n        "english_stop": {\n          "type":       "stop",\n          "stopwords":  "_english_"\n        },\n        "english_stemmer": {\n          "type":       "stemmer",\n          "language":   "english"\n        }\n      },\n      "analyzer": {\n        "my_english": {\n          "char_filter":  ["html_strip"],\n          "tokenizer":  "standard",\n          "filter": [\n            "lowercase",\n            "english_stop",\n            "english_stemmer"\n          ]\n        }\n      }\n    }\n  }\n}\n')),(0,l.kt)("h2",{id:"indices-monitoring-and-information"},"Indices monitoring and information"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"GET /my_index_name/_stats\nGET /my_index_name/_segments\nGET /my_index_name/_recovery?pretty&human\n")),(0,l.kt)("h2",{id:"indices-status-and-management"},"Indices status and management"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"POST /my_index_name/_cache/clear\nPOST /my_index_name/_refresh\nPOST /my_index_name/_flush\nPOST /my_index_name/_forcemerge\n")),(0,l.kt)("h2",{id:"reindex-api"},"Reindex API"),(0,l.kt)("h3",{id:"simple-reindex-operation"},"Simple Reindex Operation"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'POST /_reindex\n{\n  "source": {\n    "index": "test-index"\n  },\n  "dest": {\n    "index": "test-index-new"\n  }\n}\n')),(0,l.kt)("h3",{id:"selective-reindex-operation"},"Selective Reindex Operation"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'POST /_reindex\n{\n  "source": {\n    "index": "test-index",\n    "query": {\n      "match": {\n        "gender": "female"\n      }\n    }\n  },\n  "dest": {\n    "index": "test-index-new",\n    "type": "female"\n  }\n}\n')),(0,l.kt)("h2",{id:"debug-and-development"},"Debug and development"),(0,l.kt)("h3",{id:"queries-1"},"Queries"),(0,l.kt)("p",null,"Get a detailed view of what a query do:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET /blog/_validate/query?explain=true\n{\n  "query": {\n    "match": {\n      "title": "Smith"\n    }\n  }\n}\n')),(0,l.kt)("p",null,"Get an explanation about a document matching or not:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET /blog/_doc/1/_explain\n{\n  "query": {\n    "match": {\n      "title": "Smith"\n    }\n  }\n}\n')),(0,l.kt)("h3",{id:"analysis"},"Analysis"),(0,l.kt)("p",null,"Test how a content is tokenized in a field:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET /blog/_analyze\n{\n  "field": "title",\n  "text": "powerful"\n}\n')),(0,l.kt)("p",null,"Test analyzer token output by analyzer:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'GET /blog/_analyze\n{\n  "analyzer": "english",\n  "text": "powerful"\n}\n')),(0,l.kt)("h2",{id:"slowlog"},"Slowlog"),(0,l.kt)("p",null,"Lower the slowlog threshold to see all the search queries in the logs:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'PUT /blog/_settings\n{\n  "index.search.slowlog.threshold.query.trace": "0s",\n  "index.search.slowlog.level": "trace"\n}\n')),(0,l.kt)("p",null,"Go back to the default configuration:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'PUT /blog/_settings\n{\n  "index.search.slowlog.threshold.query.trace": "500ms",\n  "index.search.slowlog.level": "info"\n}\n')),(0,l.kt)("h2",{id:"cluster-and-node-information"},"Cluster and node information"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"GET /_cluster/health?pretty\nGET /_cluster/health?wait_for_status=yellow&timeout=50s\nGET /_cluster/state\nGET /_cluster/stats?human&pretty\nGET /_cluster/pending_tasks\nGET /_nodes\nGET /_nodes/stats\nGET /_nodes/nodeId1,nodeId2/stats\n")),(0,l.kt)("p",null,"Get the full reference of all the settings:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"GET /_cluster/settings?include_defaults=true&flat_settings=true\n")),(0,l.kt)("h2",{id:"updating-settings"},"Updating settings"),(0,l.kt)("p",null,"Disable shard allocation, useful before a rolling restart:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'PUT /_cluster/settings\n{\n    "transient" : {\n        "cluster.routing.allocation.enable" : "none"\n    }\n}\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'PUT /_cluster/settings\n{\n    "transient" : {\n        "cluster.routing.allocation.enable" : "all"\n    }\n}\n')),(0,l.kt)("h2",{id:"snapshots-and-restore"},"Snapshots and Restore"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'PUT /_snapshot/my_backup\n{\n  "type": "fs",\n  "settings": {\n    "location": "my_backup_location"\n  }\n}\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'PUT /_snapshot/my_backup/snapshot_a\n{\n  "indices": "index_1,index_2",\n  "ignore_unavailable": "true",\n  "include_global_state": false\n}\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'POST /_snapshot/my_backup/snapshot_a/_restore\n{\n  "indices": "index_1,index_2",\n  "ignore_unavailable": "true",\n  "include_global_state": false,\n  "rename_pattern": "index_(.+)",\n  "rename_replacement": "restored_index_$1"\n}\n')))}d.isMDXComponent=!0}}]);