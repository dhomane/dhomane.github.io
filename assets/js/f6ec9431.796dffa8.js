"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[55787],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=r.createContext({}),u=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=u(e.components);return r.createElement(i.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=u(n),m=o,f=p["".concat(i,".").concat(m)]||p[m]||c[m]||a;return n?r.createElement(f,l(l({ref:t},d),{},{components:n})):r.createElement(f,l({ref:t},d))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,l=new Array(a);l[0]=p;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:o,l[1]=s;for(var u=2;u<a;u++)l[u]=n[u];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},64175:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>c,frontMatter:()=>a,metadata:()=>s,toc:()=>u});var r=n(87462),o=(n(67294),n(3905));const a={sidebar_position:8e3,slug:"2020-10-13",title:"HDD Smart Tools for LINUX",authors:"mpolinowski",tags:["LINUX"]},l=void 0,s={unversionedId:"DevOps/Linux/2020-10-13--smarttools-centos/index",id:"DevOps/Linux/2020-10-13--smarttools-centos/index",title:"HDD Smart Tools for LINUX",description:"Victoria Harbour, Hong Kong",source:"@site/docs/DevOps/Linux/2020-10-13--smarttools-centos/index.md",sourceDirName:"DevOps/Linux/2020-10-13--smarttools-centos",slug:"/DevOps/Linux/2020-10-13--smarttools-centos/2020-10-13",permalink:"/docs/DevOps/Linux/2020-10-13--smarttools-centos/2020-10-13",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Linux/2020-10-13--smarttools-centos/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"}],version:"current",sidebarPosition:8e3,frontMatter:{sidebar_position:8e3,slug:"2020-10-13",title:"HDD Smart Tools for LINUX",authors:"mpolinowski",tags:["LINUX"]},sidebar:"tutorialSidebar",previous:{title:"Activating Root Login on Ubuntu 20.10",permalink:"/docs/DevOps/Linux/2020-10-20--activating-root-login-ubuntu-20-10/2020-10-20"},next:{title:"Installing FirewallD on CentOS 8",permalink:"/docs/DevOps/Linux/2020-01-07--centos8-firewalld/2020-01-05"}},i={},u=[{value:"SmartCTL",id:"smartctl",level:2},{value:"Check SMART Support Enabled",id:"check-smart-support-enabled",level:3},{value:"Check Supported Tests",id:"check-supported-tests",level:3},{value:"Self Test",id:"self-test",level:3},{value:"Short Test",id:"short-test",level:4},{value:"Check Tresholds",id:"check-tresholds",level:3},{value:"Long Test",id:"long-test",level:4},{value:"Dead Letter",id:"dead-letter",level:2}],d={toc:u};function c(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Victoria Harbour, Hong Kong",src:n(15956).Z,width:"1500",height:"509"})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#smartctl"},"SmartCTL"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#check-smart-support-enabled"},"Check SMART Support Enabled")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#check-supported-tests"},"Check Supported Tests")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#self-test"},"Self Test"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#short-test"},"Short Test")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#check-tresholds"},"Check Tresholds"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#long-test"},"Long Test")))))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#dead-letter"},"Dead Letter"))),(0,o.kt)("h2",{id:"smartctl"},"SmartCTL"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yum install smartmontools\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"Dependencies Resolved\n\n                                         Version    Repository           Size\n==============================================================================\n smartmontools                           x86_64     1:7.0-2.el7   base   546 k\nInstalling for dependencies:\n mailx                                   x86_64     12.5-19.el7   base   245 k\n\nTransaction Summary\n===============================================================================\n\nTotal download size: 791 k\nInstalled size: 2.4 M\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"smartctl --scan\n\n/dev/sda -d scsi # /dev/sda, SCSI device\n")),(0,o.kt)("h3",{id:"check-smart-support-enabled"},"Check SMART Support Enabled"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"smartctl /dev/sda -i\n\nsmartctl 7.0 2018-12-30 r4883 [x86_64-linux-3.10.0-1127.19.1.el7.x86_64] (local build)\nCopyright (C) 2002-18, Bruce Allen, Christian Franke, www.smartmontools.org\n\n=== START OF INFORMATION SECTION ===\nModel Family:     Hitachi Deskstar 7K3000\nDevice Model:     Hitachi HDS723020BLA642\nSerial Number:    MN1270FA069J4D\nLU WWN Device Id: 5 000cca 36ac2ddf7\nFirmware Version: MN6OA800\nUser Capacity:    2,000,398,934,016 bytes [2.00 TB]\nSector Size:      512 bytes logical/physical\nRotation Rate:    7200 rpm\nForm Factor:      3.5 inches\nDevice is:        In smartctl database [for details use: -P show]\nATA Version is:   ATA8-ACS T13/1699-D revision 4\nSATA Version is:  SATA 2.6, 6.0 Gb/s (current: 3.0 Gb/s)\nLocal Time is:    Tue Oct 13 08:54:04 2020 CEST\nSMART support is: Available - device has SMART capability.\nSMART support is: Enabled\n")),(0,o.kt)("h3",{id:"check-supported-tests"},"Check Supported Tests"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"smartctl /dev/sda -c\n\nsmartctl 7.0 2018-12-30 r4883 [x86_64-linux-3.10.0-1127.19.1.el7.x86_64] (local build)\nCopyright (C) 2002-18, Bruce Allen, Christian Franke, www.smartmontools.org\n\n=== START OF READ SMART DATA SECTION ===\nGeneral SMART Values:\nOffline data collection status:  (0x84) Offline data collection activity\n                                        was suspended by an interrupting command from host.\n                                        Auto Offline Data Collection: Enabled.\nSelf-test execution status:      (   0) The previous self-test routine completed\n                                        without error or no self-test has ever \n                                        been run.\nTotal time to complete Offline \ndata collection:                (19092) seconds.\nOffline data collection\ncapabilities:                    (0x5b) SMART execute Offline immediate.\n                                        Auto Offline data collection on/off support.\n                                        Suspend Offline collection upon new\n                                        command.\n                                        Offline surface scan supported.\n                                        Self-test supported.\n                                        No Conveyance Self-test supported.\n                                        Selective Self-test supported.\nSMART capabilities:            (0x0003) Saves SMART data before entering\n                                        power-saving mode.\n                                        Supports SMART auto save timer.\nError logging capability:        (0x01) Error logging supported.\n                                        General Purpose Logging supported.\nShort self-test routine \nrecommended polling time:        (   1) minutes.\nExtended self-test routine\nrecommended polling time:        ( 319) minutes.\nSCT capabilities:              (0x003d) SCT Status supported.\n                                        SCT Error Recovery Control supported.\n                                        SCT Feature Control supported.\n                                        SCT Data Table supported.\n")),(0,o.kt)("p",null,"Supported Test:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Offline surface scan supported."),(0,o.kt)("li",{parentName:"ul"},"Self-test supported."),(0,o.kt)("li",{parentName:"ul"},"No Conveyance Self-test supported."),(0,o.kt)("li",{parentName:"ul"},"Selective Self-test supported.")),(0,o.kt)("h3",{id:"self-test"},"Self Test"),(0,o.kt)("p",null,"Check Logs:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"smartctl -l selftest /dev/sda\n\nsmartctl 7.0 2018-12-30 r4883 [x86_64-linux-3.10.0-1127.19.1.el7.x86_64] (local build)\nCopyright (C) 2002-18, Bruce Allen, Christian Franke, www.smartmontools.org\n\n=== START OF READ SMART DATA SECTION ===\nSMART Self-test log structure revision number 1\nNum  Test_Description    Status                  Remaining  LifeTime(hours)  LBA_of_first_error\n# 1  Extended offline    Completed without error       00%     16237         -\n# 2  Extended offline    Completed without error       00%     16219         -\n# 3  Extended offline    Completed without error       00%     16199         -\n# 4  Extended offline    Completed without error       00%     16193         -\n# 5  Extended offline    Completed without error       00%     16176         -\n# 6  Short offline       Completed without error       00%     11338         -\n# 7  Short offline       Completed without error       00%     11315         -\n# 8  Short offline       Completed without error       00%     11290         -\n# 9  Short offline       Completed without error       00%     11266         -\n#10  Short offline       Completed without error       00%     11242         -\n#11  Short offline       Completed without error       00%     11218         -\n#12  Short offline       Completed without error       00%     11194         -\n#13  Short offline       Completed without error       00%     11170         -\n#14  Short offline       Completed without error       00%     11146         -\n#15  Short offline       Completed without error       00%     11122         -\n#16  Short offline       Completed without error       00%     11098         -\n#17  Short offline       Completed without error       00%     11074         -\n#18  Short offline       Completed without error       00%     11050         -\n#19  Short offline       Completed without error       00%     11026         -\n#20  Short offline       Completed without error       00%     11002         -\n#21  Short offline       Completed without error       00%     10978         -\n")),(0,o.kt)("h4",{id:"short-test"},"Short Test"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'smartctl -t short /dev/sda\n\nsmartctl 7.0 2018-12-30 r4883 [x86_64-linux-3.10.0-1127.19.1.el7.x86_64] (local build)\nCopyright (C) 2002-18, Bruce Allen, Christian Franke, www.smartmontools.org\n\n=== START OF OFFLINE IMMEDIATE AND SELF-TEST SECTION ===\nSending command: "Execute SMART Short self-test routine immediately in off-line mode".\nDrive command "Execute SMART Short self-test routine immediately in off-line mode" successful.\nTesting has begun.\nPlease wait 1 minutes for test to complete.\nTest will complete after Tue Oct 13 09:13:41 2020\n\nUse smartctl -X to abort test.\n')),(0,o.kt)("p",null,"Re-check the log:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"=== START OF READ SMART DATA SECTION ===\nSMART Self-test log structure revision number 1\nNum  Test_Description    Status                  Remaining  LifeTime(hours)  LBA_of_first_error\n# 1  Short offline       Completed without error       00%     51689         -\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"sudo smartctl -H /dev/sda")," gives us a quick assesment ",(0,o.kt)("strong",{parentName:"p"},"PASSED"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"smartctl -H /dev/sda\n\nsmartctl 7.0 2018-12-30 r4883 [x86_64-linux-3.10.0-1127.19.1.el7.x86_64] (local build)\nCopyright (C) 2002-18, Bruce Allen, Christian Franke, www.smartmontools.org\n\n=== START OF READ SMART DATA SECTION ===\nSMART overall-health self-assessment test result: PASSED\n")),(0,o.kt)("h3",{id:"check-tresholds"},"Check Tresholds"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"smartctl -a /dev/sda | less\n\nSMART Attributes Data Structure revision number: 16\nVendor Specific SMART Attributes with Thresholds:\nID# ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      UPDATED  WHEN_FAILED RAW_VALUE\n  1 Raw_Read_Error_Rate     0x000b   100   100   016    Pre-fail  Always       -       65536\n  2 Throughput_Performance  0x0005   135   135   054    Pre-fail  Offline      -       86\n  3 Spin_Up_Time            0x0007   225   225   024    Pre-fail  Always       -       255 (Average 255)\n  4 Start_Stop_Count        0x0012   100   100   000    Old_age   Always       -       24\n  5 Reallocated_Sector_Ct   0x0033   100   100   005    Pre-fail  Always       -       0\n  7 Seek_Error_Rate         0x000b   100   100   067    Pre-fail  Always       -       0\n  8 Seek_Time_Performance   0x0005   138   138   020    Pre-fail  Offline      -       25\n  9 Power_On_Hours          0x0012   093   093   000    Old_age   Always       -       51690\n 10 Spin_Retry_Count        0x0013   100   100   060    Pre-fail  Always       -       0\n 12 Power_Cycle_Count       0x0032   100   100   000    Old_age   Always       -       24\n192 Power-Off_Retract_Count 0x0032   100   100   000    Old_age   Always       -       622\n193 Load_Cycle_Count        0x0012   100   100   000    Old_age   Always       -       622\n194 Temperature_Celsius     0x0002   146   146   000    Old_age   Always       -       41 (Min/Max 25/54)\n196 Reallocated_Event_Count 0x0032   100   100   000    Old_age   Always       -       0\n197 Current_Pending_Sector  0x0022   100   100   000    Old_age   Always       -       0\n198 Offline_Uncorrectable   0x0008   100   100   000    Old_age   Offline      -       0\n199 UDMA_CRC_Error_Count    0x000a   200   200   000    Old_age   Always       -       2\n")),(0,o.kt)("p",null,"THRESH is manufacturer defined threshold, and in most cases if VALUE goes below this threshold disk is a toast and should be replaced immediately. ",(0,o.kt)("a",{parentName:"p",href:"http://static.googleusercontent.com/media/research.google.com/en//archive/disk_failures.pdf"},"s. Failure Trends in a Large Disk Drive Population"),"."),(0,o.kt)("h4",{id:"long-test"},"Long Test"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'smartctl -t long /dev/sda\n\nsmartctl 7.0 2018-12-30 r4883 [x86_64-linux-3.10.0-1127.19.1.el7.x86_64] (local build)\nCopyright (C) 2002-18, Bruce Allen, Christian Franke, www.smartmontools.org\n\n=== START OF OFFLINE IMMEDIATE AND SELF-TEST SECTION ===\nSending command: "Execute SMART Extended self-test routine immediately in off-line mode".\nDrive command "Execute SMART Extended self-test routine immediately in off-line mode" successful.\nTesting has begun.\nPlease wait 319 minutes for test to complete.\nTest will complete after Tue Oct 13 15:02:09 2020\n\nUse smartctl -X to abort test.\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Please wait 319 minutes for test to complete.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"smartctl -l selftest /dev/sda\n\nsmartctl 7.0 2018-12-30 r4883 [x86_64-linux-3.10.0-1127.19.1.el7.x86_64] (local build)\nCopyright (C) 2002-18, Bruce Allen, Christian Franke, www.smartmontools.org\n\n=== START OF READ SMART DATA SECTION ===\nSMART Self-test log structure revision number 1\nNum  Test_Description    Status                  Remaining  LifeTime(hours)  LBA_of_first_error\n# 1  Extended offline    Completed without error       00%     51696         -\n# 2  Short offline       Completed without error       00%     51690         -\n")),(0,o.kt)("p",null,"The drive does not contain any errors."),(0,o.kt)("h2",{id:"dead-letter"},"Dead Letter"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ls -la\n-rw-r--r--   1 root mail 6.7K Sep 10 18:22 dead.letter\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cat dead.letter\n\nThis is an automatically generated mail message from mdadm\nrunning on CentOS-72-64-minimal\n\nA DegradedArray event had been detected on md device /dev/md/2.\n\nFaithfully yours, etc.\n\nP.S. The /proc/mdstat file currently contains the following:\n\nPersonalities : [raid1] \nmd2 : active raid1 sda3[0]\n      1451898240 blocks super 1.2 [2/1] [U_]\n      bitmap: 11/11 pages [44KB], 65536KB chunk\n\nmd1 : active raid1 sda2[0]\n      523712 blocks super 1.2 [2/1] [U_]\n      \nmd0 : active raid1 sda1[0]\n      12574720 blocks super 1.2 [2/1] [U_]\n      \nunused devices: <none>\n")),(0,o.kt)("p",null,"One of the two raided drives is gone -> ",(0,o.kt)("inlineCode",{parentName:"p"},"[U_]")," and has to be replaced."))}c.isMDXComponent=!0},15956:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-b57dcf7a42ddd712383aadde6d3ef4c8.jpg"}}]);