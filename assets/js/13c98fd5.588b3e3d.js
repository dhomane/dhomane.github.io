"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[12353],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>m});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var o=a.createContext({}),c=function(e){var n=a.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=c(e.components);return a.createElement(o.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,s=e.originalType,o=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(t),m=r,h=d["".concat(o,".").concat(m)]||d[m]||p[m]||s;return t?a.createElement(h,i(i({ref:n},u),{},{components:t})):a.createElement(h,i({ref:n},u))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=t.length,i=new Array(s);i[0]=d;var l={};for(var o in n)hasOwnProperty.call(n,o)&&(l[o]=n[o]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<s;c++)i[c]=t[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},4874:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var a=t(87462),r=(t(67294),t(3905));const s={sidebar_position:9030,slug:"2020-06-01",title:"Elasticsearch in Docker",authors:"mpolinowski",tags:["Databases","Docker","Elasticsearch"]},i=void 0,l={unversionedId:"DevOps/Elasticsearch/2020-06-01--elasticsearch-docker/index",id:"DevOps/Elasticsearch/2020-06-01--elasticsearch-docker/index",title:"Elasticsearch in Docker",description:"Shanghai, China",source:"@site/docs/DevOps/Elasticsearch/2020-06-01--elasticsearch-docker/index.mdx",sourceDirName:"DevOps/Elasticsearch/2020-06-01--elasticsearch-docker",slug:"/DevOps/Elasticsearch/2020-06-01--elasticsearch-docker/2020-06-01",permalink:"/docs/DevOps/Elasticsearch/2020-06-01--elasticsearch-docker/2020-06-01",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Elasticsearch/2020-06-01--elasticsearch-docker/index.mdx",tags:[{label:"Databases",permalink:"/docs/tags/databases"},{label:"Docker",permalink:"/docs/tags/docker"},{label:"Elasticsearch",permalink:"/docs/tags/elasticsearch"}],version:"current",sidebarPosition:9030,frontMatter:{sidebar_position:9030,slug:"2020-06-01",title:"Elasticsearch in Docker",authors:"mpolinowski",tags:["Databases","Docker","Elasticsearch"]},sidebar:"tutorialSidebar",previous:{title:"Elasticsearch 7 Refresher",permalink:"/docs/DevOps/Elasticsearch/2021-03-20-elasticsearch-7-refresher/2021-03-20"},next:{title:"Elasticsearch 7 with Docker Compose",permalink:"/docs/DevOps/Elasticsearch/2019-09-08--elasticsearch_7-5_docker/2019-09-08"}},o={},c=[{value:"Setup",id:"setup",level:2},{value:"MAPPING",id:"mapping",level:2},{value:"INDEX",id:"index",level:2},{value:"UPDATE",id:"update",level:3},{value:"DELETE",id:"delete",level:3},{value:"BULK",id:"bulk",level:3},{value:"SEARCH",id:"search",level:2},{value:"Cheat Sheet",id:"cheat-sheet",level:3}],u={toc:c};function p(e){let{components:n,...s}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,s,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Shanghai, China",src:t(76512).Z,width:"1500",height:"654"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#setup"},"Setup")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#mapping"},"MAPPING")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#index"},"INDEX"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#update"},"UPDATE")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#delete"},"DELETE")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#bulk"},"BULK")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#search"},"SEARCH"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#cheat-sheet"},"Cheat Sheet"))))),(0,r.kt)("h2",{id:"setup"},"Setup"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Download the this ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/mpolinowski/docker-elk"},"repository"),":")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/mpolinowski/docker-elk\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Disable paid security features:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# xpack.license.self_generated.type: trial\nxpack.license.self_generated.type: basic\n")),(0,r.kt)("p",null,"By changing your XPack license from ",(0,r.kt)("inlineCode",{parentName:"p"},"trial")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"basic"),": ",(0,r.kt)("inlineCode",{parentName:"p"},"elasticsearch/config/elasticsearch.yml"),"."),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"ELK Stack Version")),(0,r.kt)("p",null,"To use a different version of the core Elastic components, simply change the version number inside the ",(0,r.kt)("inlineCode",{parentName:"p"},"./.env")," file."),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"User Login")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"./docker-compose.yml")," file and take note of the ",(0,r.kt)("inlineCode",{parentName:"p"},"changeme")," password. The default user name is ",(0,r.kt)("inlineCode",{parentName:"p"},"elastic"),". (",(0,r.kt)("a",{parentName:"p",href:"https://github.com/deviantony/docker-elk#initial-setup"},"Changing your Login"),")"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Build your stack")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd ./docker-elk\ndocker-compose build\n")),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"Start Up")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose up -d\n")),(0,r.kt)("p",null,"You can now access Elasticsearch on ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:9200"),":"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"ELK Stack in Docker",src:t(84115).Z,width:"1153",height:"703"})),(0,r.kt)("p",null,"and Kibana on ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:5601"),":"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"ELK Stack in Docker",src:t(67307).Z,width:"1146",height:"477"})),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},"Shutdown & CleanUp")),(0,r.kt)("p",null,"In order to entirely shutdown the stack and remove all persisted data, use the following Docker Compose command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker-compose down -v\n")),(0,r.kt)("h2",{id:"mapping"},"MAPPING"),(0,r.kt)("p",null,"Continue by creating a mapping for your Elasticsearch index:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'PUT /wiki_ssr_en_2020_07_06\n{\n  "settings": {\n    "analysis": {\n      "analyzer": {\n        "custom_analyzer": {\n          "type": "custom",\n          "char_filter": [\n            "symbol",\n            "html_strip"\n          ],\n          "tokenizer": "punctuation",\n          "filter": [\n            "lowercase",\n            "word_delimiter",\n            "english_stop",\n            "english_stemmer"\n          ]\n        }\n      },\n      "filter": {\n        "english_stop": {\n          "type": "stop",\n          "stopwords": "_english_ "\n        },\n        "english_stemmer": {\n          "type": "stemmer",\n          "language": "english"\n        }\n      },\n      "tokenizer": {\n        "punctuation": {\n          "type": "pattern",\n          "pattern": "[.,!?&=_:;\']"\n        }\n      },\n      "char_filter": {\n        "symbol": {\n          "type": "mapping",\n          "mappings": [\n              "& => and",\n              ":) => happy",\n              ":( => unhappy",\n              "+ => plus"\n            ]\n        }\n      }\n    }\n  },\n  "mappings": {\n    "properties": {\n      "title": {\n        "type": "text",\n        "analyzer": "custom_analyzer",\n        "index": "true"\n      },\n      "series": {\n        "type": "text",\n        "index": "false"\n      },\n      "models": {\n        "type": "text",\n        "index": "false"\n      },\n      "description": {\n        "type": "text",\n        "analyzer": "custom_analyzer",\n        "index": "true"\n      },\n      "link": {\n        "type": "text",\n        "index": "false"\n      },\n      "title2": {\n        "type": "text",\n        "analyzer": "german",\n        "index": "true"\n      },\n      "chapters": {\n        "type": "text",\n        "analyzer": "english",\n        "fields": {\n          "raw": {\n            "type": "keyword"\n          }\n        }\n      },\n      "tags": {\n        "type": "text",\n        "analyzer": "english",\n        "fields": {\n          "raw": {\n            "type": "keyword"\n          }\n        }\n      },\n      "image": {\n        "type": "text",\n        "index": "false"\n      },\n      "imagesquare": {\n        "type": "text",\n        "index": "false"\n      },\n      "abstract": {\n        "type": "text",\n        "analyzer": "custom_analyzer",\n        "index": "true"\n      },\n      "sublink1": {\n        "type": "text",\n        "index": "false"\n      },\n      "sublink2": {\n        "type": "text",\n        "index": "false"\n      },\n      "sublink3": {\n        "type": "text",\n        "index": "false"\n      },\n      "sublink4": {\n        "type": "text",\n        "index": "false"\n      },\n      "subtitle1": {\n        "type": "text",\n        "index": "false"\n      },\n      "subtitle2": {\n        "type": "text",\n        "index": "false"\n      },\n      "subtitle3": {\n        "type": "text",\n        "index": "false"\n      },\n      "subtitle4": {\n        "type": "text",\n        "index": "false"\n      },\n      "badge": {\n        "type": "text",\n        "index": "false"\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Test your Custom Analyzer:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'POST /wiki_ssr_en_2020_07_06/_analyze  //Test your custom analyzer - strip HTML + english stopwords + custom characters\n{\n  "analyzer": "custom_analyzer",\n  "text": "<p>This + This is an HTML posting going well, hopefully ? :)</p>. And this is a CGI command: http://admin:instar@192.168.178.88/param.cgi?cmd=setsmtpattr&-ma_ssl=3&-ma_from=cam%40instar.email&-ma_to=me@gmail.com%3B&-ma_subject=Alarm%20Email&-ma_text=ALARM&-ma_server=mx.instar.email&-ma_port=587&-ma_logintype=1&-ma_username=cam%40instar.email&-ma_password=kunde123"\n  \n}\n')),(0,r.kt)("h2",{id:"index"},"INDEX"),(0,r.kt)("p",null,"Add Single Post"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'PUT /wiki_ssr_en_2020_07_06/_doc/documentid\n{\n  "title": "How Does An IP Camera Work?",\n  "series": ["HD", "VGA", "Indoor", "Outdoor"],\n  "models": ["IN-2905", "IN-2908", "IN-3011", "IN-4010", "IN-4011", "IN-5905 HD", "IN-5907 HD", "IN-6001 HD", "IN-6012 HD", "IN-6014 HD", "IN-7011 HD"],\n  "description": "How does an IP-Camera-Network work? LAN or Wifi connectivity. Remote access to your camera via DDNS (Dynamic Domain Name Service). Internal IP address vs internet address (DDNS). What is the difference between the internal IP (LAN) and the external IP address (WAN). Internal port / external port - How to open a door to the internet (Port Forwarding)",\n  "link": "/Quick_Installation/How_Does_An_IP_Camera_Work",\n  "title2": "Wie arbeitet eine IP Kamera?",\n  "chapters": "Quick Installation",\n  "tags": ["Introduction", "Quickinstallation"],\n  "image": "/images/Search/QI_SearchThumb_HowDoesAnIPCameraWork.png",\n  "abstract": "How do IP Cameras work in my Network"\n}\n')),(0,r.kt)("h3",{id:"update"},"UPDATE"),(0,r.kt)("p",null,"Update only one key pair in document with ID yt-intro:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'POST /wiki_ssr_en_2020_07_06/_update/yt-intro\n{\n  "doc": {\n    "image": "/images/Search/InstarWiki_SearchThumb_HowDoesAnIPCameraWork.jpg"\n  }\n}\n')),(0,r.kt)("p",null,"Update complete document:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'PUT /wiki_ssr_en_2020_07_06/_doc/yt-intro\n{\n  "title": "IP Cameras - An Introduction Video",\n  "...": "..."\n}\n')),(0,r.kt)("h3",{id:"delete"},"DELETE"),(0,r.kt)("p",null,"Delete only document with ID yt-intro"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"DELETE /wiki_ssr_en_2020_07_06/_doc/yt-intro \n")),(0,r.kt)("p",null,"Delete complete Index"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"DELETE /wiki_ssr_en_2020_07_06\n")),(0,r.kt)("h3",{id:"bulk"},"BULK"),(0,r.kt)("p",null,"Bulk actions INDEX, UPDATE and DELETE:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'POST _bulk\n{"index": {"_index": "wiki_ssr_en_2020_07_06", "_id": "yt-intro"}}\n{"title": "IP Cameras - An Introduction Video", "description": "How does an IP-Camera work? An IP camera is a complex product, however it is not complicated to operate a INSTAR product. In the following we want to give you an intorduction to the basic functions of an IP camera. For more information about our cameras you can continue reading the FIRST STEPS, where we will dive a little deeper. What is an IP camera and how does it work? The IP in IP-camera stands for Internet Protocol. This implies that the camera is being connected with a network, from which it can be accessed by other devices. The access is not only possible within the same network, but even through the internet. Using our IP cameras works like this: You connect your IP camera via LAN cable or wireless with your router. When your computer or smartphone is connected to the same router, you just type the camera\xb4s IP address into your browsers address bar to access the web user interface (1080P MODELS / 720P MODELS). You can also remotely access your camera through the internet. This is possible via DDNS ADDRESS or via a POINT-TO-POINT connection. When you access your camera, you will enter its Web User Interface 1080P MODELS / 720P MODELS. There you can see the current live video and adjust settings such as alarms, schedules or video configuration. Those settings will be saved on the camera. The camera is opersting 24/7 and will notify you if something moves within the camera\xb4s field of view. How sensitive the camera\xb4s MOTION DETECTION is, and what happens after the alarm was triggered, can be set individually for each camera. Manual or planned recordings following a SCHEDULE are possible as well. This is the basic concept of our cameras. For further information you can check out the FIRST STEPS or you browse our Wiki. Of course you can ask us your unanswered questions PERSONALLY as well.", "sublink1": "/Quick_Installation/How_Does_An_IP_Camera_Work/Video/", "subtitle1": "Video \u2022 ", "sublink2": "/Quick_Installation/How_Does_An_IP_Camera_Work/", "subtitle2": "How does an IP Camera Work \u2022 ", "sublink3": "/Quick_Installation/", "subtitle3": "Quick Installation", "sublink4": "", "subtitle4": "", "badge": "Video", "title2": "Wie arbeitet eine IP Kamera?", "chapter": "Quick Installation", "tags": ["Introduction", "Quickinstallation"], "image": "/images/Search/QI_SearchThumb_HowDoesAnIPCameraWork.png", "imagesquare": "/images/Search/TOC_Icons/Wiki_Tiles_Youtube_white.png", "short": "How do IP Cameras work in my Network", "abstract": "These videos contain an overview over the basic IP camera features like: LAN or WiFi connectivity and remote access via DDNS and P2P."}\n{"index": {"_index": "wiki_ssr_en_2020_07_06", "_id": "yt-powerline"}}\n{"title": "Powerline - Introduction Video", "description": "Powerline INSTALLATION Network over your Power Grid IN-LAN is an intelligent and secure technology that lets you set up a home network easily via your household power grid - without the need of complex and expensive dedicated cabling. IN-LAN communication now attains speeds you would expect from other LAN technologies. IN-LAN uses the household power grid to transfer data between computers equipped with suitable adapters and other network components. As a result, any power outlet can be used as a network access point. State-of-the-art technology ensures that the power and data networks do not interfere with one another. Powerline vs Power-over-Ethernet Powerline allows you to connect your camera to your local network over the power grid. The camera still needs to be powered by the included power supply. Power-over-Ethernet combines both the network as well as the power supply in a regular Ethernet cable. You only need a POE INJECTOR or POE SWITCH to add the voltage to the Ethernet cable. What is the difference between IN-LAN 500 & IN-LAN 500p? The P in IN-LAN 500p stands for pass-through. Unlike the base model the 500p will block your power outlet but pass through the existing one. Both models offer the same advantages otherwise: Use existing power lines to implement a network with IN-LAN. Very simple plug&play technology. Just plug into the wall socket and you\'re done. Ultra-fast data transfer up to 500Mbps. Expand your network with for e.g. IP cameras without laying network cables. A very detailed instruction will make the installation very easy. Installation Warnings Powerline communication will fail. if both adaptors (one at your router / the other for your camera) are not connected to the same phase on your powergrid. The Powerline network can suffer quality issues, if the cables, used in your power grid are old. Always directly plug in your IN-LAN adaptors into a wall socket. Don\'t use extensions cords.", "sublink1": "/Quick_Installation/Powerline/Video/", "subtitle1": "Video \u2022 ", "sublink2": "/Quick_Installation/Powerline/", "subtitle2": "Powerline \u2022 ", "sublink3": "/Quick_Installation/", "subtitle3": "Quick Installation", "sublink4": "", "subtitle4": "", "badge": "Video", "title2": "Powerline", "chapter": "Quick Installation", "tags": ["Introduction", "Quickinstallation", "Network", "D-LAN", "IN-LAN", "Homeplug AV", "Devolo"], "image": "/images/Search/QI_SearchThumb_Powerline.png", "imagesquare": "/images/Search/TOC_Icons/Wiki_Tiles_Youtube_white.png", "short": "Network Connection over your Power Grid", "abstract": "IN-LAN is an intelligent and secure technology that lets you set up a home network easily via your household power grid - without the need of complex and expensive dedicated cabling."}\n{"update": {"_id": "yt-intro", "_index": "wiki_ssr_en_2020_07_06"}}\n{"doc": {"image": "/images/Search/updatedimage.png"}}\n{"delete": {"_index": "wiki_ssr_en_2020_07_06", "_id": "yt-powerline"}}\n')),(0,r.kt)("h2",{id:"search"},"SEARCH"),(0,r.kt)("h3",{id:"cheat-sheet"},"Cheat Sheet"),(0,r.kt)("p",null,"Return all documents"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"GET /wiki_ssr_en_2020_07_06/_search\n")),(0,r.kt)("p",null,"Return all documents from all indices starting with wiki_ssr_en"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"GET /wiki_ssr_en*/_search\n")),(0,r.kt)("p",null,"Return all documents from all indices"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"GET /_search\n")),(0,r.kt)("p",null,"Return all documents from index 1&2"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"GET /index1,index2/_search\n")),(0,r.kt)("p",null,"This request returned 5 documents with the search query ",(0,r.kt)("inlineCode",{parentName:"p"},"fritzbox")," and the article with the highest match has a score of >5."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search?q=fritzbox\n\n\n{\n  "took" : 16,\n  "timed_out" : false,\n  "_shards" : {\n    "total" : 1,\n    "successful" : 1,\n    "skipped" : 0,\n    "failed" : 0\n  },\n  "hits" : {\n    "total" : {\n      "value" : 5,\n      "relation" : "eq"\n    },\n    "max_score" : 5.1948776\n  }\n}\n')),(0,r.kt)("p",null,"Only return documents with search query in it's title"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"GET /wiki_ssr_en_2020_07_06/_search?q=title:9008\n")),(0,r.kt)("p",null,"Search query in request body"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match": {\n      "title": "fritzbox"\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Multiple terms with OR operator"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match": {\n      "title": "avm fritzbox"\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Multiple terms with AND operator"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match_phrase": {\n      "title": "avm fritzbox"\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Search as you type - when you want to display suggestions to the user you can use ",(0,r.kt)("inlineCode",{parentName:"p"},"match_phrase_prefix")," in this case the last word the user typed will be understood as a prefix instead of a whole search query."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "bool": {\n      "must": [\n        {\n          "match_phrase_prefix": {\n            "title": {\n              "query": "Heater Install"\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n')),(0,r.kt)("p",null,"You can also use ",(0,r.kt)("inlineCode",{parentName:"p"},"prefix")," to match terms that start with the search query"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "prefix": {\n      "title": {\n        "value": "adjust"\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Multi match more than one field"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "multi_match": {\n      "query": "fritzbox",\n      "fields": ["title", "tags"]\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Highlight search query in search results:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match": {\n      "title": "Forward"\n    }\n  },\n  "highlight": {\n    "fields": {\n      "title": {}\n    }\n  }\n}\n')),(0,r.kt)("p",null,"The search result will now contain an extra field below ",(0,r.kt)("inlineCode",{parentName:"p"},"_source")," allowing you to style the em-tags in your search results:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'"highlight" : {\n      "title" : [\n        "Port <em>Forwarding</em> Digitalisierungsbox Video"\n      ]\n    }\n')),(0,r.kt)("p",null,"Check if a specific field is present and display all documents that fit:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "exists": {\n      "field": "published"\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Bool queries"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "bool": {\n      "must": [{\n        "match": {\n          "title": "fritzbox"\n        }\n      }],\n      "must_not": [{\n        "match": {\n          "title": "forwarding"\n        }\n      }],\n      "should": [{\n        "match": {\n          "tags": "ftp"\n        }\n      }]\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Range filter greater-to-equal or lesser-to-equal"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "bool": {\n      "must": [{\n        "match": {\n          "title": "fritzbox"\n        }\n      }],\n      "filter": {\n        "match": {\n          "range": {\n            "likes": {\n              "gte": 10,\n              "lte": 100\n            }\n          }\n        }\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Limit the amount of returned documents (",(0,r.kt)("strong",{parentName:"p"},"Note"),": the default value in Elasticsearch is ",(0,r.kt)("inlineCode",{parentName:"p"},"10"),"!):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match_all": {}\n  },\n  "size": 2\n}\n')),(0,r.kt)("p",null,"To paginate through your search results use ",(0,r.kt)("inlineCode",{parentName:"p"},"from")," to set the start point:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match_all": {}\n  },\n  "size": 2,\n  "from": 2\n}\n')),(0,r.kt)("p",null,"Limit the source output to values you are interested in:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match_all": {}\n  },\n  "size": 2,\n  "_source": ["title*", "abstract", "*link*"]\n}\n')),(0,r.kt)("p",null,"Or the other way around - use excludes:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match_all": {}\n  },\n  "size": 2,\n  "_source": {\n      "excludes": "*link*"\n  }\n}\n')),(0,r.kt)("p",null,"Sort your search results (default is by relevancy) - this example fails, see reason below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match_all": {}\n  },\n  "size": 2,\n  "sort": [\n    {\n      "title": {\n        "order": "desc"\n      }\n    }\n  ]\n}\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Text fields are not optimised for operations that require per-document field data like aggregations and sorting, so these operations are disabled by default. Please use a keyword field instead. Alternatively, set ",(0,r.kt)("inlineCode",{parentName:"p"},"fielddata=true")," on ","[title]"," in order to load field data by uninverting the inverted index. Note that this can use significant memory.")),(0,r.kt)("p",null,"Our mapping sets ",(0,r.kt)("inlineCode",{parentName:"p"},"chapter")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"tags")," to be a keyword fields that are not analyzed - we can use them to sort our results:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match_all": {}\n  },\n  "size": 5,\n  "_source": [\n    "chapter",\n    "tags"\n  ],\n  "sort": [\n    {\n      "chapters.raw": {\n        "order": "desc"\n      }\n    },\n    {\n      "tags.raw": {\n        "order": "desc"\n      }\n    }\n  ]\n}\n')),(0,r.kt)("p",null,"Use the AND operator to get exact results (matched to all keywords you provide - default behaviour is OR):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match": {\n      "title": "avm fritzbox wireless protected setup"\n    }\n  }\n}\n')),(0,r.kt)("p",null,"This query returns 10 results for documents that have either of those search keywords in their title. Let's change this query to the AND operator to get only the documents that has all of those keywords in it's title:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match": {\n      "title": {\n        "query": "avm fritzbox wireless protected setup",\n        "operator": "and"\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"This only returns 1 document with the exact title. ",(0,r.kt)("strong",{parentName:"p"},"Note"),": that Elasticsearch uses the same analyzer for your search query that were used for this field in your document. Since ",(0,r.kt)("inlineCode",{parentName:"p"},"title")," uses our custom analyzer all english stop words will be scrubbed - this might lead to different search results. You can also make this query a little bit more fuzzy by defining a number of terms that have to match:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match": {\n      "title": {\n        "query": "avm fritzbox wireless protected setup",\n        "minimum_should_match": 3\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Or use a relative match:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match": {\n      "title": {\n        "query": "avm fritzbox wireless protected setup",\n        "minimum_should_match": "75%"\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Weighting your search queries to prefer hits in certain fields:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "multi_match": {\n      "query": "ASUS",\n      "fields": [\n        "tag^10",\n        "title^9",\n        "abstract^7",\n        "description^5"\n      ]\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Or boost a match clause in your query:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "bool": {\n      "should": [\n        {\n          "match": {\n            "title": {\n              "query": "installation",\n              "boost": 3\n            }\n          }\n        },\n        {\n          "match": {\n            "abstract": {\n              "query": "installation"\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n')),(0,r.kt)("p",null,"If you want to provide a boost factor during index time, you can modify your mapping:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'PUT /wiki_ssr_en_2020_07_06\n{\n  "settings": {\n    "analysis": {\n      "analyzer": {\n        "custom_analyzer": {\n          "type": "custom",\n          "char_filter": [\n            "symbol",\n            "html_strip"\n          ],\n          "tokenizer": "punctuation",\n          "filter": [\n            "lowercase",\n            "word_delimiter",\n            "english_stop",\n            "english_stemmer"\n          ]\n        }\n      },\n      "filter": {\n        "english_stop": {\n          "type": "stop",\n          "stopwords": "_english_ "\n        },\n        "english_stemmer": {\n          "type": "stemmer",\n          "language": "english"\n        }\n      },\n      "tokenizer": {\n        "punctuation": {\n          "type": "pattern",\n          "pattern": "[.,!?&=_:;\']"\n        }\n      },\n      "char_filter": {\n        "symbol": {\n          "type": "mapping",\n          "mappings": [\n              "& => and",\n              ":) => happy",\n              ":( => unhappy",\n              "+ => plus"\n            ]\n        }\n      }\n    }\n  },\n  "mappings": {\n    "properties": {\n      "title": {\n        "type": "text",\n        "analyzer": "custom_analyzer",\n        "index": "true",\n        "boost": 9\n      },\n      "series": {\n        "type": "text",\n        "index": "false"\n      },\n      "models": {\n        "type": "text",\n        "index": "false"\n      },\n      "description": {\n        "type": "text",\n        "analyzer": "custom_analyzer",\n        "index": "true",\n        "boost": 3\n      },\n      "link": {\n        "type": "text",\n        "index": "false"\n      },\n      "title2": {\n        "type": "text",\n        "analyzer": "german",\n        "index": "true"\n      },\n      "chapters": {\n        "type": "text",\n        "analyzer": "english",\n        "fields": {\n          "raw": {\n            "type": "keyword"\n          }\n        }\n      },\n      "tags": {\n        "type": "text",\n        "analyzer": "english",\n        "boost": 10,\n        "fields": {\n          "raw": {\n            "type": "keyword"\n          }\n        }\n      },\n      "image": {\n        "type": "text",\n        "index": "false"\n      },\n      "imagesquare": {\n        "type": "text",\n        "index": "false"\n      },\n      "abstract": {\n        "type": "text",\n        "analyzer": "custom_analyzer",\n        "index": "true",\n        "boost": 7\n      },\n      "sublink1": {\n        "type": "text",\n        "index": "false"\n      },\n      "sublink2": {\n        "type": "text",\n        "index": "false"\n      },\n      "sublink3": {\n        "type": "text",\n        "index": "false"\n      },\n      "sublink4": {\n        "type": "text",\n        "index": "false"\n      },\n      "subtitle1": {\n        "type": "text",\n        "index": "false"\n      },\n      "subtitle2": {\n        "type": "text",\n        "index": "false"\n      },\n      "subtitle3": {\n        "type": "text",\n        "index": "false"\n      },\n      "subtitle4": {\n        "type": "text",\n        "index": "false"\n      },\n      "badge": {\n        "type": "text",\n        "index": "false"\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Term queries, unlike match queries are not analyzed - the following search will give you all the articles that are tagged with ",(0,r.kt)("inlineCode",{parentName:"p"},"indoor"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "term": {\n      "tags": "indoor"\n    }\n  },\n  "_source": ["tags"]\n}\n')),(0,r.kt)("p",null,"If you type ",(0,r.kt)("inlineCode",{parentName:"p"},"Indoor")," with a capital letter you won get a match since all our documents have been analyzed and run through a to-lower-case transformation. When you use a match query instead your search will be run through the same analyzers and you will get a match:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "match": {\n      "tags": "Indoor"\n    }\n  },\n  "_source": ["tags"]\n}\n')),(0,r.kt)("p",null,"Term queries can also be used to filter searches:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "bool": {\n      "must": [\n        {\n          "match": {\n            "title": {\n              "query": "heater installation"\n            }\n          }\n        }\n      ],\n      "filter": {\n        "term": {\n          "tags": "instar"\n        }\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"You can add multiple terms with the ",(0,r.kt)("inlineCode",{parentName:"p"},"terms")," filter:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "bool": {\n      "must": [\n        {\n          "match": {\n            "title": {\n              "query": "heater installation"\n            }\n          }\n        }\n      ],\n      "filter": {\n        "terms": {\n          "tags": [\n            "instar",\n            "products"\n          ]\n        }\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"With multiple filter use the one that eliminates most documents first to improve the performance of the following filters:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'GET /wiki_ssr_en_2020_07_06/_search\n{\n  "query": {\n    "bool": {\n      "must": [\n        {\n          "match": {\n            "title": {\n              "query": "camera unboxing"\n            }\n          }\n        }\n      ],\n      "must_not": [\n        {\n          "term": {\n            "value": "draft"\n          }\n        }\n      ],\n      "filter": [\n        {\n          "range": {\n            "likes": {\n              "gte": 100\n            }\n          }\n        },\n        {\n          "range": {\n            "published": {\n              "gte": "2020-03-17"\n            }\n          }\n        }\n      ],\n      "should": [\n        {\n          "match": {\n            "tags": "1080p"\n          }\n        }\n      ],\n      "minimum_should_match": 1\n    }\n  }\n}\n')))}p.isMDXComponent=!0},84115:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/docker-elk_01-e8084d3f5324520870f99f3ca9e20b1f.png"},67307:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/docker-elk_02-987608bab59d92ae89dd5554a3fbddaf.png"},76512:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-3890d0bc07d7ab7ee289efe15d384748.jpg"}}]);