"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[87342],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(n),m=r,g=d["".concat(l,".").concat(m)]||d[m]||p[m]||o;return n?a.createElement(g,i(i({ref:t},c),{},{components:n})):a.createElement(g,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},14301:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>u});var a=n(87462),r=(n(67294),n(3905));const o={sidebar_position:8e3,slug:"2020-07-13",title:"Infrastructure as Code",authors:"mpolinowski",tags:["LINUX"]},i=void 0,s={unversionedId:"DevOps/Provisioning/2020-07-13--infrastructure-as-code/index",id:"DevOps/Provisioning/2020-07-13--infrastructure-as-code/index",title:"Infrastructure as Code",description:"Shenzhen, China",source:"@site/docs/DevOps/Provisioning/2020-07-13--infrastructure-as-code/index.md",sourceDirName:"DevOps/Provisioning/2020-07-13--infrastructure-as-code",slug:"/DevOps/Provisioning/2020-07-13--infrastructure-as-code/2020-07-13",permalink:"/docs/DevOps/Provisioning/2020-07-13--infrastructure-as-code/2020-07-13",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Provisioning/2020-07-13--infrastructure-as-code/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"}],version:"current",sidebarPosition:8e3,frontMatter:{sidebar_position:8e3,slug:"2020-07-13",title:"Infrastructure as Code",authors:"mpolinowski",tags:["LINUX"]},sidebar:"tutorialSidebar",previous:{title:"Serving Static Files with Hapi and Docker",permalink:"/docs/DevOps/Provisioning/2020-08-29--static-server-with-hapi-and-docker/2020-08-29"},next:{title:"Developing WikiJS in Docker",permalink:"/docs/DevOps/Provisioning/2020-06-07--setting-up-wikijs-in-docker/2020-06-07"}},l={},u=[{value:"Types of approaches",id:"types-of-approaches",level:2},{value:"Added value and advantages",id:"added-value-and-advantages",level:2},{value:"cost (reduction)",id:"cost-reduction",level:3},{value:"speed (faster execution)",id:"speed-faster-execution",level:3},{value:"risk (remove errors and security violations)",id:"risk-remove-errors-and-security-violations",level:3},{value:"Methods",id:"methods",level:2},{value:"Configuration Examples",id:"configuration-examples",level:2},{value:"Ansible",id:"ansible",level:3},{value:"Puppet",id:"puppet",level:3},{value:"Salt",id:"salt",level:3},{value:"Module types",id:"module-types",level:3},{value:"Nagios Core",id:"nagios-core",level:2}],c={toc:u};function p(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Shenzhen, China",src:n(18299).Z,width:"1500",height:"620"})),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Just some copy&paste from Wikipedia for a presentation")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#types-of-approaches"},"Types of approaches")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#added-value-and-advantages"},"Added value and advantages"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#cost-reduction"},"cost (reduction)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#speed-faster-execution"},"speed (faster execution)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#risk-remove-errors-and-security-violations"},"risk (remove errors and security violations)")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#methods"},"Methods")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#configuration-examples"},"Configuration Examples"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#ansible"},"Ansible")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#puppet"},"Puppet")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#salt"},"Salt")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#module-types"},"Module types")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#nagios-core"},"Nagios Core"))),(0,r.kt)("h1",{id:"continuous-configuration-automation"},"Continuous configuration automation"),(0,r.kt)("h2",{id:"types-of-approaches"},"Types of approaches"),(0,r.kt)("p",null,"Infrastructure as code (IaC) is the process of managing and provisioning computer data centers through machine-readable definition files, rather than physical hardware configuration or interactive configuration tools. The definitions may be in a ",(0,r.kt)("strong",{parentName:"p"},"version control system"),"."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"In software engineering, version control is system responsible for managing changes to computer programs, documents, large web sites, or other collections of information. Version control is a component of software configuration management.")),(0,r.kt)("p",null,"It can use either scripts or ",(0,r.kt)("strong",{parentName:"p"},"declarative definitions"),", rather than manual processes, but the term is more often used to promote declarative (functional) approaches."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The declarative approach defines the desired state and the system executes what needs to happen to achieve that desired state. Imperative defines specific commands that need to be executed in the appropriate order to end with the desired conclusion.")),(0,r.kt)("h2",{id:"added-value-and-advantages"},"Added value and advantages"),(0,r.kt)("p",null,"The value of IaC can be broken down into three measurable categories:"),(0,r.kt)("h3",{id:"cost-reduction"},"cost (reduction)"),(0,r.kt)("p",null,"Cost reduction aims at helping not only the enterprise financially, but also in terms of people and effort, meaning that by removing the manual component."),(0,r.kt)("h3",{id:"speed-faster-execution"},"speed (faster execution)"),(0,r.kt)("p",null,"Infrastructure automation enables speed through faster execution when configuring your infrastructure and aims at providing visibility to help other teams across the enterprise work quickly and more efficiently."),(0,r.kt)("h3",{id:"risk-remove-errors-and-security-violations"},"risk (remove errors and security violations)"),(0,r.kt)("p",null,"Automation removes the risk associated with human error, like manual misconfiguration; removing this can decrease downtime and increase reliability. These outcomes and attributes help the enterprise move towards implementing a culture of DevOps, the combined working of development and operations."),(0,r.kt)("h2",{id:"methods"},"Methods"),(0,r.kt)("p",null,"There are two methods of IaC: ",(0,r.kt)("strong",{parentName:"p"},"push")," and ",(0,r.kt)("strong",{parentName:"p"},"pull")," . The main difference is the manner in which the servers are told how to be configured. In the pull method the server to be configured will pull its configuration from the controlling server. In the push method the controlling server pushes the configuration to the destination system."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Continuous configuration automation",src:n(76771).Z,width:"859",height:"343"})),(0,r.kt)("p",null,"This is a comparison of notable free and open-source configuration management software, suitable for tasks like server configuration, orchestration and infrastructure as code typically performed by a system administrator."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Continuous configuration automation",src:n(20130).Z,width:"2550",height:"1650"})),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null}))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Ansible")),(0,r.kt)("td",{parentName:"tr",align:null},"Combines multi-node deployment, ad-hoc task execution, and configuration management in one package. ",(0,r.kt)("strong",{parentName:"td"},"Manages nodes over SSH")," and requires python (2.6+ or 3.5+) to be installed on them. Modules work over JSON and standard output and can be written in any language. Uses ",(0,r.kt)("strong",{parentName:"td"},"YAML to express reusable descriptions")," of systems.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Chef")),(0,r.kt)("td",{parentName:"tr",align:null},"Chef is a configuration management tool written in Erlang, and uses a pure ",(0,r.kt)("strong",{parentName:"td"},'Ruby DSL for writing configuration "recipes"'),'. These recipes contain resources that should be put into the declared state. Chef can be used as a client\u2013server tool, or used in "solo" mode.')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Juju")),(0,r.kt)("td",{parentName:"tr",align:null},"Juju concentrates on the notion of service, abstracting the notion of machine or server, and defines relations between those services that are automatically updated when two linked services observe a notable modification.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Puppet")),(0,r.kt)("td",{parentName:"tr",align:null},"Puppet consists of a ",(0,r.kt)("strong",{parentName:"td"},"custom declarative language")," to describe system configuration, distributed using the client\u2013server paradigm (using XML-RPC protocol in older versions, with a recent switch to REST), and a library to realize the configuration. Puppet will then ensure the server's state matches the description.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Salt")),(0,r.kt)("td",{parentName:"tr",align:null},"Salt started out as a tool for remote server management. As its usage has grown, it has gained a number of extended features, including a more comprehensive mechanism for host configuration. This is a relatively new feature facilitated through the Salt States component. With the traction that Salt has gotten in the last bit, the support for more features and platforms will continue to grow.")))),(0,r.kt)("h2",{id:"configuration-examples"},"Configuration Examples"),(0,r.kt)("h3",{id:"ansible"},"Ansible"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Infrastructure as Code Puppet",src:n(9856).Z,width:"629",height:"453"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"---\n- hosts: all\n  tasks:\n    - name: ensure nginx is at the latest version\n      apt: name=nginx state=latest\n      become: yes\n    - name: start nginx\n      service:\n          name: nginx\n          state: started\n      become: yes\n    - name: copy the nginx config file and restart nginx\n      copy:\n        src: /home/foo/static_site.cfg\n        dest: /etc/nginx/sites-available/static_site.cfg\n      become: yes\n    - name: create symlink\n      file:\n        src: /etc/nginx/sites-available/static_site.cfg\n        dest: /etc/nginx/sites-enabled/default\n        state: link\n      become: yes\n    - name: copy the content of the web site\n      copy:\n        src: /home/foo/static-site-src/\n        dest: /home/foo/static-site\n    - name: restart nginx\n      service:\n        name: nginx\n        state: restarted\n      become: yes\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Ansible supports the Jinja templating engine")),(0,r.kt)("h3",{id:"puppet"},"Puppet"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Infrastructure as Code Puppet",src:n(9717).Z,width:"1263",height:"915"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},'\'nginx-plus\': {\n  apt::source { \'nginx\':\n    location => "https://plus-pkgs.nginx.com/${distro}",\n    repos    => \'nginx-plus\',\n    key      => \'573BFD6B3D8FBC641079A6ABABF5BD827BD9BF62\',\n  }\n  exec { \'download 90nginx file\':\n  command => "/usr/bin/wget -q -O /etc/apt/apt.conf.d/90nginx https://cs.nginx.com/static/files/90nginx",\n  creates => "/etc/apt/apt.conf.d/90nginx"\n  }\n  file { \'/etc/ssl/nginx\':\n    ensure => directory,\n    mode => "0755",\n    owner => "root",\n    group => "root",\n  }\n  file { \'/etc/ssl/nginx/nginx-repo.crt\':\n    ensure => present,\n    mode => "0644",\n    owner => "root",\n    group => "root",\n    content => "Contents of your nginx\u2011repo.crt file here as one line",\n  }\n  file { \'/etc/ssl/nginx/nginx-repo.key\':\n    ensure => present,\n    mode => "0644",\n    owner => "root",\n    group => "root",\n    content => "Contents of your nginx\u2011repo.key file here as one line",\n  }\n}\n')),(0,r.kt)("h3",{id:"salt"},"Salt"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Infrastructure as Code Puppet",src:n(64053).Z,width:"3816",height:"1980"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"nginx:\n  pkg:\n    - installed\n  service.running:\n    - watch:\n      - pkg: nginx\n      - file: /etc/nginx/nginx.conf\n      - file: /etc/nginx/sites-available/default\n\n/etc/nginx/nginx.conf:\n  file.managed:\n    - source: salt://nginx/files/etc/nginx/nginx.conf\n    - user: root\n    - group: root\n    - mode: 640\n\n/etc/nginx/sites-available/default:\n  file.managed:\n    - source: salt://nginx/files/etc/nginx/sites-available/default.jinja\n    - template: jinja\n    - user: root\n    - group: root\n    - mode: 640\n\n/usr/share/nginx/html/index.html:\n  file.managed:\n    - source: salt://nginx/files/usr/share/nginx/html/index.html.jinja\n    - template: jinja\n    - user: root\n    - group: root\n    - mode: 644\n")),(0,r.kt)("h3",{id:"module-types"},"Module types"),(0,r.kt)("p",null,"The Salt system maintains many module types to manage specific actions. Modules can be added to any of the systems that support dynamic modules. These modules manage all the remote execution and state management behavior of Salt. The modules can be separated into six groups:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Execution modules")," are the workhorse for Salt's functionality. They represent the functions available for direct execution from the remote execution engine. These modules contain the specific cross platform information used by Salt to manage portability, and constitute the core API of system level functions used by Salt systems.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"State modules")," are the components that make up the backend for the Salt configuration management system. These modules execute the code needed to enforce, set up or change the configuration of a target system. Like other modules, more states become available when they are added to the states modules.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Grains")," are a system for detecting static information about a system and storing it in RAM for rapid gathering.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Renderer modules")," are used to render the information passed to the Salt state system. The renderer system is what makes it possible to represent Salt's configuration management data in any serializable format.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Returners"),": the remote execution calls made by Salt are detached from the calling system; this allows the return information generated by the remote execution to be returned to an arbitrary location. Management of arbitrary return locations is managed by the Returner Modules.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Runners")," are master side convenience applications executed by the salt-run command."))),(0,r.kt)("h1",{id:"list-of-systems-management-systems"},"List of systems management systems"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Continuous configuration automation",src:n(44679).Z,width:"786",height:"668"})),(0,r.kt)("h2",{id:"nagios-core"},"Nagios Core"),(0,r.kt)("p",null,"Nagios Core is open source software licensed under the GNU GPL V2."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Continuous configuration automation",src:n(6361).Z,width:"625",height:"382"})),(0,r.kt)("p",null,"Currently it provides:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Monitoring of network services (SMTP, POP3, HTTP, NNTP, ICMP, SNMP, FTP, SSH)"),(0,r.kt)("li",{parentName:"ul"},"Monitoring of host resources (processor load, disk usage, system logs) on a majority of network operating systems, including Microsoft Windows, using monitoring agents."),(0,r.kt)("li",{parentName:"ul"},"Monitoring of any hardware (like probes for temperature, alarms, etc.) which have the ability to send collected data via a network to specifically written plugins"),(0,r.kt)("li",{parentName:"ul"},"Monitoring via remotely run scripts via Nagios Remote Plugin Executor"),(0,r.kt)("li",{parentName:"ul"},"Remote monitoring supported through SSH or SSL encrypted tunnels."),(0,r.kt)("li",{parentName:"ul"},"A simple plugin design that allows users to easily develop their own service checks depending on needs, by using their tools of choice (shell scripts, C++, Perl, Ruby, Python, PHP, C#, etc.)"),(0,r.kt)("li",{parentName:"ul"},"Available data graphing plugins"),(0,r.kt)("li",{parentName:"ul"},"Parallelized service checks"),(0,r.kt)("li",{parentName:"ul"},"Flat-text formatted configuration files (integrates with many config editors)"),(0,r.kt)("li",{parentName:"ul"},"The ability to define network host using 'parent' hosts, allowing the detection of and distinction between hosts that are down or unreachable"),(0,r.kt)("li",{parentName:"ul"},"Contact notifications when service or host problems occur and get resolved (via e-mail, pager, SMS, or any user-defined method through plugin system)"),(0,r.kt)("li",{parentName:"ul"},"The ability to define event handlers to be run during service or host events for proactive problem resolution\nAutomatic log file rotation"),(0,r.kt)("li",{parentName:"ul"},"Support for implementing redundant monitoring hosts"),(0,r.kt)("li",{parentName:"ul"},"Support for implementing performance data graphing"),(0,r.kt)("li",{parentName:"ul"},"Support for database backend (such as NDOUtils)"),(0,r.kt)("li",{parentName:"ul"},"Push notifications"),(0,r.kt)("li",{parentName:"ul"},"A web-interface for viewing current network status, notifications, problem history, log files, etc.")))}p.isMDXComponent=!0},9856:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Infrastructure_as_Code-Ansible_01-c724d278f9eef001b4715fe0d91225cf.png"},6361:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Infrastructure_as_Code-Nagios_01-a0a9f7f104b31d1fb4199268ebba731a.png"},9717:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Infrastructure_as_Code-Puppet_01-e9a6752112acaadd9efa1e6dc4b3236e.png"},64053:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Infrastructure_as_Code-Salt_01-8441f9322b6c1d8c21fbee485bbc1e60.png"},76771:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Infrastructure_as_Code_01-4a4e0bdbbc1337848d4ec5e43ffaa91e.png"},20130:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Infrastructure_as_Code_02-0ef97fd31d876cbdb6e65b09e7b10681.png"},44679:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Infrastructure_as_Code_03-4ec1441652209d75026cbc8d1d9cbec8.png"},18299:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-bdfb70fdb6655e36a558f0bcc8f24658.jpg"}}]);