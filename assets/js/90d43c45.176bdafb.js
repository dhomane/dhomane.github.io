"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[10392],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=n.createContext({}),l=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=l(a),h=r,b=d["".concat(c,".").concat(h)]||d[h]||u[h]||o;return a?n.createElement(b,s(s({ref:t},p),{},{components:a})):n.createElement(b,s({ref:t},p))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var l=2;l<o;l++)s[l]=a[l];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},12984:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var n=a(87462),r=(a(67294),a(3905));const o={sidebar_position:8060,slug:"2022-01-14",title:"Zabbix v6 Apache 2 Monitor",authors:"mpolinowski",tags:["Zabbix","Linux","Apache"]},s=void 0,i={unversionedId:"DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/index",id:"DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/index",title:"Zabbix v6 Apache 2 Monitor",description:"Guangzhou, China",source:"@site/docs/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/index.md",sourceDirName:"DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor",slug:"/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/2022-01-14",permalink:"/docs/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/2022-01-14",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/index.md",tags:[{label:"Zabbix",permalink:"/docs/tags/zabbix"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"Apache",permalink:"/docs/tags/apache"}],version:"current",sidebarPosition:8060,frontMatter:{sidebar_position:8060,slug:"2022-01-14",title:"Zabbix v6 Apache 2 Monitor",authors:"mpolinowski",tags:["Zabbix","Linux","Apache"]},sidebar:"tutorialSidebar",previous:{title:"Zabbix v6 Docker Monitor",permalink:"/docs/DevOps/Zabbix/2022-01-14--zabbix-docker-monitor/2022-01-14"},next:{title:"Zabbix v6 Docker-Compose Setup",permalink:"/docs/DevOps/Zabbix/2022-01-13--zabbix-server-v6/2022-01-13"}},c={},l=[{value:"Apache Module mod_status",id:"apache-module-mod_status",level:2},{value:"Configure Zabbix Agent",id:"configure-zabbix-agent",level:2},{value:"ERROR :: Apache Process is not running",id:"error--apache-process-is-not-running",level:2}],p={toc:l};function u(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Guangzhou, China",src:a(92058).Z,width:"1500",height:"467"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#apache-module-mod_status"},"Apache Module mod_status")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#configure-zabbix-agent"},"Configure Zabbix Agent")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#error--apache-process-is-not-running"},"ERROR :: Apache Process is not running"))),(0,r.kt)("h2",{id:"apache-module-mod_status"},"Apache Module mod_status"),(0,r.kt)("p",null,"Activate the ",(0,r.kt)("strong",{parentName:"p"},"Server Status")," module:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo a2enmod status\n")),(0,r.kt)("p",null,"And add the configuration to:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cp /etc/apache2/mods-available/status.conf /etc/apache2/mods-available/status.conf.bak\nnano /etc/apache2/mods-available/status.conf\n")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://httpd.apache.org/docs/2.4/mod/mod_status.html"},"Enabling Status Support")," for the host you want to monitor:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<IfModule mod_status.c>\n        # Allow server status reports generated by mod_status,\n        # with the URL of http://servername/server-status\n        # Uncomment and change the "192.0.2.0/24" to allow access from other hosts.\n\n        <Location /server-status>\n                SetHandler server-status\n\n                ##Allow all IPs to access for testing\n                #Allow from all\n\n                ##Allow only localhost and local server IP\n                Order deny,allow\n                Deny from all\n                Allow from 127.0.0.1 ::1\n                #Allow from Your.Server.IP.Address.Here\n\n                ##Limit access from other hosts\n                #Require local\n                #Require ip 192.0.2.0/24\n                #Require host example.com\n        </Location>\n\n        # Keep track of extended status information for each request\n        ExtendedStatus On\n\n        # Determine if mod_status displays the first 63 characters of a request or\n        # the last 63, assuming the request itself is greater than 63 chars.\n        # Default: Off\n        #SeeRequestTail On\n        <IfModule mod_proxy.c>\n                # Show Proxy LoadBalancer status in mod_status\n                ProxyStatus On\n        </IfModule>\n</IfModule>\n')),(0,r.kt)("p",null,"Check config integrity and restart:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"apachectl configtest\napache2 -t # or httpd -t\nsystemctl restart apache2 # or httpd\n")),(0,r.kt)("p",null,"Or all in one line:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"apache2ctl -t && apache2ctl graceful\n")),(0,r.kt)("p",null,"Test the status output by:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl http://127.0.0.1/server-status?auto\n127.0.0.1\nServerVersion: Apache/2.4.25 (Debian) OpenSSL/1.0.2q\nServerMPM: prefork\nServer Built: 2018-11-03T18:46:19\nCurrentTime: Tuesday, 09-Nov-2021 07:24:39 CET\nRestartTime: Tuesday, 09-Nov-2021 06:44:31 CET\nParentServerConfigGeneration: 1\nParentServerMPMGeneration: 0\nServerUptimeSeconds: 2408\nServerUptime: 40 minutes 8 seconds\nLoad1: 0.07\nLoad5: 0.24\nLoad15: 0.53\nTotal Accesses: 319\nTotal kBytes: 1554\nCPUUser: 5.52\nCPUSystem: 2.06\nCPUChildrenUser: 0\nCPUChildrenSystem: 0\nCPULoad: .314784\nUptime: 2408\nReqPerSec: .132475\nBytesPerSec: 660.837\nBytesPerReq: 4988.39\nBusyWorkers: 2\nIdleWorkers: 8\nScoreboard: _W____W___............................................................................................................................................\nTLSSessionCacheStatus\nCacheType: SHMCB\nCacheSharedMemory: 512000\nCacheCurrentEntries: 35\nCacheSubcaches: 32\nCacheIndexesPerSubcaches: 88\nCacheTimeLeftOldestAvg: 123\nCacheTimeLeftOldestMin: 0\nCacheTimeLeftOldestMax: 262\nCacheIndexUsage: 1%\nCacheUsage: 1%\nCacheStoreCount: 279\nCacheReplaceCount: 0\nCacheExpireCount: 244\nCacheDiscardCount: 0\nCacheRetrieveHitCount: 0\nCacheRetrieveMissCount: 38\nCacheRemoveHitCount: 0\nCacheRemoveMissCount: 0\n")),(0,r.kt)("h2",{id:"configure-zabbix-agent"},"Configure Zabbix Agent"),(0,r.kt)("p",null,"Stat by adding the ",(0,r.kt)("strong",{parentName:"p"},"Apache by Zabbix Agent")," template:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Zabbix Apache Monitor",src:a(21323).Z,width:"1040",height:"397"})),(0,r.kt)("p",null,"Make sure that the server is set to ",(0,r.kt)("inlineCode",{parentName:"p"},"127.0.0.1")," and save the configuration:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Zabbix Apache Monitor",src:a(51779).Z,width:"1033",height:"607"})),(0,r.kt)("p",null,"Check latest data to see if your agent is working:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Zabbix Apache Monitor",src:a(56803).Z,width:"1242",height:"393"})),(0,r.kt)("h2",{id:"error--apache-process-is-not-running"},"ERROR :: Apache Process is not running"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Zabbix Apache Monitor",src:a(33473).Z,width:"1058",height:"90"})),(0,r.kt)("p",null,"The process name is set to ",(0,r.kt)("inlineCode",{parentName:"p"},"httpd")," by default - which is correct for Apache on CentOS. But has to be changed to ",(0,r.kt)("inlineCode",{parentName:"p"},"apache2")," for Debian:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Zabbix Apache Monitor",src:a(39490).Z,width:"1203",height:"224"})))}u.isMDXComponent=!0},21323:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_v6_Apache_Monitor_01-5015944f27e6f83af010faa1a1863199.png"},56803:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_v6_Apache_Monitor_02-2bc1023ccecdfa7f5dfde76bc42fc034.png"},51779:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_v6_Apache_Monitor_03-fdf020942fd10ce902106488c37004cd.png"},33473:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_v6_Apache_Monitor_04-4eb8f75b8869aaf3d660f3b18916b6bf.png"},39490:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_v6_Apache_Monitor_05-321aad164b1c13b21462a29890d9b9f7.png"},92058:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-539dc0d90c8fd4caf3d5cd5162b8ded5.jpg"}}]);