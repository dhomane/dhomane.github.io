"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[51254],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>u});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=d(a),u=r,h=m["".concat(s,".").concat(u)]||m[u]||p[u]||o;return a?n.createElement(h,i(i({ref:t},c),{},{components:a})):n.createElement(h,i({ref:t},c))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var d=2;d<o;d++)i[d]=a[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},62694:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var n=a(87462),r=(a(67294),a(3905));const o={sidebar_position:4780,slug:"2023-01-05",title:"Data Version Control",authors:"mpolinowski",tags:["Python","Machine Learning"],description:"Open-source Version Control System for Machine Learning Projects."},i=void 0,l={unversionedId:"IoT-and-Machine-Learning/AIOps/2023-01-05-dvc-model-version-control/index",id:"IoT-and-Machine-Learning/AIOps/2023-01-05-dvc-model-version-control/index",title:"Data Version Control",description:"Open-source Version Control System for Machine Learning Projects.",source:"@site/docs/IoT-and-Machine-Learning/AIOps/2023-01-05-dvc-model-version-control/index.md",sourceDirName:"IoT-and-Machine-Learning/AIOps/2023-01-05-dvc-model-version-control",slug:"/IoT-and-Machine-Learning/AIOps/2023-01-05-dvc-model-version-control/2023-01-05",permalink:"/docs/IoT-and-Machine-Learning/AIOps/2023-01-05-dvc-model-version-control/2023-01-05",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/AIOps/2023-01-05-dvc-model-version-control/index.md",tags:[{label:"Python",permalink:"/docs/tags/python"},{label:"Machine Learning",permalink:"/docs/tags/machine-learning"}],version:"current",sidebarPosition:4780,frontMatter:{sidebar_position:4780,slug:"2023-01-05",title:"Data Version Control",authors:"mpolinowski",tags:["Python","Machine Learning"],description:"Open-source Version Control System for Machine Learning Projects."},sidebar:"tutorialSidebar",previous:{title:"DVC Model Access",permalink:"/docs/IoT-and-Machine-Learning/AIOps/2023-01-06-dvc-model-access/2023-01-05"},next:{title:"Distributed training with TensorFlow",permalink:"/docs/IoT-and-Machine-Learning/AIOps/2023-01-04-tf-distributed-strategy/2023-01-04"}},s={},d=[{value:"Getting Started",id:"getting-started",level:2},{value:"Install with pip",id:"install-with-pip",level:3},{value:"Initialize a ML Project",id:"initialize-a-ml-project",level:3},{value:"Data Management Trail",id:"data-management-trail",level:2},{value:"Data Versioning",id:"data-versioning",level:3},{value:"Storing and Sharing",id:"storing-and-sharing",level:3},{value:"Remote",id:"remote",level:4},{value:"ssh",id:"ssh",level:5},{value:"local",id:"local",level:5},{value:"Push &amp; Pull Data",id:"push--pull-data",level:4}],c={toc:d};function p(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Guangzhou, China",src:a(4402).Z,width:"1500",height:"662"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#getting-started"},"Getting Started"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#install-with-pip"},"Install with pip")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#initialize-a-ml-project"},"Initialize a ML Project")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#data-management-trail"},"Data Management Trail"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#data-versioning"},"Data Versioning")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#storing-and-sharing"},"Storing and Sharing"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#remote"},"Remote"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#ssh"},"ssh")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#local"},"local")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#push--pull-data"},"Push \\& Pull Data"))))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Data Version Control")," is a ",(0,r.kt)("a",{parentName:"p",href:"https://dvc.org/doc/start/data-management/data-versioning"},"data versioning"),", ML ",(0,r.kt)("a",{parentName:"p",href:"https://dvc.org/doc/user-guide/pipelines"},"workflow automation"),", and ",(0,r.kt)("a",{parentName:"p",href:"https://dvc.org/doc/user-guide/experiment-management"},"experiment management")," tool that takes advantage of the existing software engineering toolset you're already familiar with (Git, your IDE, CI/CD, etc.). DVC helps data science and machine learning teams manage large datasets, make projects reproducible, and better collaborate."),(0,r.kt)("h2",{id:"getting-started"},"Getting Started"),(0,r.kt)("p",null,"To use DVC as a Python library, please install with ",(0,r.kt)("inlineCode",{parentName:"p"},"pip")," or with ",(0,r.kt)("inlineCode",{parentName:"p"},"conda"),":"),(0,r.kt)("h3",{id:"install-with-pip"},"Install with pip"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"pip install dvc\n")),(0,r.kt)("h3",{id:"initialize-a-ml-project"},"Initialize a ML Project"),(0,r.kt)("p",null,"Initialize the project by running ",(0,r.kt)("inlineCode",{parentName:"p"},"dvc init")," inside a Git project:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir my-project\ncd my-project\ngit init\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dvc init\n\nInitialized DVC repository.\nYou can now commit the changes to git.\n")),(0,r.kt)("p",null,"A few internal files are created that should be added to Git:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'git commit -m "Initialize DVC"\n\n[master (root-commit) ed9cc50] Initialize DVC\n 3 files changed, 6 insertions(+)\n create mode 100755 .dvc/.gitignore\n create mode 100755 .dvc/config\n create mode 100755 .dvcignore\n')),(0,r.kt)("h2",{id:"data-management-trail"},"Data Management Trail"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://dvc.org/doc/start/data-management/data-versioning"},"Data and model versioning")," is the base layer of DVC for large files, datasets, and machine learning models. Use a standard Git workflow, but without storing large files in the repo. Data is cached by DVC, allowing for efficient sharing.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://dvc.org/doc/start/data-management/data-and-model-access"},"Data and model access")," goes over using data artifacts from outside of the project and importing them from another DVC project. This can help to download a specific version of an ML model to a deployment server or import a dataset into another project.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://dvc.org/doc/start/data-management/data-pipelines"},"Data pipelines"),' describe how models and other data artifacts are built, and provide an efficient way to reproduce them. Think "Makefiles for data and ML projects" done right.')),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://dvc.org/doc/start/data-management/metrics-parameters-plots"},"Metrics, parameters, and plots")," can be attached to pipelines. These let you capture, evaluate, and visualize ML projects without leaving Git."))),(0,r.kt)("h3",{id:"data-versioning"},"Data Versioning"),(0,r.kt)("p",null,"Having initialized a project in the previous section, we can get the data file (which we'll be using later) like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dvc get https://github.com/iterative/dataset-registry \\\n          get-started/data.xml -o data/data.xml\n")),(0,r.kt)("p",null,"To start tracking a file or directory, use dvc add:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dvc add data/data.xml\n")),(0,r.kt)("p",null,"DVC stores information about the added file in a ",(0,r.kt)("inlineCode",{parentName:"p"},".dvc")," file named ",(0,r.kt)("inlineCode",{parentName:"p"},"data/data.xml.dvc"),". This metadata file is a placeholder for the original data, and can be easily versioned like source code with Git. The data, meanwhile, is listed in ",(0,r.kt)("inlineCode",{parentName:"p"},".gitignore"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'git add data/data.xml.dvc data/.gitignore\ngit commit -m "Add raw data"\n')),(0,r.kt)("h3",{id:"storing-and-sharing"},"Storing and Sharing"),(0,r.kt)("h4",{id:"remote"},"Remote"),(0,r.kt)("p",null,"The same way as GitHub provides storage hosting for Git repositories, DVC remotes provide a location to store and share data and models. You can pull data assets created by colleagues from DVC remotes without spending time and resources to build or process them locally. Remote storage can also save space on your local environment \u2013 DVC can fetch into the cache directory only the data you need for a specific branch/commit."),(0,r.kt)("p",null,"Using ",(0,r.kt)("a",{parentName:"p",href:"https://dvc.org/doc/command-reference/remote"},"DVC with remote storage")," is optional. DVC commands use the local cache (usually in dir ",(0,r.kt)("inlineCode",{parentName:"p"},".dvc/cache"),") as data storage by default. This enables the main DVC usage scenarios out of the box."),(0,r.kt)("p",null,"DVC supports several types of remote storage: ",(0,r.kt)("a",{parentName:"p",href:"https://dvc.org/doc/command-reference/remote/add#supported-storage-types"},"local file system, SSH, Amazon S3, Google Cloud Storage, HTTP, HDFS, among others"),"."),(0,r.kt)("h5",{id:"ssh"},"ssh"),(0,r.kt)("p",null,"DVC requires both ",(0,r.kt)("a",{parentName:"p",href:"https://dvc.org/doc/command-reference/remote/modify#ssh"},"SSH and SFTP access to work with remote SSH locations"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dvc remote modify myremote url \\\n                    ssh://user@example.com:1234/path\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"url")," - remote location, in a regular SSH format. Note that this can already include the user parameter, embedded into the URL.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dvc remote modify --local myremote user myuser\ndvc remote modify myremote port 2222\ndvc remote modify --local myremote keyfile /path/to/keyfile\ndvc remote modify --local myremote password mypassword\ndvc remote modify myremote ask_password true\ndvc remote modify --local myremote passphrase mypassphrase\ndvc remote modify myremote ask_passphrase true\ndvc remote rename oldremote newremote\ndvc remote remove oldremote\n")),(0,r.kt)("h5",{id:"local"},"local"),(0,r.kt)("p",null,"While the term may seem contradictory, it doesn't have to be. The ",(0,r.kt)("inlineCode",{parentName:"p"},"local")," part refers to the type of location where the storage is: another directory in the same file system."),(0,r.kt)("p",null,"We use the ",(0,r.kt)("inlineCode",{parentName:"p"},"-d")," (",(0,r.kt)("inlineCode",{parentName:"p"},"--default"),") option of dvc remote add for this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dvc remote add -d demo-data /run/media/myuser/files/dvc\nSetting 'demo-data' as a default remote.\n")),(0,r.kt)("p",null,"The project's config file should now look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"[core]\n    remote = demo-data\n['remote \"demo-data\"']\n    url = /run/media/myuser/files/dvc\n")),(0,r.kt)("p",null,"List all remotes in the project:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dvc remote list\ndemo-data       /run/media/myuser/files/dvc\n")),(0,r.kt)("p",null,"Now we need to exclude everything from Git:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'git add .dvc/config\ngit commit -m "Configure remote storage"\n')),(0,r.kt)("h4",{id:"push--pull-data"},"Push & Pull Data"),(0,r.kt)("p",null,"You can upload DVC-tracked data or model files with ",(0,r.kt)("inlineCode",{parentName:"p"},"dvc push"),", so they're safely stored remotely. This also means they can be retrieved on other environments later with ",(0,r.kt)("inlineCode",{parentName:"p"},"dvc pull"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dvc push\n1 file pushed\n")),(0,r.kt)("p",null,"Having DVC-tracked data and models stored remotely, it can be downloaded when needed in other copies of this project with ",(0,r.kt)("inlineCode",{parentName:"p"},"dvc pull"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dvc pull\nEverything is up to date.\n")),(0,r.kt)("p",null,"After updating your local dataset run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'dvc add data/data.xml\ngit commit data/data.xml.dvc -m "Dataset updates"\ndvc push\n')),(0,r.kt)("p",null,"To switch between datasets:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'git checkout HEAD~1 data/data.xml.dvc\ndvc checkout\ngit commit data/data.xml.dvc -m "Revert dataset updates"\n')),(0,r.kt)("p",null,"DVC is technically not a version control system. Git itself provides that layer. DVC in turn manipulates .dvc files, whose contents define the data file versions."))}p.isMDXComponent=!0},4402:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-296769d73822f07b0ac5dc952f56bfa1.jpg"}}]);