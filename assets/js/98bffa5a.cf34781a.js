"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[90569],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>d});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),c=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),m=c(r),d=n,f=m["".concat(s,".").concat(d)]||m[d]||p[d]||o;return r?a.createElement(f,l(l({ref:t},u),{},{components:r})):a.createElement(f,l({ref:t},u))}));function d(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,l=new Array(o);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:n,l[1]=i;for(var c=2;c<o;c++)l[c]=r[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},70415:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var a=r(87462),n=(r(67294),r(3905));const o={sidebar_position:6090,slug:"2021-09-05",title:"Hashicorp Terraform - Setup",authors:"mpolinowski",tags:["Terraform","Linux"]},l=void 0,i={unversionedId:"DevOps/Hashicorp/2021-09-05--hashicorp-terraform-setup/index",id:"DevOps/Hashicorp/2021-09-05--hashicorp-terraform-setup/index",title:"Hashicorp Terraform - Setup",description:"Victoria Harbour, Hong Kong",source:"@site/docs/DevOps/Hashicorp/2021-09-05--hashicorp-terraform-setup/index.md",sourceDirName:"DevOps/Hashicorp/2021-09-05--hashicorp-terraform-setup",slug:"/DevOps/Hashicorp/2021-09-05--hashicorp-terraform-setup/2021-09-05",permalink:"/docs/DevOps/Hashicorp/2021-09-05--hashicorp-terraform-setup/2021-09-05",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Hashicorp/2021-09-05--hashicorp-terraform-setup/index.md",tags:[{label:"Terraform",permalink:"/docs/tags/terraform"},{label:"Linux",permalink:"/docs/tags/linux"}],version:"current",sidebarPosition:6090,frontMatter:{sidebar_position:6090,slug:"2021-09-05",title:"Hashicorp Terraform - Setup",authors:"mpolinowski",tags:["Terraform","Linux"]},sidebar:"tutorialSidebar",previous:{title:"Hashicorp Terraform - Providers, Variables & Attributes",permalink:"/docs/DevOps/Hashicorp/2021-09-06--hashicorp-terraform-providers-variables-attributes/2021-09-07"},next:{title:"Hashicorp Vault - Logging",permalink:"/docs/DevOps/Hashicorp/2021-08-25--hashicorp-vault-logging/2021-08-25"}},s={},c=[{value:"Infrastructure as Code",id:"infrastructure-as-code",level:2},{value:"Toolsets",id:"toolsets",level:3},{value:"Installation",id:"installation",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Create a File",id:"create-a-file",level:3},{value:"Create a File from a Template",id:"create-a-file-from-a-template",level:3},{value:"Create Multiple Instances of a File",id:"create-multiple-instances-of-a-file",level:3},{value:"Count",id:"count",level:4},{value:"For-Each",id:"for-each",level:4},{value:"Terraform Life Cycle",id:"terraform-life-cycle",level:2},{value:"File Format (Optional)",id:"file-format-optional",level:3},{value:"Validtation",id:"validtation",level:3},{value:"Initialization",id:"initialization",level:3},{value:"Planning",id:"planning",level:3},{value:"Run",id:"run",level:3},{value:"Verify",id:"verify",level:3},{value:"Destroy",id:"destroy",level:3},{value:"Life Cycle Rules",id:"life-cycle-rules",level:3},{value:"Create Before Destroy",id:"create-before-destroy",level:4},{value:"Prevent Destroy",id:"prevent-destroy",level:4},{value:"Ignore Changes",id:"ignore-changes",level:4}],u={toc:c};function p(e){let{components:t,...o}=e;return(0,n.kt)("wrapper",(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Victoria Harbour, Hong Kong",src:r(89450).Z,width:"1500",height:"362"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#infrastructure-as-code"},"Infrastructure as Code"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#toolsets"},"Toolsets")))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#installation"},"Installation")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#configuration"},"Configuration"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#create-a-file"},"Create a File")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#create-a-file-from-a-template"},"Create a File from a Template")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#create-multiple-instances-of-a-file"},"Create Multiple Instances of a File"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#count"},"Count")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#for-each"},"For-Each")))))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#terraform-life-cycle"},"Terraform Life Cycle"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#file-format-optional"},"File Format (Optional)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#validtation"},"Validtation")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#initialization"},"Initialization")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#planning"},"Planning")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#run"},"Run")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#verify"},"Verify")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#destroy"},"Destroy")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#life-cycle-rules"},"Life Cycle Rules"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#create-before-destroy"},"Create Before Destroy")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#prevent-destroy"},"Prevent Destroy")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#ignore-changes"},"Ignore Changes"))))))),(0,n.kt)("p",null,"Terraform allows infrastructure to be expressed as code. The desired state is expressed in a simple human readable language. Terraform uses this language to provide an execution plan of changes, which can be reviewed for safety and then applied to make changes. Extensible providers allow Terraform to manage a broad range of resources, including hardware, IaaS, PaaS, and SaaS services."),(0,n.kt)("h2",{id:"infrastructure-as-code"},"Infrastructure as Code"),(0,n.kt)("p",null,"Use infrastructure as code to provision infrastructure. Codification enables version control and automation, reducing human error and increasing productivity. Codification allows infrastructure changes to be automated, while keeping the definition human readable"),(0,n.kt)("h3",{id:"toolsets"},"Toolsets"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Configuration Management"),(0,n.kt)("th",{parentName:"tr",align:null},"Server Templating"),(0,n.kt)("th",{parentName:"tr",align:null},"Server Provisioning"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"/docs/DevOps/Hashicorp/2020-08-15--installing-nomad-ubuntu/2020-08-15"},"Nomad"),", ",(0,n.kt)("a",{parentName:"td",href:"/docs/DevOps/Ansible/2021-04-28-ansible-tower-rhel/2021-04-28"},"Ansible"),", ",(0,n.kt)("a",{parentName:"td",href:"/docs/DevOps/Salt/2020-06-14--install-salt-on-ubuntu-20-04/2020-06-14"},"SaltStack")),(0,n.kt)("td",{parentName:"tr",align:null},"Docker, Vagrant, ",(0,n.kt)("a",{parentName:"td",href:"/docs/DevOps/Hashicorp/2020-10-25--hashicorp-packer-and-virtualbox-autoinstall/2020-10-25"},"Packer")),(0,n.kt)("td",{parentName:"tr",align:null},"Terraform, Docker Compose or Docker Swarm")))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Configuration Management")," tools install and configure software. Maintain configuration structures (Version Control) and are idempotent (every run results in the same server state - no matter what state the server was in before)."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Server Templating")," tools create images that contain all desired software and their dependencies. Running these images provide an immutable software infrastructure."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Server Provisioning")," tools deploy immutable infrastructure to cloud provider with declarative code.")),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"So what is the difference between Nomad and Terraform? Only the provider plugins that directly connect you to Cloud providers like AWS or GCE ?")),(0,n.kt)("h2",{id:"installation"},"Installation"),(0,n.kt)("p",null,"You can download the latest version of Terraform as a binary from the ",(0,n.kt)("a",{parentName:"p",href:"https://releases.hashicorp.com/terraform/"},"Hashicorp Releases"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"wget https://releases.hashicorp.com/terraform/1.0.7/terraform_1.0.7_linux_amd64.zip\nunzip terraform_1.0.7_linux_amd64.zip\nrm terraform_1.0.7_linux_amd64.zip\nsudo mv terraform /usr/bin/terraform\n")),(0,n.kt)("p",null,"Verify that it is working:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"terraform -v\n\nTerraform v1.0.7\non linux_amd64\n")),(0,n.kt)("h2",{id:"configuration"},"Configuration"),(0,n.kt)("p",null,"Start by creating a directory where you want to store your configuration:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo mkdir /etc/terraform.d\n")),(0,n.kt)("p",null,"As ",(0,n.kt)("a",{parentName:"p",href:"https://registry.terraform.io/browse/providers"},"provider")," I want to start out with local resources which would be represented by a configuration file like:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo nano /etc/terraform.d/main.tf\n")),(0,n.kt)("h3",{id:"create-a-file"},"Create a File"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'resource "local_file" "resource_name" {\n  filename = "/opt/resource.txt"\n  content = "some content"\n  directory_permission = "0777"\n  file_permission = "0700"\n}\n')),(0,n.kt)("h3",{id:"create-a-file-from-a-template"},"Create a File from a Template"),(0,n.kt)("p",null,"If the file is created by another tool like Nomad and you want Terraform to use it you can use the ",(0,n.kt)("strong",{parentName:"p"},"Data","_","Block")," instead of an ",(0,n.kt)("strong",{parentName:"p"},"Ressource","_","Block"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'resource "local_file" "resource_name" {\n  filename = "/opt/resource.txt"\n  content = data.local_file.dog.content\n  directory_permission = "0777"\n  file_permission = "0700"\n}\n\ndata "local_file" "data" {\n  filename = "/opt/data.txt"\n}\n')),(0,n.kt)("h3",{id:"create-multiple-instances-of-a-file"},"Create Multiple Instances of a File"),(0,n.kt)("h4",{id:"count"},"Count"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"main.tf")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'resource "local_file" "resource_name" {\n  filename = var.filename[count.index]\n  content = "some content"\n  directory_permission = "0777"\n  file_permission = "0700"\n\n  count = length(var.filename)\n\n}\n')),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"variables.tf")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'variable "filename" {\n  default = [\n    "/opt/resource1.txt",\n    "/opt/resource2.txt",\n    "/opt/resource3.txt"\n  ]\n}\n')),(0,n.kt)("h4",{id:"for-each"},"For-Each"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"main.tf")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'resource "local_file" "resource_name" {\n  filename = each.value\n  content = "some content"\n  directory_permission = "0777"\n  file_permission = "0700"\n\n  for_each = var.filename\n\n}\n')),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"variables.tf")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'variable "filename" {\n  type=set(string)\n  default = [\n    "/opt/resource1.txt",\n    "/opt/resource2.txt",\n    "/opt/resource3.txt"\n  ]\n}\n')),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"for-each")," can only be used with variable sets (sets = lists without duplicated members)."),(0,n.kt)("h2",{id:"terraform-life-cycle"},"Terraform Life Cycle"),(0,n.kt)("p",null,"Run the following commands from the directory you created the configuration file in:"),(0,n.kt)("h3",{id:"file-format-optional"},"File Format (Optional)"),(0,n.kt)("p",null,"Making sure that the file is in a canonical format:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo terraform fmt\nmain.tf\n")),(0,n.kt)("h3",{id:"validtation"},"Validtation"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"terraform validate\nSuccess! The configuration is valid.\n")),(0,n.kt)("h3",{id:"initialization"},"Initialization"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'sudo terraform init\n\nInitializing the backend...\n\nInitializing provider plugins...\n- Finding latest version of hashicorp/local...\n- Installing hashicorp/local v2.1.0...\n- Installed hashicorp/local v2.1.0 (signed by HashiCorp)\n\nTerraform has created a lock file .terraform.lock.hcl to record the provider\nselections it made above. Include this file in your version control repository\nso that Terraform can guarantee to make the same selections by default when\nyou run "terraform init" in the future.\n\nTerraform has been successfully initialized!\n\nYou may now begin working with Terraform. Try running "terraform plan" to see\nany changes that are required for your infrastructure. All Terraform commands\nshould now work.\n\nIf you ever set or change modules or backend configuration for Terraform,\nrerun this command to reinitialize your working directory. If you forget, other\ncommands will detect it and remind you to do so if necessary.\n')),(0,n.kt)("h3",{id:"planning"},"Planning"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'sudo terraform plan\n\nTerraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:\n  + create\n\nTerraform will perform the following actions:\n\n  # local_file.resource_name will be created\n  + resource "local_file" "resource_name" {\n      + content              = "some content"\n      + directory_permission = "0777"\n      + file_permission      = "0700"\n      + filename             = "/opt/resource.txt"\n      + id                   = (known after apply)\n    }\n\nPlan: 1 to add, 0 to change, 0 to destroy.\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nNote: You didn\'t use the -out option to save this plan, so Terraform can\'t guarantee to take exactly these actions if you run "terraform\napply" now.\n')),(0,n.kt)("h3",{id:"run"},"Run"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'sudo terraform apply\n\nTerraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:\n  + create\n\nTerraform will perform the following actions:\n\n  # local_file.resource_name will be created\n  + resource "local_file" "resource_name" {\n      + content              = "some content"\n      + directory_permission = "0777"\n      + file_permission      = "0700"\n      + filename             = "/opt/resource.txt"\n      + id                   = (known after apply)\n    }\n\nPlan: 1 to add, 0 to change, 0 to destroy.\n\nDo you want to perform these actions?\n  Terraform will perform the actions described above.\n  Only \'yes\' will be accepted to approve.\n\n  Enter a value: yes\n\nlocal_file.resource_name: Creating...\nlocal_file.resource_name: Creation complete after 0s [id=94e66df8cd09d410c62d9e0dc59d3a884e458e05]\n')),(0,n.kt)("h3",{id:"verify"},"Verify"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'sudo terraform show\n\n# local_file.resource_name:\nresource "local_file" "resource_name" {\n    content              = "some content"\n    directory_permission = "0777"\n    file_permission      = "0700"\n    filename             = "/opt/resource.txt"\n    id                   = "94e66df8cd09d410c62d9e0dc59d3a884e458e05"\n}\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo cat /opt/resource.txt\nsome content\n")),(0,n.kt)("h3",{id:"destroy"},"Destroy"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'sudo terraform destroy\n\nlocal_file.resource_name: Refreshing state... [id=94e66df8cd09d410c62d9e0dc59d3a884e458e05]\n\nTerraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:\n  - destroy\n\nTerraform will perform the following actions:\n\n  # local_file.resource_name will be destroyed\n  - resource "local_file" "resource_name" {\n      - content              = "some content" -> null\n      - directory_permission = "0777" -> null\n      - file_permission      = "0700" -> null\n      - filename             = "/opt/resource.txt" -> null\n      - id                   = "94e66df8cd09d410c62d9e0dc59d3a884e458e05" -> null\n    }\n\nPlan: 0 to add, 0 to change, 1 to destroy.\n\nDo you really want to destroy all resources?\n  Terraform will destroy all your managed infrastructure, as shown above.\n  There is no undo. Only \'yes\' will be accepted to confirm.\n\n  Enter a value: yes\n\nlocal_file.resource_name: Destroying... [id=94e66df8cd09d410c62d9e0dc59d3a884e458e05]\nlocal_file.resource_name: Destruction complete after 0s\n')),(0,n.kt)("h3",{id:"life-cycle-rules"},"Life Cycle Rules"),(0,n.kt)("h4",{id:"create-before-destroy"},"Create Before Destroy"),(0,n.kt)("p",null,"When changes are made to your infrastructure Terraform first deletes the old state, then it re-creates the infrastructure in the new state. To revert use:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'resource "local_file" "resource_name" {\n  filename = "/opt/resource.txt"\n  content = "some content"\n  directory_permission = "0777"\n  file_permission = "0700"\n\n  lifecycle {\n   create_before_destroy = true \n  }\n}\n')),(0,n.kt)("h4",{id:"prevent-destroy"},"Prevent Destroy"),(0,n.kt)("p",null,"If you don't want old version to be destroyed by changes - ",(0,n.kt)("inlineCode",{parentName:"p"},"terraform destroy")," will still remove everything:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'resource "local_file" "resource_name" {\n  filename = "/opt/resource.txt"\n  content = "some content"\n  directory_permission = "0777"\n  file_permission = "0700"\n\n  lifecycle {\n   prevent_destroy = true \n  }\n}\n')),(0,n.kt)("h4",{id:"ignore-changes"},"Ignore Changes"),(0,n.kt)("p",null,"A re-run of the Terraform task should not change back something if it has been changed by an external software - or use ",(0,n.kt)("inlineCode",{parentName:"p"},"ignore_changes = all")," to ignore everything:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'resource "local_file" "resource_name" {\n  filename = "/opt/resource.txt"\n  content = "some content"\n  directory_permission = "0777"\n  file_permission = "0700"\n\n  lifecycle {\n   ignore_changes = [\n     file_permission\n   ]\n  }\n}\n')))}p.isMDXComponent=!0},89450:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-b4069a75bcc367b963068ceb94b1fc89.jpg"}}]);