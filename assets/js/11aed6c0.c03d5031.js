"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[46173],{3905:(a,e,n)=>{n.d(e,{Zo:()=>p,kt:()=>g});var r=n(67294);function t(a,e,n){return e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function o(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.push.apply(n,r)}return n}function s(a){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){t(a,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(n,e))}))}return a}function i(a,e){if(null==a)return{};var n,r,t=function(a,e){if(null==a)return{};var n,r,t={},o=Object.keys(a);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(t[n]=a[n]);return t}(a,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(a,n)&&(t[n]=a[n])}return t}var l=r.createContext({}),d=function(a){var e=r.useContext(l),n=e;return a&&(n="function"==typeof a?a(e):s(s({},e),a)),n},p=function(a){var e=d(a.components);return r.createElement(l.Provider,{value:e},a.children)},c={inlineCode:"code",wrapper:function(a){var e=a.children;return r.createElement(r.Fragment,{},e)}},b=r.forwardRef((function(a,e){var n=a.components,t=a.mdxType,o=a.originalType,l=a.parentName,p=i(a,["components","mdxType","originalType","parentName"]),b=d(n),g=t,f=b["".concat(l,".").concat(g)]||b[g]||c[g]||o;return n?r.createElement(f,s(s({ref:e},p),{},{components:n})):r.createElement(f,s({ref:e},p))}));function g(a,e){var n=arguments,t=e&&e.mdxType;if("string"==typeof a||t){var o=n.length,s=new Array(o);s[0]=b;var i={};for(var l in e)hasOwnProperty.call(e,l)&&(i[l]=e[l]);i.originalType=a,i.mdxType="string"==typeof a?a:t,s[1]=i;for(var d=2;d<o;d++)s[d]=n[d];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}b.displayName="MDXCreateElement"},74691:(a,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var r=n(87462),t=(n(67294),n(3905));const o={sidebar_position:8020,slug:"2022-01-15",title:"Grafana Dashboard for Zabbix v6",authors:"mpolinowski",tags:["Grafana","Zabbix","Linux","Docker"]},s=void 0,i={unversionedId:"DevOps/Zabbix/2022-01-15--zabbix-grafana-dashboard/index",id:"DevOps/Zabbix/2022-01-15--zabbix-grafana-dashboard/index",title:"Grafana Dashboard for Zabbix v6",description:"Guangzhou, China",source:"@site/docs/DevOps/Zabbix/2022-01-15--zabbix-grafana-dashboard/index.md",sourceDirName:"DevOps/Zabbix/2022-01-15--zabbix-grafana-dashboard",slug:"/DevOps/Zabbix/2022-01-15--zabbix-grafana-dashboard/2022-01-15",permalink:"/docs/DevOps/Zabbix/2022-01-15--zabbix-grafana-dashboard/2022-01-15",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Zabbix/2022-01-15--zabbix-grafana-dashboard/index.md",tags:[{label:"Grafana",permalink:"/docs/tags/grafana"},{label:"Zabbix",permalink:"/docs/tags/zabbix"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"Docker",permalink:"/docs/tags/docker"}],version:"current",sidebarPosition:8020,frontMatter:{sidebar_position:8020,slug:"2022-01-15",title:"Grafana Dashboard for Zabbix v6",authors:"mpolinowski",tags:["Grafana","Zabbix","Linux","Docker"]},sidebar:"tutorialSidebar",previous:{title:"Zabbix v6 Email Notifications",permalink:"/docs/DevOps/Zabbix/2022-01-15--zabbix-v6-email-notifications/2022-01-15"},next:{title:"Zabbix v6 NGINX Monitor",permalink:"/docs/DevOps/Zabbix/2022-01-14--zabbix-nginx-monitor/2022-01-14"}},l={},d=[{value:"Set Up Grafana",id:"set-up-grafana",level:2},{value:"Docker",id:"docker",level:3},{value:"Docker-Compose",id:"docker-compose",level:3},{value:"Permission Issues",id:"permission-issues",level:3},{value:"UPDATE",id:"update",level:4},{value:"Find User ID",id:"find-user-id",level:4},{value:"Manually Add the Zabbix Plugin",id:"manually-add-the-zabbix-plugin",level:4},{value:"Test Networking",id:"test-networking",level:4},{value:"Back on track with Docker-Compose",id:"back-on-track-with-docker-compose",level:3},{value:"Configure Grafana",id:"configure-grafana",level:2},{value:"Problem - No Data",id:"problem---no-data",level:3}],p={toc:d};function c(a){let{components:e,...o}=a;return(0,t.kt)("wrapper",(0,r.Z)({},p,o,{components:e,mdxType:"MDXLayout"}),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Guangzhou, China",src:n(1677).Z,width:"1500",height:"467"})),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#set-up-grafana"},"Set Up Grafana"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#docker"},"Docker")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#docker-compose"},"Docker-Compose")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#permission-issues"},"Permission Issues"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#update"},"UPDATE")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#find-user-id"},"Find User ID")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#manually-add-the-zabbix-plugin"},"Manually Add the Zabbix Plugin")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#test-networking"},"Test Networking")))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#back-on-track-with-docker-compose"},"Back on track with Docker-Compose")))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#configure-grafana"},"Configure Grafana"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#problem---no-data"},"Problem - No Data"))))),(0,t.kt)("h2",{id:"set-up-grafana"},"Set Up Grafana"),(0,t.kt)("h3",{id:"docker"},"Docker"),(0,t.kt)("p",null,"To ",(0,t.kt)("a",{parentName:"p",href:"https://grafana.com/grafana/download?edition=oss&pg=get&plcmt=selfmanaged-box1-cta1&platform=docker"},"install Grafana")," directly run:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -d --name=grafana -p 3000:3000 grafana/grafana-oss:latest\n")),(0,t.kt)("p",null,"We now have to add the ",(0,t.kt)("a",{parentName:"p",href:"https://grafana.com/grafana/plugins/alexanderzobnin-zabbix-app/"},"Zabbix plugin")," using the Grafana CLI:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"docker exec -ti grafana sh -c 'grafana-cli plugins install alexanderzobnin-zabbix-app'\ndocker exec -ti grafana sh -c 'grafana-cli plugins ls'\ndocker restart grafana\n")),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"I just realized that the restart part is not going to work. You will have to mount a volume into the container where the plugins are stored to persist them ",(0,t.kt)("inlineCode",{parentName:"p"},"-v /my/dir:/var/lib/grafana"),".")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir -p /opt/grafana-compose/grafana\ndocker run -d --name=grafana -p 3000:3000 -v /opt/grafana-compose/grafana:/var/lib/grafana grafana/grafana-oss:latest\n")),(0,t.kt)("p",null,"I did not run this - you probably have to ",(0,t.kt)("strong",{parentName:"p"},"check folder permissions")," for the volume mount - docker-compose below. But let's go straight to Docker-Compose and add the Grafana instructions to our compose file."),(0,t.kt)("h3",{id:"docker-compose"},"Docker-Compose"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},(0,t.kt)("strong",{parentName:"p"},"Note"),": I am embedding this into my compose file for the ",(0,t.kt)("a",{parentName:"p",href:"/docs/DevOps/Zabbix/2022-01-13--zabbix-server-v6/2022-01-13"},"Zabbix Server")," (",(0,t.kt)("a",{parentName:"p",href:"#complete-compose-file"},"see full file below")," )")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yml"},"grafana-server:\n  container_name: grafana\n  image: grafana/grafana-oss:latest\n  networks:\n    zbx_net_backend:\n      ipv4_address: 172.16.239.105\n      aliases:\n        - grafana-server\n    zbx_net_frontend:\n      ipv4_address: 172.16.238.105\n  links:\n    - zabbix-server\n    - postgres-server\n  restart: always\n  ports:\n    - '3000:3000'\n  volumes:\n    - './grafana:/var/lib/grafana'\n    - './grafana/log:/var/log/grafana'\n  environment:\n    GF_INSTALL_PLUGINS: alexanderzobnin-zabbix-app\n  depends_on:\n    - zabbix-server\n    - postgres-server\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir -p /opt/grafana-compose/grafana/{lib,log}\n")),(0,t.kt)("p",null,"Run the file with ",(0,t.kt)("inlineCode",{parentName:"p"},"docker-compose up"),". If you keep seeing the following error message and the folder ",(0,t.kt)("inlineCode",{parentName:"p"},"/opt/grafana-compose/grafana")," (please change the directory to your needs) remains empty, you have an permission issue:"),(0,t.kt)("h3",{id:"permission-issues"},"Permission Issues"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir: can't create directory '/var/lib/grafana/plugins': Permission denied\nGF_PATHS_DATA='/var/lib/grafana' is not writable.\nYou may have issues with file permissions, more information here: http://docs.grafana.org/installation/docker/#migrate-to-v51-or-later\nmkdir: can't create directory '/var/lib/grafana/plugins': Permission denied\n")),(0,t.kt)("p",null,"Change the directory owner to ",(0,t.kt)("inlineCode",{parentName:"p"},"1000")," and change the write permissions to something sensible (I picked 777 for my test run... not to be used in production):"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"chown 1000:1000 /opt/grafana-compose/grafana/*\nchmod 777 /opt/grafana-compose/grafana/*\n")),(0,t.kt)("h4",{id:"update"},"UPDATE"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},(0,t.kt)("strong",{parentName:"p"},"UPDATE"),": For Grafana >v5.1 the ",(0,t.kt)("a",{parentName:"p",href:"http://docs.grafana.org/installation/docker/#migrate-to-v51-or-later"},"user permission changed"),"!")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"Migrate to v7.3 or later")),(0,t.kt)("p",null,"The Grafana Docker image runs with the root group (id 0) instead of the grafana group (id 472), for better compatibility with OpenShift. If you extend the official Docker image you may need to change your scripts to use the root group instead of grafana."),(0,t.kt)("h4",{id:"find-user-id"},"Find User ID"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'docker run -ti \\\n--name grafana \\\n--rm \\\n-p 3000:3000 \\\n--volume "/opt/grafana-compose/grafana/lib:/var/lib/grafana" \\\ngrafana/grafana-oss:latest /bin/ash\n')),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"docker exec -ti grafana /bin/ash                                                                                      \n/usr/share/grafana $ ls -la /var/lib/grafana\ndrwxrwxrwx    1 grafana  root          4096 Jan 26 04:41 .\ndrwxr-xr-x    1 root     root          4096 Jan 17 19:47 ..\ndrwxr-x---    3 grafana  root          4096 Jan 26 04:41 alerting\ndrwx------    2 grafana  root          4096 Jan 26 04:41 csv\n-rw-r-----    1 grafana  root        765952 Jan 26 04:41 grafana.db\ndrwxrwxrwx    2 grafana  root          4096 Jan 17 19:47 plugins\ndrwx------    2 grafana  root          4096 Jan 26 04:41 png\n/usr/share/grafana $ id grafana\nuid=472(grafana) gid=0(root) groups=0(root),0(root)\n")),(0,t.kt)("p",null,"The folder permission that the container uses are ",(0,t.kt)("inlineCode",{parentName:"p"},"grafana:root")," and the user ",(0,t.kt)("strong",{parentName:"p"},"grafana")," has the user ID ",(0,t.kt)("inlineCode",{parentName:"p"},"472"),". Let's exit the container and change the folder permission for the volume mount accordingly:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"chown 472:root /opt/grafana-compose/grafana/*\nchmod 777 /opt/grafana-compose/grafana/*\n")),(0,t.kt)("h4",{id:"manually-add-the-zabbix-plugin"},"Manually Add the Zabbix Plugin"),(0,t.kt)("p",null,"Now we can add the volume mounts and see if the container runs without issues:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'docker run \\\n--name grafana \\\n-p 3000:3000 \\\n--rm \\\n--user 472 \\\n--volume "/opt/grafana-compose/grafana/lib:/var/lib/grafana" \\\n--volume "/opt/grafana-compose/grafana/log:/var/log/grafana" \\\ngrafana/grafana-oss:latest\n')),(0,t.kt)("p",null,"I can now manually add the ",(0,t.kt)("a",{parentName:"p",href:"https://grafana.com/grafana/plugins/alexanderzobnin-zabbix-app/"},"Zabbix plugin")," using the Grafana CLI:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"docker exec -ti grafana sh -c 'grafana-cli plugins install alexanderzobnin-zabbix-app'\n\u2714 Downloaded alexanderzobnin-zabbix-app v4.2.4 zip successfully\n\ndocker exec -ti grafana sh -c 'grafana-cli plugins ls'\ninstalled plugins:\nalexanderzobnin-zabbix-app @ 4.2.4\n")),(0,t.kt)("p",null,"Ok - this worked. Now stop the container and restart it using the backend and ingress network:"),(0,t.kt)("h4",{id:"test-networking"},"Test Networking"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"docker network ls                                                                                                     \nNETWORK ID     NAME                                     DRIVER    SCOPE\na77ffbc59dd5   bridge                                   bridge    local\nffa0e09265d3   host                                     host      local\n23e217540a23   ingress_gateway                          bridge    local\n019b12ab4063   none                                     null      local\ncb89d1ef4ff9   zabbix-server-compose_zbx_net_backend    bridge    local\nf0affabc4e0a   zabbix-server-compose_zbx_net_frontend   bridge    local\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'docker run \\\n--name grafana \\\n-p 3000:3000 \\\n--user 472 \\\n--volume "/opt/grafana-compose/grafana/lib:/var/lib/grafana" \\\n--volume "/opt/grafana-compose/grafana/log:/var/log/grafana" \\\n--network "zabbix-server-compose_zbx_net_backend" \\\ngrafana/grafana-oss:latest\n')),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"docker network connect ingress_gateway grafana\n")),(0,t.kt)("p",null,"Check if all containers are connected:"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"ingress","_","gateway")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'docker network inspect ingress_gateway                                                                                \n[\n    {\n        ...\n        "Containers": {\n            "361cb37eb411420638b57495a839339c2b27aa0be341363135e7a29fcce95ee0": {\n                "Name": "grafana",\n                "EndpointID": "a6e13ee59ade2a7df0dc22e1738aab89a91ae767dba7dc5c42a36f8519e5c390",\n                "MacAddress": "02:42:ac:13:00:03",\n                "IPv4Address": "172.19.0.3/16",\n                "IPv6Address": ""\n            },\n            "7e117e131aa0563eb58b3bbaa0b2efab89c8238b5b3e2fbb40b8b241ccd2000f": {\n                "Name": "zabbix-web",\n                "EndpointID": "de6bf76a17ce27db6d6ed6cb84ddf242f011629a1325b88b309e3f1e0be7b3d5",\n                "MacAddress": "02:42:ac:13:00:02",\n                "IPv4Address": "172.19.0.2/16",\n                "IPv6Address": ""\n            }\n        },\n        ...\n    }\n]\n')),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"zbx","_","net","_","backend")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-json"},'docker network inspect zabbix-server-compose_zbx_net_backend                                                          \n[\n    {\n        ...\n        "ConfigOnly": false,\n        "Containers": {\n            "361cb37eb411420638b57495a839339c2b27aa0be341363135e7a29fcce95ee0": {\n                "Name": "grafana",\n                "EndpointID": "82bacee2889fcfa663c710a33e1889a4a5b583c8bf048a3b8a5e0a8c2b50902d",\n                "MacAddress": "02:42:ac:10:ef:02",\n                "IPv4Address": "172.16.239.2/24",\n                "IPv6Address": ""\n            },\n            "7e117e131aa0563eb58b3bbaa0b2efab89c8238b5b3e2fbb40b8b241ccd2000f": {\n                "Name": "zabbix-web",\n                "EndpointID": "30611f24b5aafba9ea4f0133015387d70fcfe4f0dc7fe287aafe15e2c6d5214c",\n                "MacAddress": "02:42:ac:10:ef:66",\n                "IPv4Address": "172.16.239.102/24",\n                "IPv6Address": ""\n            },\n            "879fbf896901367fe0d6e6fa8d7788b991c035427904ac396ee6fbaf03590e2d": {\n                "Name": "zabbix-agent",\n                "EndpointID": "4ae3d85c3a3e5525c46dbb6d51b9c6a52b64a466af2be4dc94d139b551212468",\n                "MacAddress": "02:42:ac:10:ef:67",\n                "IPv4Address": "172.16.239.103/24",\n                "IPv6Address": ""\n            },\n            "96fddea6d6a140b49caf6d01ff973d42194ad0f07568a065d3bdc1cf2b2b960c": {\n                "Name": "zabbix-db",\n                "EndpointID": "c4563664729387fbfedf01ae6481c08501d6ab355bac66fb277377ba090dab27",\n                "MacAddress": "02:42:ac:10:ef:68",\n                "IPv4Address": "172.16.239.104/24",\n                "IPv6Address": ""\n            },\n            "cfd6c7326a0ce5fb882a41c7838a501e27d8a201b6cdc01dccfa1449941c85f4": {\n                "Name": "zabbix-server",\n                "EndpointID": "e276e172f44fd8aa3549e68f99f9d4fb480bd6748c3831115622cda296ab63c2",\n                "MacAddress": "02:42:ac:10:ef:65",\n                "IPv4Address": "172.16.239.101/24",\n                "IPv6Address": ""\n            }\n        },\n        ...\n    }\n]\n')),(0,t.kt)("h3",{id:"back-on-track-with-docker-compose"},"Back on track with Docker-Compose"),(0,t.kt)("p",null,"Delete the installed content in ",(0,t.kt)("inlineCode",{parentName:"p"},"/opt/grafana-compose/grafana/lib"),", wrap everything into a single neat compose file and re-run it in ",(0,t.kt)("strong",{parentName:"p"},"docker-compose"),":"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yml"},"services:\n  grafana-server:\n    container_name: grafana-server\n    image: grafana/grafana-oss:latest\n    networks:\n      zbx_net_backend:\n        ipv4_address: 172.16.239.105\n        aliases:\n          - grafana-server\n      zbx_net_frontend:\n        ipv4_address: 172.16.238.105\n      ingress_gateway:\n        aliases:\n          - grafana-server\n    restart: always\n    ports:\n      - '3000:3000'\n    user: '472'\n    volumes:\n      - './grafana/lib:/var/lib/grafana'\n      - './grafana/log:/var/log/grafana'\n    environment:\n      GF_INSTALL_PLUGINS: alexanderzobnin-zabbix-app\n\nnetworks:\n  zbx_net_frontend:\n    external: true\n    name: zabbix-server-compose_zbx_net_frontend\n  zbx_net_backend:\n    external: true\n    name: zabbix-server-compose_zbx_net_backend\n  ingress_gateway:\n    external: true\n    name: ingress_gateway\n")),(0,t.kt)("h2",{id:"configure-grafana"},"Configure Grafana"),(0,t.kt)("p",null,"Now visit your server IP on Port 3000 and change the default ",(0,t.kt)("inlineCode",{parentName:"p"},"admin"),"/",(0,t.kt)("inlineCode",{parentName:"p"},"admin")," login:"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(48642).Z,width:"997",height:"578"})),(0,t.kt)("p",null,"Check out the ",(0,t.kt)("a",{parentName:"p",href:"https://alexanderzobnin.github.io/grafana-zabbix/guides/gettingstarted/"},"plugin page")," and you should be able to find and ",(0,t.kt)("a",{parentName:"p",href:"https://alexanderzobnin.github.io/grafana-zabbix/configuration/"},"enable the Zabbix plugin"),":"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(16345).Z,width:"970",height:"418"})),(0,t.kt)("p",null,"With the result that you now have the option to use Zabbix as a Data Source:"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(82580).Z,width:"926",height:"400"})),(0,t.kt)("p",null,"Continue by adding a user to Zabbix that can be used by Grafana:"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(86850).Z,width:"928",height:"613"})),(0,t.kt)("p",null,"When you add the Zabbix Data Source you will be asked to add the server address ",(0,t.kt)("inlineCode",{parentName:"p"},"https://my.domain.com/zabbix/api_jsonrpc.php")," as well as the login you just created - leave everything else default! For my test server I simply use the docker domain name of my ",(0,t.kt)("inlineCode",{parentName:"p"},"zabbix-web")," container + port ",(0,t.kt)("inlineCode",{parentName:"p"},"8080")," - ",(0,t.kt)("inlineCode",{parentName:"p"},"http://zabbix-web:8080/api_jsonrpc.php"),":"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(45025).Z,width:"1201",height:"368"})),(0,t.kt)("p",null,"Scroll down and add the ",(0,t.kt)("strong",{parentName:"p"},"Grafana")," user you added to ",(0,t.kt)("strong",{parentName:"p"},"Zabbix")," and click ",(0,t.kt)("strong",{parentName:"p"},"Save & Test")," to verify that everything worked - Grafana should show your server API version once successfully connected:"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(81659).Z,width:"1151",height:"808"})),(0,t.kt)("p",null,"Switch from the ",(0,t.kt)("strong",{parentName:"p"},"Settings")," tab to ",(0,t.kt)("strong",{parentName:"p"},"Dashboards")," and import the dashboards templates that are included in the Zabbix plugin:"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(36029).Z,width:"1306",height:"353"})),(0,t.kt)("h3",{id:"problem---no-data"},"Problem - No Data"),(0,t.kt)("p",null,"When I access the template dashboards I am greeted with ",(0,t.kt)("inlineCode",{parentName:"p"},"No data")," ..."),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(82484).Z,width:"1408",height:"413"})),(0,t.kt)("p",null,"Checking in Zabbix I can see that the Grafana user (used by the Zabbix Plugin to connect to the Zabbix frontend) is online. So the configuration should be OK:"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(91888).Z,width:"1244",height:"287"})),(0,t.kt)("p",null,"Trying to connect to the Zabbix API from a machine outside of the virtual docker network using the LAN IP of my server - ",(0,t.kt)("inlineCode",{parentName:"p"},"http://192.168.2.111:8080/api_jsonrpc.php"),":"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "jsonrpc": "2.0",\n    "method": "apiinfo.version",\n    "params": [],\n    "id": 1\n}\n')),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(54587).Z,width:"1077",height:"594"})),(0,t.kt)("p",null,"I get the same response that - presumably - the Zabbix Plugin also got when I added the data source:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "jsonrpc": "2.0",\n    "result": "6.0.0",\n    "id": 1\n}\n')),(0,t.kt)("p",null,"So the API can be accessed - I also ",(0,t.kt)("a",{parentName:"p",href:"/docs/DevOps/Zabbix/2022-01-13--zabbix-api-testing/2022-01-13"},"tested the user authentication"),". Of course here I am using my servers LAN IP instead of the Docker internal container IP... "),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(19432).Z,width:"1169",height:"436"})),(0,t.kt)("p",null,"And lo and behold... now it is working!"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Zabbix Grafana Dashoard",src:n(64027).Z,width:"1436",height:"721"})))}c.isMDXComponent=!0},48642:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_01-d9e481331e6978594ffa68b5c380a55b.png"},16345:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_02-317fc4a6fa32432bf4107573ac25d7d2.png"},82580:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_03-0223ecb8f4b5e366ed7a70aafab9043a.png"},86850:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_04a-81180916793bd6e30128c9bb8db04512.png"},45025:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_04b-65691c0965a0bdd1eddd95e82fd8a139.png"},81659:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_05-7123e436fcc0568ff25c24e9616b7c2e.png"},36029:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_06-2e489eb8ff0738bb3b89d0980e6e99f9.png"},64027:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_07-2f247dd2039662f9a6d8034a797b5494.png"},82484:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_08-862199d483323bcdb773dc0d25885354.png"},91888:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_09-0bc32f2f7f1c611c6dc7201d5280bc51.png"},54587:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_10-bc98fb01ce3a09da7bb0ea5c025407ee.png"},19432:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/Zabbix_Grafana_Dashoard_11-e5151965c50425de55805d5d7718789c.png"},1677:(a,e,n)=>{n.d(e,{Z:()=>r});const r=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-539dc0d90c8fd4caf3d5cd5162b8ded5.jpg"}}]);