"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[78899],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(67294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var c=n.createContext({}),s=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=s(e.components);return n.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=s(a),h=o,m=d["".concat(c,".").concat(h)]||d[h]||u[h]||r;return a?n.createElement(m,l(l({ref:t},p),{},{components:a})):n.createElement(m,l({ref:t},p))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,l=new Array(r);l[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var s=2;s<r;s++)l[s]=a[s];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},60634:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>s});var n=a(87462),o=(a(67294),a(3905));const r={sidebar_position:9e3,slug:"2021-11-08",title:"Tensorflow Crash Course - Part I",authors:"mpolinowski",tags:["Machine Learning","Python","Tensorflow"]},l=void 0,i={unversionedId:"IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/index",id:"IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/index",title:"Tensorflow Crash Course - Part I",description:"Mong Kok, Hongkong",source:"@site/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/index.md",sourceDirName:"IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i",slug:"/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/2021-11-08",permalink:"/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/2021-11-08",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/index.md",tags:[{label:"Machine Learning",permalink:"/docs/tags/machine-learning"},{label:"Python",permalink:"/docs/tags/python"},{label:"Tensorflow",permalink:"/docs/tags/tensorflow"}],version:"current",sidebarPosition:9e3,frontMatter:{sidebar_position:9e3,slug:"2021-11-08",title:"Tensorflow Crash Course - Part I",authors:"mpolinowski",tags:["Machine Learning","Python","Tensorflow"]},sidebar:"tutorialSidebar",previous:{title:"Tensorflow2 Crash Course - Part II",permalink:"/docs/IoT-and-Machine-Learning/ML/2021-11-09--tensorflow-crash-course-part-ii/2021-11-09"},next:{title:"activate_webcam",permalink:"/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/activate_webcam"}},c={},s=[{value:"Setting up Tensorflow",id:"setting-up-tensorflow",level:2},{value:"Arch Linux",id:"arch-linux",level:3},{value:"Installing Bazel",id:"installing-bazel",level:2},{value:"Arch Linux",id:"arch-linux-1",level:3},{value:"Project Setup",id:"project-setup",level:2},{value:"Data Collection",id:"data-collection",level:2},{value:"Training Preparation",id:"training-preparation",level:2}],p={toc:s};function u(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Mong Kok, Hongkong",src:a(88472).Z,width:"1500",height:"544"})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#setting-up-tensorflow"},"Setting up Tensorflow"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#arch-linux"},"Arch Linux")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#installing-bazel"},"Installing Bazel"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#arch-linux-1"},"Arch Linux")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#project-setup"},"Project Setup")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#data-collection"},"Data Collection")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#training-preparation"},"Training Preparation"))),(0,o.kt)("p",null,"This set of Notebooks provides a complete set of code to be able to train and leverage your own custom object detection model using the Tensorflow Object Detection API."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"This article is based on a ",(0,o.kt)("a",{parentName:"p",href:"https://www.youtube.com/channel/UCHXa4OpASJEwrHrLeIzw7Yg"},"Tutorial")," by ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nicknochnack"},"@nicknochnack"),".")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Tensorflow Object Detection Walkthrough",src:a(80150).Z,width:"1453",height:"613"})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/2021-11-08"},"Tensorflow2 Crash Course Part I")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/IoT-and-Machine-Learning/ML/2021-11-09--tensorflow-crash-course-part-ii/2021-11-09"},"Tensorflow2 Crash Course Part II")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/IoT-and-Machine-Learning/ML/2021-11-10--tensorflow-crash-course-part-iii/2021-11-10"},"Tensorflow2 Crash Course Part III")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/IoT-and-Machine-Learning/ML/2021-11-11--tensorflow-crash-course-part-iv/2021-11-11"},"Tensorflow2 Crash Course Part IV")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/IoT-and-Machine-Learning/ML/2021-11-12--tensorflow-crash-course-part-v/2021-11-12"},"Tensorflow2 Crash Course Part V"))),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/mpolinowski/tensorflow2-starter"},"Github Repository")),(0,o.kt)("h2",{id:"setting-up-tensorflow"},"Setting up Tensorflow"),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"https://www.tensorflow.org/install/source"},"Installation Guide")),(0,o.kt)("h3",{id:"arch-linux"},"Arch Linux"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"0 python-tensorflow\n")),(0,o.kt)("p",null,"If you want to have ",(0,o.kt)("strong",{parentName:"p"},"CUDA")," acceleration with ",(0,o.kt)("strong",{parentName:"p"},"nVidia "),"GPUs__:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo pacman -Syu tensorflow-cuda python-tensorflow-cuda cuda cudnn\n\nPackages (51) abseil-cpp-20211102.0-1  absl-py-0.14.1-1  cblas-3.10.0-1  hdf5-1.12.1-1  intel-mkl-2020.4.304-1  libaec-1.0.6-1  liblzf-3.6-3 nccl-2.11.4-2  onednn-2.4.4-1  pybind11-2.8.1-1  python-astor-0.8.1-3  python-astunparse-1.6.3-3  python-bleach-4.1.0-1 python-cachetools-4.2.4-1  python-dateutil-2.8.2-2  python-decorator-5.1.0-1  python-flatbuffers-2.0.5-1  python-gast03-0.3.3-1 python-google-auth-1.34.0-1  python-google-auth-oauthlib-0.4.4-1  python-grpcio-1.42.0-1  python-h5py-3.6.0-1 python-keras-2.7.0-1  python-keras-applications-1.0.8-6  python-keras-preprocessing-1.1.2-4  python-numpy-1.21.3-1 python-oauthlib-3.1.1-1  python-opt_einsum-3.3.0-3  python-pandas-1.3.4-1  python-pasta-0.2.0-4  python-protobuf-3.17.3-1 python-pyasn1-0.4.8-5  python-pyasn1-modules-0.2.8-4  python-pycuda-2021.1-5  python-pydot-1.4.2-1  python-pytools-2021.2.9-1 python-pytz-2021.3-2  python-requests-oauthlib-1.3.0-4  python-rsa-4.8-1  python-scipy-1.7.3-1 python-tensorboard_plugin_wit-1.8.1-1 python-tensorflow-estimator-2.6.0-1  python-termcolor-1.1.0-10  python-werkzeug-2.0.2-1 python-wheel-0.37.0-2  python-wrapt-1.12.1-4  tensorboard-2.7.0-1  cuda-11.5.1-1  cudnn-8.3.0.98-1 python-tensorflow-cuda-2.7.0-3  tensorflow-cuda-2.7.0-3\n\nTotal Download Size:    3137.74 MiB\nTotal Installed Size:  10745.45 MiB\n")),(0,o.kt)("h2",{id:"installing-bazel"},"Installing Bazel"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://bazel.build"},"Bazel")," is a tool that builds and tests Java, C++, Android, iOS, Go and a wide variety of other language platforms. Bazel runs on ",(0,o.kt)("a",{parentName:"p",href:"https://docs.bazel.build/versions/main/install.html"},"Windows, macOS, and Linux"),"."),(0,o.kt)("h3",{id:"arch-linux-1"},"Arch Linux"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo pacman -Syu bazel\n\nPackages (7) java-environment-common-3-3  java-runtime-common-3-3  jdk11-openjdk-11.0.13.u8-1  jre11-openjdk-11.0.13.u8-1 jre11-openjdk-headless-11.0.13.u8-1  libnet-1:1.1.6-1  bazel-4.2.2-1\n\nTotal Download Size:   193.97 MiB\nTotal Installed Size:  362.47 MiB\n\n")),(0,o.kt)("h2",{id:"project-setup"},"Project Setup"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Step 1"),": Clone this repository: ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/mpolinowski/TFODCourse"},"https://github.com/mpolinowski/TFODCourse"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Step 2"),": Create a new virtual environment ")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd workdir\nmkdir -p tf-course/Tensorflow/workspace/images/{train,test,collection}\ncd tf-course\npython -m venv tfod\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Step 3"),": Activate your virtual environment")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"source tfod/bin/activate # Linux\n.\\tfod\\Scripts\\activate # Windows \n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Step 4"),": Install dependencies and add virtual environment to the Python Kernel")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"pip install -r dependencies.txt\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"python -m pip install --upgrade pip\npip install ipykernel\npython -m ipykernel install --user --name=tfodj\n")),(0,o.kt)("p",null,"Verify that Jupyter Notebooks was installed:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"jupyter notebook\n")),(0,o.kt)("p",null,"Make sure that you have the option to choose your virtual environment as interpreter:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Tensorflow Object Detection Walkthrough",src:a(9877).Z,width:"1171",height:"372"})),(0,o.kt)("h2",{id:"data-collection"},"Data Collection"),(0,o.kt)("p",null,"Collect images using the Notebook ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/mpolinowski/TFODCourse/blob/main/collecting_training_data.ipynb"},"collecting_training_data.ipynb"),":"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Tensorflow Object Detection Walkthrough",src:a(90117).Z,width:"1187",height:"927"})),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},'For the image capturing I noticed that the timing seemed to be off. It got better by deactivating the preview. I am not sure what is going wrong there for now. Might be an issue with the RTSP stream - using a webcam instead seemed fine. Just run the capture step a couple of times and hold on to the "best" ',(0,o.kt)("strong",{parentName:"p"},"5")," images for all labels.")),(0,o.kt)("p",null,"To lable the images we are going to use ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tzutalin/labelImg"},"labelImg"),", which is a graphical image annotation tool."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"pip3 install labelImg\n\nSuccessfully installed PyQt5-Qt5-5.15.2 PyQt5-sip-12.9.0 labelImg-1.8.3 pyqt5-5.15.6\n")),(0,o.kt)("p",null,"Start the Software from your console with ",(0,o.kt)("inlineCode",{parentName:"p"},"labelImg"),":"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Tensorflow Object Detection Walkthrough",src:a(44043).Z,width:"800",height:"514"})),(0,o.kt)("p",null,"Open the directory where your captures were stored and press ",(0,o.kt)("inlineCode",{parentName:"p"},"W")," and draw a box around your hand and label it according to the gesture."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+s")," to save the annotation XML file for your image and repeat for all images."),(0,o.kt)("h2",{id:"training-preparation"},"Training Preparation"),(0,o.kt)("p",null,"Manually divide collected images into two folders train and test. Copy 4 images (+ annotation file) of each label into the ",(0,o.kt)("inlineCode",{parentName:"p"},"train")," folder and the remaining one into the ",(0,o.kt)("inlineCode",{parentName:"p"},"test")," folder:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ls Tensorflow/workspace/images/test\n\nmetal.d31b4e19-6952-11ec-8d31-1c1b0dc5817f.jpg  thumbsdown.b74e6640-6953-11ec-b6d3-1c1b0dc5817f.jpg\nmetal.d31b4e19-6952-11ec-8d31-1c1b0dc5817f.xml  thumbsdown.b74e6640-6953-11ec-b6d3-1c1b0dc5817f.xml\nok.b9d7d438-6954-11ec-ae56-1c1b0dc5817f.jpg     thumbsup.f1535776-6951-11ec-856e-1c1b0dc5817f.jpg\nok.b9d7d438-6954-11ec-ae56-1c1b0dc5817f.xml     thumbsup.f1535776-6951-11ec-856e-1c1b0dc5817f.xml\n\nls Tensorflow/workspace/images/train\n\nmetal.25a3fdb5-6952-11ec-be18-1c1b0dc5817f.jpg  thumbsdown.939cd20d-6954-11ec-b0ac-1c1b0dc5817f.jpg\nmetal.25a3fdb5-6952-11ec-be18-1c1b0dc5817f.xml  thumbsdown.939cd20d-6954-11ec-b0ac-1c1b0dc5817f.xml\nmetal.c6fd71c4-6952-11ec-af7f-1c1b0dc5817f.jpg  thumbsdown.9a973d84-6954-11ec-89bf-1c1b0dc5817f.jpg\nmetal.c6fd71c4-6952-11ec-af7f-1c1b0dc5817f.xml  thumbsdown.9a973d84-6954-11ec-89bf-1c1b0dc5817f.xml\nmetal.cd667fbd-6953-11ec-a747-1c1b0dc5817f.jpg  thumbsdown.a3a55b8c-6954-11ec-baf0-1c1b0dc5817f.jpg\nmetal.cd667fbd-6953-11ec-a747-1c1b0dc5817f.xml  thumbsdown.a3a55b8c-6954-11ec-baf0-1c1b0dc5817f.xml\nmetal.d06a2256-6953-11ec-8d60-1c1b0dc5817f.jpg  thumbsdown.aa4aa114-6953-11ec-a97c-1c1b0dc5817f.jpg\nmetal.d06a2256-6953-11ec-8d60-1c1b0dc5817f.xml  thumbsdown.aa4aa114-6953-11ec-a97c-1c1b0dc5817f.xml\nok.adbee52a-6954-11ec-989c-1c1b0dc5817f.jpg     thumbsdown.b3df44fe-6952-11ec-bee8-1c1b0dc5817f.jpg\nok.adbee52a-6954-11ec-989c-1c1b0dc5817f.xml     thumbsdown.b3df44fe-6952-11ec-bee8-1c1b0dc5817f.xml\nok.b0c3a2e2-6954-11ec-8646-1c1b0dc5817f.jpg     thumbsup.8dc99774-6952-11ec-a0a3-1c1b0dc5817f.jpg\nok.b0c3a2e2-6954-11ec-8646-1c1b0dc5817f.xml     thumbsup.8dc99774-6952-11ec-a0a3-1c1b0dc5817f.xml\nok.b3c3f23a-6954-11ec-89b1-1c1b0dc5817f.jpg     thumbsup.90d4df65-6952-11ec-b7d0-1c1b0dc5817f.jpg\nok.b3c3f23a-6954-11ec-89b1-1c1b0dc5817f.xml     thumbsup.90d4df65-6952-11ec-b7d0-1c1b0dc5817f.xml\nok.b6ca07d3-6954-11ec-b156-1c1b0dc5817f.jpg     thumbsup.96d98a6b-6952-11ec-8039-1c1b0dc5817f.jpg\nok.b6ca07d3-6954-11ec-b156-1c1b0dc5817f.xml     thumbsup.96d98a6b-6952-11ec-8039-1c1b0dc5817f.xml\n")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Make sure you always have an even number of images in both folders")))}u.isMDXComponent=!0},88472:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-8629210580d5b66cf728356357923b9f.jpg"},80150:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/tensorflow-crash-course_00-3c45a7dda7c78e42a1266d64adc53e14.png"},9877:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/tensorflow-crash-course_01-b61e1ad20427a9679eba9ff1fe3049b3.png"},90117:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/tensorflow-crash-course_02-b02348de2fb25186a633ce75fd5fded0.png"},44043:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/tensorflow-crash-course_03-af6f93cdbfe477f7a40a1244573ea7dd.png"}}]);