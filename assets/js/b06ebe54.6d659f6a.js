"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[82945],{3905:(e,a,t)=>{t.d(a,{Zo:()=>m,kt:()=>k});var n=t(67294);function l(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){l(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function p(e,a){if(null==e)return{};var t,n,l=function(e,a){if(null==e)return{};var t,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(l[t]=e[t]);return l}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var o=n.createContext({}),s=function(e){var a=n.useContext(o),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},m=function(e){var a=s(e.components);return n.createElement(o.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},d=n.forwardRef((function(e,a){var t=e.components,l=e.mdxType,r=e.originalType,o=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),d=s(t),k=l,c=d["".concat(o,".").concat(k)]||d[k]||u[k]||r;return t?n.createElement(c,i(i({ref:a},m),{},{components:t})):n.createElement(c,i({ref:a},m))}));function k(e,a){var t=arguments,l=a&&a.mdxType;if("string"==typeof e||l){var r=t.length,i=new Array(r);i[0]=d;var p={};for(var o in a)hasOwnProperty.call(a,o)&&(p[o]=a[o]);p.originalType=e,p.mdxType="string"==typeof e?e:l,i[1]=p;for(var s=2;s<r;s++)i[s]=t[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}d.displayName="MDXCreateElement"},91484:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>p,toc:()=>s});var n=t(87462),l=(t(67294),t(3905));const r={sidebar_position:6050,slug:"2022-03-07",title:"FFMPEG Cheat Sheet",authors:"mpolinowski",tags:["LINUX"]},i=void 0,p={unversionedId:"DevOps/Linux/2022-03-07--ffmpeg-cheat-sheet/index",id:"DevOps/Linux/2022-03-07--ffmpeg-cheat-sheet/index",title:"FFMPEG Cheat Sheet",description:"Shenzhen, China",source:"@site/docs/DevOps/Linux/2022-03-07--ffmpeg-cheat-sheet/index.md",sourceDirName:"DevOps/Linux/2022-03-07--ffmpeg-cheat-sheet",slug:"/DevOps/Linux/2022-03-07--ffmpeg-cheat-sheet/2022-03-07",permalink:"/docs/DevOps/Linux/2022-03-07--ffmpeg-cheat-sheet/2022-03-07",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Linux/2022-03-07--ffmpeg-cheat-sheet/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"}],version:"current",sidebarPosition:6050,frontMatter:{sidebar_position:6050,slug:"2022-03-07",title:"FFMPEG Cheat Sheet",authors:"mpolinowski",tags:["LINUX"]},sidebar:"tutorialSidebar",previous:{title:"Using the AVM Fritzbox VPN on Manjaro (KDE)",permalink:"/docs/DevOps/Linux/2022-03-08--arch-kde-fritz-vpn/2022-03-08"},next:{title:"Install Davinci Resolve on Arch Linux",permalink:"/docs/DevOps/Linux/2021-10-26--install-davinci-resolve-on-arch/2021-10-26"}},o={},s=[{value:"Conversions",id:"conversions",level:2},{value:"h.264 (AVC)",id:"h264-avc",level:3},{value:"Encoding Presets",id:"encoding-presets",level:4},{value:"Tuning Presets",id:"tuning-presets",level:4},{value:"Costant Rate Factor",id:"costant-rate-factor",level:4},{value:"Profiles",id:"profiles",level:4},{value:"h.265 (HEVC)",id:"h265-hevc",level:3},{value:"Encoding Presets",id:"encoding-presets-1",level:4},{value:"Tuning Presets",id:"tuning-presets-1",level:4},{value:"Costant Rate Factor",id:"costant-rate-factor-1",level:4},{value:"Profiles",id:"profiles-1",level:4},{value:"h.266 (VVC)",id:"h266-vvc",level:3},{value:"VP8 &amp; webM",id:"vp8--webm",level:3},{value:"Costant Rate Factor",id:"costant-rate-factor-2",level:4},{value:"VP9 &amp; webM",id:"vp9--webm",level:3},{value:"Constant Rate Factor",id:"constant-rate-factor",level:4},{value:"Lossless Encoding",id:"lossless-encoding",level:4},{value:"Advanced Settings",id:"advanced-settings",level:4},{value:"Opus Audio",id:"opus-audio",level:3},{value:"AV1 &amp; webM",id:"av1--webm",level:3},{value:"AV1 SVT-AV1",id:"av1-svt-av1",level:3},{value:"Recordings",id:"recordings",level:2},{value:"RTSP Streams",id:"rtsp-streams",level:3},{value:"Timelapse from Images",id:"timelapse-from-images",level:3},{value:"Create Snapshots from Videos",id:"create-snapshots-from-videos",level:3},{value:"Generate GIF from Video",id:"generate-gif-from-video",level:3},{value:"Streaming",id:"streaming",level:2},{value:"Dynamic Adaptive Streaming over HTTP (DASH)",id:"dynamic-adaptive-streaming-over-http-dash",level:3},{value:"Adaptive WebM DASH Streaming",id:"adaptive-webm-dash-streaming",level:3},{value:"Playback",id:"playback",level:2},{value:"Probing &amp; Metadata",id:"probing--metadata",level:2},{value:"Video Editing",id:"video-editing",level:2},{value:"Cutting",id:"cutting",level:3},{value:"Resolution Scaling",id:"resolution-scaling",level:3},{value:"Video Overlays",id:"video-overlays",level:3},{value:"Add an Audio Track",id:"add-an-audio-track",level:3},{value:"Waveform",id:"waveform",level:3}],m={toc:s};function u(e){let{components:a,...r}=e;return(0,l.kt)("wrapper",(0,n.Z)({},m,r,{components:a,mdxType:"MDXLayout"}),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Shenzhen, China",src:t(54235).Z,width:"1500",height:"606"})),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#conversions"},"Conversions"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#h264-avc"},"h.264 (AVC)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#encoding-presets"},"Encoding Presets")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#tuning-presets"},"Tuning Presets")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#costant-rate-factor"},"Costant Rate Factor")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#profiles"},"Profiles")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#h265-hevc"},"h.265 (HEVC)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#encoding-presets-1"},"Encoding Presets")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#tuning-presets-1"},"Tuning Presets")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#costant-rate-factor-1"},"Costant Rate Factor")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#profiles-1"},"Profiles")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#h266-vvc"},"h.266 (VVC)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#vp8--webm"},"VP8 \\& webM"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#costant-rate-factor-2"},"Costant Rate Factor")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#vp9--webm"},"VP9 \\& webM"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#constant-rate-factor"},"Constant Rate Factor")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#lossless-encoding"},"Lossless Encoding")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#advanced-settings"},"Advanced Settings")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#opus-audio"},"Opus Audio")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#av1--webm"},"AV1 \\& webM")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#av1-svt-av1"},"AV1 SVT-AV1")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#recordings"},"Recordings"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#rtsp-streams"},"RTSP Streams")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#timelapse-from-images"},"Timelapse from Images")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#create-snapshots-from-videos"},"Create Snapshots from Videos")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#generate-gif-from-video"},"Generate GIF from Video")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#streaming"},"Streaming"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#dynamic-adaptive-streaming-over-http-dash"},"Dynamic Adaptive Streaming over HTTP (DASH)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#adaptive-webm-dash-streaming"},"Adaptive WebM DASH Streaming")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#playback"},"Playback")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#probing--metadata"},"Probing \\& Metadata")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#video-editing"},"Video Editing"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#cutting"},"Cutting")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#resolution-scaling"},"Resolution Scaling")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#video-overlays"},"Video Overlays")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#add-an-audio-track"},"Add an Audio Track")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#waveform"},"Waveform"))))),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("strong",{parentName:"p"},"ffmpeg -version"),(0,l.kt)("br",{parentName:"p"}),"\n",(0,l.kt)("em",{parentName:"p"},"ffmpeg version 5.0-full_build-",(0,l.kt)("a",{parentName:"em",href:"http://www.gyan.dev"},"www.gyan.dev")," Copyright (c) 2000-2022 the FFmpeg developers built with gcc 11.2.0 (Rev5, Built by MSYS2 project)"))),(0,l.kt)("h2",{id:"conversions"},"Conversions"),(0,l.kt)("p",null,"Get audio from a video file:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -vn -c:a copy song.mp3\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -vn -c:a mp3 -b:a 128k -ar 44100 -ac 2 song.mp3\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"size=2456kB time=00:02:37.12 bitrate=128.0kbits/s speed=59.6x video:0kB audio:2456kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.013761%")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i song.m4a -af loudnorm -c:a mp3 -b:a 320k -ar 48000 song.mp3\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"size=12213kB time=00:05:12.60 bitrate=320.1kbits/s speed=16.8x video:0kB audio:12212kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.008781%")),(0,l.kt)("p",null,"Strip audio from a video file:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -an -c:v copy video_only.mp4\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -an video_only.h265\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"frame= 4707 fps=466 q=35.8 Lsize=659kB time=00:02:36.99 bitrate=34.4kbits/s speed=15.6x",(0,l.kt)("br",{parentName:"p"}),"\n","video:659kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.000000%\nencoded 4707 frames in 10.08s (467.10 fps), 31.01 kb/s, Avg QP:34.70")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i https://my-domain.com/movie.mkv -t 00:02:30 -c:v h264 -b:v 2500k -c:a mp3 -b:a 128k -ar 44100 -ac 2 movie.mp4\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"video:398897kB audio:16473kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.321552%\n","[libx264 @ 0000028f21bb09c0]"," kb/s:2477.36")),(0,l.kt)("p",null,"Convert ALL streams included in your input file using the MAP flag:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -map 0 -c:a aac -c:v hevc output.mkv\n")),(0,l.kt)("h3",{id:"h264-avc"},"h.264 (AVC)"),(0,l.kt)("h4",{id:"encoding-presets"},"Encoding Presets"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"ultrafast"),(0,l.kt)("li",{parentName:"ul"},"superfast"),(0,l.kt)("li",{parentName:"ul"},"veryfast"),(0,l.kt)("li",{parentName:"ul"},"faster"),(0,l.kt)("li",{parentName:"ul"},"fast"),(0,l.kt)("li",{parentName:"ul"},"medium"),(0,l.kt)("li",{parentName:"ul"},"slow"),(0,l.kt)("li",{parentName:"ul"},"slower "),(0,l.kt)("li",{parentName:"ul"},"veryslow"),(0,l.kt)("li",{parentName:"ul"},"placebo")),(0,l.kt)("h4",{id:"tuning-presets"},"Tuning Presets"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"psnr"),(0,l.kt)("li",{parentName:"ul"},"ssim"),(0,l.kt)("li",{parentName:"ul"},"grain"),(0,l.kt)("li",{parentName:"ul"},"zerolatency"),(0,l.kt)("li",{parentName:"ul"},"fastdecode"),(0,l.kt)("li",{parentName:"ul"},"animation")),(0,l.kt)("h4",{id:"costant-rate-factor"},"Costant Rate Factor"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"0")," \u2013 ",(0,l.kt)("inlineCode",{parentName:"li"},"51")," (",(0,l.kt)("em",{parentName:"li"},"lossless - low quality"),"), default ",(0,l.kt)("inlineCode",{parentName:"li"},"23"),",  ",(0,l.kt)("em",{parentName:"li"},"usable")," range ",(0,l.kt)("inlineCode",{parentName:"li"},"17")," \u2013 ",(0,l.kt)("inlineCode",{parentName:"li"},"28"))),(0,l.kt)("h4",{id:"profiles"},"Profiles"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"-profile:v baseline"),(0,l.kt)("li",{parentName:"ul"},"-profile:v high"),(0,l.kt)("li",{parentName:"ul"},"-profile:v high")),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"leave out to let FFMPEG decide based on input (recommended)")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mkv -c:v hevc -crf 23 -preset slower -tune zerolatency output.mp4\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"video:1422kB audio:2350kB subtitle:0kB other streams:0kB global headers:2kB muxing overhead: 4.637553%\nx265 ","[info]",": frame I:     19, Avg QP:10.82  kb/s: 5285.69\nx265 ","[info]",": frame P:   4689, Avg QP:15.41  kb/s: 52.07\nx265 ","[info]",": Weighted P-Frames: Y:1.9% UV:1.8%\nx265 ","[info]",": consecutive B-frames: 100.0%\nencoded 4708 frames in 307.38s (15.32 fps), 73.19 kb/s, Avg QP:15.39\n","[aac @ 0000021ab0643d00]"," Qavg: 4054.659")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.adobe.com/devnet/video/articles/mp4_movie_atom.html"},"The Movie Atom"))),(0,l.kt)("p",null,"Move flags to start (",(0,l.kt)("a",{parentName:"p",href:"https://support.google.com/youtube/answer/1722171"},"make file playable before fully downloaded"),"):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mkv -c:v h264 -crf 23 -maxrate 1M -bufsize 2M -movflags +faststart output.mp4\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"[mp4 @ 000001f50ef56140]"," Starting second pass: moving the moov atom to the beginning of the file\nframe= 4708 fps=716 q=-1.0 Lsize=    3418kB time=00:02:37.12 bitrate= 178.2kbits/s dup=1 drop=0 speed=23.9x")),(0,l.kt)("h3",{id:"h265-hevc"},"h.265 (HEVC)"),(0,l.kt)("h4",{id:"encoding-presets-1"},"Encoding Presets"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"ultrafast"),(0,l.kt)("li",{parentName:"ul"},"superfast"),(0,l.kt)("li",{parentName:"ul"},"veryfast"),(0,l.kt)("li",{parentName:"ul"},"faster"),(0,l.kt)("li",{parentName:"ul"},"fast"),(0,l.kt)("li",{parentName:"ul"},"medium"),(0,l.kt)("li",{parentName:"ul"},"slow"),(0,l.kt)("li",{parentName:"ul"},"slower "),(0,l.kt)("li",{parentName:"ul"},"veryslow"),(0,l.kt)("li",{parentName:"ul"},"placebo")),(0,l.kt)("h4",{id:"tuning-presets-1"},"Tuning Presets"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"psnr"),(0,l.kt)("li",{parentName:"ul"},"ssim"),(0,l.kt)("li",{parentName:"ul"},"grain"),(0,l.kt)("li",{parentName:"ul"},"zerolatency"),(0,l.kt)("li",{parentName:"ul"},"fastdecode")),(0,l.kt)("h4",{id:"costant-rate-factor-1"},"Costant Rate Factor"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"0")," \u2013 ",(0,l.kt)("inlineCode",{parentName:"li"},"51")," (",(0,l.kt)("em",{parentName:"li"},"lossless - low quality"),"), default ",(0,l.kt)("inlineCode",{parentName:"li"},"28"),",  ",(0,l.kt)("em",{parentName:"li"},"usable")," range ",(0,l.kt)("inlineCode",{parentName:"li"},"17")," \u2013 ",(0,l.kt)("inlineCode",{parentName:"li"},"28"))),(0,l.kt)("h4",{id:"profiles-1"},"Profiles"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"-profile:v baseline"),(0,l.kt)("li",{parentName:"ul"},"-profile:v high"),(0,l.kt)("li",{parentName:"ul"},"-profile:v high")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -c:v libx265 -crf 28 -c:a aac -b:a 128k output.mp4\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Stream #0:0(und): Video: hevc (hev1 / 0x31766568), yuv420p(progressive), 480x360 ","[SAR 1:1 DAR 4:3]",", q=2-31, 29.97 fps, 30k tbn (default)\nStream #0:1(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 128 kb/s (default)")),(0,l.kt)("h3",{id:"h266-vvc"},"h.266 (VVC)"),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"not available yet")),(0,l.kt)("h3",{id:"vp8--webm"},"VP8 & webM"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -c:v libvpx -b:v 1M -c:a libvorbis output.webm\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Stream #0:0(und): Video: vp8, yuv420p(progressive), 480x360 ","[SAR 1:1 DAR 4:3]",", q=2-31, 1000 kb/s, 29.97 fps, 1k tbn (default)\nStream #0:1(und): Audio: vorbis, 44100 Hz, stereo, fltp (default)")),(0,l.kt)("h4",{id:"costant-rate-factor-2"},"Costant Rate Factor"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"4")," \u2013 ",(0,l.kt)("inlineCode",{parentName:"li"},"63")," (",(0,l.kt)("em",{parentName:"li"},"high - low quality"),"), ",(0,l.kt)("a",{parentName:"li",href:"https://trac.ffmpeg.org/wiki/Encode/VP8"},"default 10"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -c:v libvpx -crf 10 -b:v 1M -c:a libvorbis output.webm\n")),(0,l.kt)("h3",{id:"vp9--webm"},"VP9 & webM"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("a",{parentName:"p",href:"https://developers.google.com/media/vp9"},"Google VP9 Developer Docs"))),(0,l.kt)("p",null,"1-pass encoding with an average video bitrate of 1M:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -c:v libvpx-vp9 -b:v 1M -c:a libvorbis output.webm\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Stream #0:0(und): Video: vp9, yuv420p(progressive), 480x360 ","[SAR 1:1 DAR 4:3]",", q=2-31, 1000 kb/s, 29.97 fps, 1k tbn (default)\nStream #0:1(und): Audio: vorbis, 44100 Hz, stereo, fltp (default)")),(0,l.kt)("p",null,"2-pass encoding:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -c:v libvpx-vp9 -b:v 0 -crf 30 -pass 1 -an -f webm /dev/null&&ffmpeg -i video.mp4 -c:v libvpx-vp9 -b:v 0 -crf 30 -pass 2 -c:a libopus output.webm\n")),(0,l.kt)("h4",{id:"constant-rate-factor"},"Constant Rate Factor"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"0")," \u2013 ",(0,l.kt)("inlineCode",{parentName:"li"},"63")," (",(0,l.kt)("em",{parentName:"li"},"high - low quality"),"), default ",(0,l.kt)("inlineCode",{parentName:"li"},"31"),",  ",(0,l.kt)("em",{parentName:"li"},"usable")," range ",(0,l.kt)("inlineCode",{parentName:"li"},"15")," \u2013 ",(0,l.kt)("inlineCode",{parentName:"li"},"35"))),(0,l.kt)("p",null,"Constant Quality 1-pass encoding:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -c:v libvpx-vp9 -crf 31 -b:v 0 output.webm\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Stream #0:0(und): Video: vp9, yuv420p(progressive), 480x360 ","[SAR 1:1 DAR 4:3]",", q=2-31, 29.97 fps, 1k tbn (default)\nStream #0:1(und): Audio: opus, 48000 Hz, stereo, flt, 96 kb/s (default)")),(0,l.kt)("p",null,"Constrained Quality 1-pass encoding when ",(0,l.kt)("inlineCode",{parentName:"p"},"b:v")," > ",(0,l.kt)("inlineCode",{parentName:"p"},"0"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -c:v libvpx-vp9 -crf 31 -b:v 2500k output.webm\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Stream #0:0(und): Video: vp9, yuv420p(progressive), 480x360 ","[SAR 1:1 DAR 4:3]",", q=2-31, 2500 kb/s, 29.97 fps, 1k tbn (default)\nStream #0:1(und): Audio: opus, 48000 Hz, stereo, flt, 96 kb/s (default)")),(0,l.kt)("h4",{id:"lossless-encoding"},"Lossless Encoding"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"fmpeg -i video.mp4 -c:v libvpx-vp9 -lossless 1 output.webm\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Stream #0:0(und): Video: vp9, yuv420p(progressive), 480x360 ","[SAR 1:1 DAR 4:3]",", q=2-31, 29.97 fps, 1k tbn (default)\nStream #0:1(und): Audio: opus, 48000 Hz, stereo, flt, 96 kb/s (default)")),(0,l.kt)("h4",{id:"advanced-settings"},"Advanced Settings"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://wiki.webmproject.org/ffmpeg/vp9-encoding-guide"},"wiki.webmproject.com")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://developers.google.com/media/vp9/settings/vod/"},"Google VP9 Docs"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -b:v 3600k -minrate 1800k -maxrate 5220k -tile-columns 2 -g 240 -threads 8 -quality good -crf 27 -c:v libvpx-vp9 -map 0 -sn -c:a libopus -ac 2 -b:a 128k -pass 1 -speed 4 output.webm&&ffmpeg -i video.mp4 -b:v 3600k -minrate 1800k -maxrate 5220k -tile-columns 3 -g 240 -threads 8 -quality good -crf 27 -c:v libvpx-vp9 -map 0 -sn -c:a libopus -ac 2 -b:a 128k -pass 2 -speed 4 -y output.webm\n")),(0,l.kt)("h3",{id:"opus-audio"},"Opus Audio"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://opus-codec.org/"},"opus-codec.org"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -c:a libopus -b:a 128k -ar 48000 -ac 2 output.opus\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Stream #0:1","[0x2]"," (und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 122 kb/s (default)\nStream #0:1 -> #0:0 (aac (native) -> opus (libopus))")),(0,l.kt)("h3",{id:"av1--webm"},"AV1 & webM"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://trac.ffmpeg.org/wiki/Encode/AV1"},"AV1 FFMPEG Docs"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -c:v libaom-av1 -crf 27 -b:v 0 -strict experimental -c:a libopus -b:a 128k -movflags +faststart output.webm\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Stream #0:0(und): Video: av1, yuv420p(progressive), 480x360 ","[SAR 1:1 DAR 4:3]",", q=2-31, 29.97 fps, 1k tbn (default)\nStream #0:1(und): Audio: opus, 48000 Hz, stereo, flt, 128 kb/s (default)")),(0,l.kt)("h3",{id:"av1-svt-av1"},"AV1 SVT-AV1"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"https://github.com/OpenVisualCloud/SVT-AV1/"},"Github"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"https://pypi.org/project/Av1an"},"AV1an")))),(0,l.kt)("h2",{id:"recordings"},"Recordings"),(0,l.kt)("h3",{id:"rtsp-streams"},"RTSP Streams"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i rtsp://admin:instar@192.168.2.19:554/livestream/11 -c:v h264 -keyint_min 25 -g 50 -sc_threshold 0 recording.mp4\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"frame= 1017 fps= 30 q=-1.0 Lsize=   29399kB time=10:20:37.33 bitrate=   6.5kbits/s dup=341 drop=1 speed=1.09e+03x\nvideo:29098kB audio:279kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.074037% ")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"*"," Minimum keyframe interval 25 / maximum for a GoP is 50 = 2s @ 25fps.")),(0,l.kt)("h3",{id:"timelapse-from-images"},"Timelapse from Images"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'ls | cat -n | while read n f; do mv "$f" `printf "A_%03d.jpeg" $n`; done\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"-framerate 1"),": 1 fps"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"-framerate 1/2"),": 0.5 fps"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"-framerate 1/10"),": 0.1 fps")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -framerate 1 -i A_%03d.jpeg -r 25 -pix_fmt yuv420p timelapse.mp4\n")),(0,l.kt)("h3",{id:"create-snapshots-from-videos"},"Create Snapshots from Videos"),(0,l.kt)("p",null,"Create a snapshot every 45s starting with ",(0,l.kt)("inlineCode",{parentName:"p"},"P_001.png"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -f image2 -bt 20M -r 1/45 P_%03d.png\n")),(0,l.kt)("p",null,"Start at 30s and record 5 frames:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -ss 00:00:30.00 -i video.mp4 -frames:v 5 -f image2 -bt 10M 5frames_%03d.png\n")),(0,l.kt)("h3",{id:"generate-gif-from-video"},"Generate GIF from Video"),(0,l.kt)("p",null,"Cut 10 seconds of the video starting at the 2min 30s mark:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -ss 00:02:30 -i video.mkv -t 00:00:10 -avoid_negative_ts 1 cut.mp4\n")),(0,l.kt)("p",null,"Resize the cut video:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i cut.mp4 -vf scale=640x360 -c:v h264 -crf 18 -c:a aac scaled.mp4\n")),(0,l.kt)("p",null,"Create a subtitle file ",(0,l.kt)("inlineCode",{parentName:"p"},"captions.srt"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"1\n00:00:00,00 --\x3e 00:00:03,00\nThis is some text,\n\n2\n00:00:03,00 --\x3e 00:00:06,00\nand some more text,\n\n3\n00:00:06,00 --\x3e 00:00:09,00\nAnd now - The Punch Line!!\n")),(0,l.kt)("p",null,"Convert the SRT file to the ASS format:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i captions.srt captions.ass\n")),(0,l.kt)("p",null,"Hardcode the captions:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'ffmpeg -i scaled.mp4 -filter_complex "subtitles=captions.ass" subtitled.mp4\n')),(0,l.kt)("p",null,"Convert to GIF:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i subtitled.mp4 mygif.gif\n")),(0,l.kt)("p",null,"For better results - better resolution, much smaller filesize - use ",(0,l.kt)("a",{parentName:"p",href:"https://gif.ski/"},"Gifski"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i subtitled.mp4 subtitled_frame%04d.png\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"gifski -o mygif.gif subtitled_frame*.png\n")),(0,l.kt)("h2",{id:"streaming"},"Streaming"),(0,l.kt)("h3",{id:"dynamic-adaptive-streaming-over-http-dash"},"Dynamic Adaptive Streaming over HTTP (DASH)"),(0,l.kt)("p",null,"Start by creating input file versions with different resolutions:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -c:v h264 -crf 22 -tune zerolatency -profile:v high -level:v 4.0 -maxrate 5000k -bufsize 10000k -r 25 -keyint_min 25 -g 50 -sc_threshold 0 -c:a aac -ar 44100 -b:a 128k -ac 2 -pix_fmt yuv420p -movflags +faststart 1080.mp4 \\\n-s 1280x720 -c:v h264 -crf 24 -tune zerolatency -profile:v high -level:v 4.0 -maxrate 2500k -bufsize 5000k -r 25 -keyint_min 25 -g 50 -sc_threshold 0 -c:a aac -ar 44100 -b:a 128k -ac 2 -pix_fmt yuv420p -movflags +faststart 720.mp4 \\\n-s 854x480 -c:v h264 -crf 30 -tune zerolatency -profile:v high -level:v 4.0 -maxrate 1250k -bufsize 2500k -r 25 -keyint_min 25 -g 50 -sc_threshold 0 -c:a aac -ar 44100 -b:a 96k -ac 2 -pix_fmt yuv420p -movflags +faststart 480.mp4 \\\n-s 640x360 -c:v h264 -crf 33 -tune zerolatency -profile:v high -level:v 4.0 -maxrate 900k -bufsize 1800k -r 25 -keyint_min 25 -g 50 -sc_threshold 0 -c:a aac -ar 44100 -b:a 96k -ac 2 -pix_fmt yuv420p -movflags +faststart 360.mp4 \\\n-s 320x240 -c:v h264 -crf 36 -tune zerolatency -profile:v high -level:v 4.0 -maxrate 625k -bufsize 1250k -r 25 -keyint_min 25 -g 50 -sc_threshold 0 -c:a aac -ar 22050 -b:a 64k -ac 1 -pix_fmt yuv420p -movflags +faststart 240.mp4\n")),(0,l.kt)("p",null,"Create file fragments:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.bento4.com/downloads/"},"Install Bento4"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"mp4fragment 1080.mp4 1080-f.mp4 && \\\nmp4fragment 720.mp4 720-f.mp4 && \\\nmp4fragment 480.mp4 480-f.mp4 && \\\nmp4fragment 360.mp4 360-f.mp4 && \\\nmp4fragment 240.mp4 240-f.mp4\n")),(0,l.kt)("p",null,"Generate the DASH Playlist:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"mp4dash 240-f.mp4 360-f.mp4 480-f.mp4 720-f.mp4 1080-f.mp4\n")),(0,l.kt)("h3",{id:"adaptive-webm-dash-streaming"},"Adaptive WebM DASH Streaming"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/Dash-Industry-Forum/dash.js/wiki"},"dash.js")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://wiki.webmproject.org/adaptive-streaming/instructions-to-playback-adaptive-webm-using-dash"},"wiki.webmproject.org"))),(0,l.kt)("h2",{id:"playback"},"Playback"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffplay rtsp://admin:instar@192.168.2.19:554/livestream/11\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Stream #0:0: Video: hevc (Main), yuv420p(tv), 2560x1440, 30 tbr, 90k tbn\nStream #0:1: Audio: aac (LC), 16000 Hz, mono, fltp")),(0,l.kt)("h2",{id:"probing--metadata"},"Probing & Metadata"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffprobe recording_h264.mp4\n\nInput #0, mov,mp4,m4a,3gp,3g2,mj2, from 'recording_h264.mp4':\n  Metadata:\n    major_brand     : isom\n    minor_version   : 512\n    compatible_brands: isomiso2avc1mp41\n    title           : instarsxrtpsion\n    encoder         : Lavf59.16.100\n  Duration: 10:20:37.34, start: 0.000000, bitrate: 6 kb/s\n  Stream #0:0[0x1](und): Video: h264 (High) (avc1 / 0x31637661), yuv420p(progressive), 2560x1440, 7031 kb/s, 30 fps, 30 tbr, 15360 tbn (default)\n    Metadata:\n      handler_name    : VideoHandler\n      vendor_id       : [0][0][0][0]\n  Stream #0:1[0x2](und): Audio: aac (LC) (mp4a / 0x6134706D), 16000 Hz, mono, fltp, 0 kb/s (default)      \n    Metadata:\n      handler_name    : SoundHandler\n      vendor_id       : [0][0][0][0]\n")),(0,l.kt)("p",null,"Writing results to file:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffprobe -v quiet -print_format json -show_format -show_streams recording_h264.mp4 > recording_h264.json\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "streams": [\n        {\n            "index": 0,\n            "codec_name": "h264",\n            "codec_long_name": "H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10",\n            "profile": "High",\n            "codec_type": "video",\n            "codec_tag_string": "avc1",\n            "codec_tag": "0x31637661",\n            "width": 2560,\n            "height": 1440,\n            "coded_width": 2560,\n            "coded_height": 1440,\n            "closed_captions": 0,\n            "film_grain": 0,\n            "has_b_frames": 2,\n            "pix_fmt": "yuv420p",\n            "level": 50,\n            "chroma_location": "left",\n            "field_order": "progressive",\n            "refs": 1,\n            "is_avc": "true",\n            "nal_length_size": "4",\n            "id": "0x1",\n            "r_frame_rate": "30/1",\n            "avg_frame_rate": "30/1",\n            "time_base": "1/15360",\n            "start_pts": 0,\n            "start_time": "0.000000",\n            "duration_ts": 520704,\n            "duration": "33.900000",\n            "bit_rate": "7031676",\n            "bits_per_raw_sample": "8",\n            "nb_frames": "1017",\n            "extradata_size": 46,\n            "disposition": {\n                "default": 1,\n                "dub": 0,\n                "original": 0,\n                "comment": 0,\n                "lyrics": 0,\n                "karaoke": 0,\n                "forced": 0,\n                "hearing_impaired": 0,\n                "visual_impaired": 0,\n                "clean_effects": 0,\n                "attached_pic": 0,\n                "timed_thumbnails": 0,\n                "captions": 0,\n                "descriptions": 0,\n                "metadata": 0,\n                "dependent": 0,\n                "still_image": 0\n            },\n            "tags": {\n                "language": "und",\n                "handler_name": "VideoHandler",\n                "vendor_id": "[0][0][0][0]"\n            }\n        },\n        {\n            "index": 1,\n            "codec_name": "aac",\n            "codec_long_name": "AAC (Advanced Audio Coding)",\n            "profile": "LC",\n            "codec_type": "audio",\n            "codec_tag_string": "mp4a",\n            "codec_tag": "0x6134706d",\n            "sample_fmt": "fltp",\n            "sample_rate": "16000",\n            "channels": 1,\n            "channel_layout": "mono",\n            "bits_per_sample": 0,\n            "id": "0x2",\n            "r_frame_rate": "0/0",\n            "avg_frame_rate": "0/0",\n            "time_base": "1/16000",\n            "start_pts": 0,\n            "start_time": "0.000000",\n            "duration_ts": 595797424,\n            "duration": "37237.339000",\n            "bit_rate": "61",\n            "nb_frames": "565",\n            "extradata_size": 5,\n            "disposition": {\n                "default": 1,\n                "dub": 0,\n                "original": 0,\n                "comment": 0,\n                "lyrics": 0,\n                "karaoke": 0,\n                "forced": 0,\n                "hearing_impaired": 0,\n                "visual_impaired": 0,\n                "clean_effects": 0,\n                "attached_pic": 0,\n                "timed_thumbnails": 0,\n                "captions": 0,\n                "descriptions": 0,\n                "metadata": 0,\n                "dependent": 0,\n                "still_image": 0\n            },\n            "tags": {\n                "language": "und",\n                "handler_name": "SoundHandler",\n                "vendor_id": "[0][0][0][0]"\n            }\n        }\n    ],\n    "format": {\n        "filename": "recording_h264.mp4",\n        "nb_streams": 2,\n        "nb_programs": 0,\n        "format_name": "mov,mp4,m4a,3gp,3g2,mj2",\n        "format_long_name": "QuickTime / MOV",\n        "start_time": "0.000000",\n        "duration": "37237.339000",\n        "size": "30104435",\n        "bit_rate": "6467",\n        "probe_score": 100,\n        "tags": {\n            "major_brand": "isom",\n            "minor_version": "512",\n            "compatible_brands": "isomiso2avc1mp41",\n            "title": "instarsxrtpsion",\n            "encoder": "Lavf59.16.100"\n        }\n    }\n}\n')),(0,l.kt)("p",null,"Get recording length in sexagesimal format (HH:MM:SS:ms) :"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffprobe -v error -select_streams v:0 -show_entries stream=duration -of default=noprint_wrappers=1:nokey=1 -sexagesimal recording_h264.mp4\n\n0:00:33.900000\n")),(0,l.kt)("p",null,"Get recording bitrate:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffprobe -v error -select_streams v:0 -show_entries stream=bit_rate -of default=noprint_wrappers=1:nokey=1 recording_h264.mp4\n\n7031676\n")),(0,l.kt)("p",null,"Get embedded metadata:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i '03. No Regrets.mp3' -print_format json -f ffmetadata meta.txt\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-conf"},";FFMETADATA1\ntitle=No Regrets\nartist=Joss Stone\nARTISTS=Joss Stone\nalbum=Never Forget My Love\nalbum_artist=Joss Stone\ntrack=3\ndisc=1/1\nTLEN=223000\nTSRC=QMDA62165268\nBARCODE=196292637489\nITUNESADVISORY=0\ncomposer=Joss Stone\ngenre=R&B\ndate=2022\n")),(0,l.kt)("h2",{id:"video-editing"},"Video Editing"),(0,l.kt)("h3",{id:"cutting"},"Cutting"),(0,l.kt)("p",null,"Get a 10s excerpt of your video starting from the 30s marker:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -ss 00:00:30.000 -i video.mp4 -t 00:00:10.000 video_excerpt.mp4\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -ss 00:00:30.000 -i video.mp4 -t 00:00:10.000 -c copy video_excerpt.mp4\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"frame=329 fps=0.0 q=-1.0 Lsize=395kB time=00:00:10.00 bitrate= 323.3kbits/s speed=2.77e+03x\nvideo:256kB audio:129kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 2.728323%")),(0,l.kt)("h3",{id:"resolution-scaling"},"Resolution Scaling"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://ffmpeg.org/ffmpeg-all.html#Video-size"},"Video Size"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -s 1280x720 output.mp4\n")),(0,l.kt)("h3",{id:"video-overlays"},"Video Overlays"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'ffmpeg -i video.mp4 -i logo.png -filter_complex "overlay=0:0" -codec:a copy watermarked.mp4\n')),(0,l.kt)("p",null,"This can also be used to watermark images:"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("inlineCode",{parentName:"p"},"overlay=0:0"),": Position from left top ",(0,l.kt)("em",{parentName:"p"},"horizontal:vertical"),".")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i source.jpg -i logo.png -filter_complex \u201coverlay=0:0\u201d watermarked.jpg\n")),(0,l.kt)("h3",{id:"add-an-audio-track"},"Add an Audio Track"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i video.mp4 -i 03_No_Regrets.mp3 -map 0:v -map 1:a -c copy result.mp4\n")),(0,l.kt)("h3",{id:"waveform"},"Waveform"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://ffmpeg.org/ffmpeg-filters.html#showwaves"},"FFMPEG Waveforms")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://ffmpeg.org/ffmpeg-utils.html#Color"},"Colours"))),(0,l.kt)("p",null,"Single audio channel:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i mysong.mp3 -filter_complex \"[0:a]showwaves=mode=cline:s=640x480:colors=purple[v]\" -map '[v]' -map '0:a' -c:a copy -pix_fmt yuv420p mysong_waveform.mp4\n")),(0,l.kt)("p",null,"Stereo channels:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i mysong.mp3 -filter_complex \"[0:a]showwaves=split_channels=1:mode=cline:s=640x480:colors=green[v]\" -map '[v]' -map '0:a' -c:a copy -pix_fmt yuv420p mysong_waveform.mp4\n")),(0,l.kt)("p",null,"Show Volume:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i  mysong.mp3 -t 00:01:00 -filter_complex \"[0:a]showvolume,scale=640:-1,pad=640:480 :(ow-iw)/2:(oh-ih)/2[v]\" -map '[v]' -map '0:a' -c:a copy -pix_fmt yuv420p mysong_volume.mp4\n")),(0,l.kt)("p",null,"Frequencies:"),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"Default style")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i mysong.mp3 -t 00:01:00 -filter_complex \"[0:a]showfreqs=s=640x480[v]\" -map '[v]' -map '0:a' -c:a copy -pix_fmt yuv420p mysong_freq.mp4\n")),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"Coloured line style")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i mysong.mp3 -filter_complex \"[0:a]showwaves=mode=line:s=640x480:colors=red[v]\" -map '[v]' -map '0:a' -c:a copy -pix_fmt yuv420p mysong_freq.mp4\n")),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"Cline frequency style")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ffmpeg -i mysong.mp3 -filter_complex \"[0:a]showwaves=mode=cline:s=640x480:colors=dodgerblue[v]\" -map '[v]' -map '0:a' -c:a copy -pix_fmt yuv420p mysong_freq.mp4\n")))}u.isMDXComponent=!0},54235:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-8f745c02d0c455477788a770b5badbe1.jpg"}}]);