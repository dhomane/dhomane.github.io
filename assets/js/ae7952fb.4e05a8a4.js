"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[96274],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>d});var n=a(67294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var i=n.createContext({}),c=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(i.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,l=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(a),d=o,h=u["".concat(i,".").concat(d)]||u[d]||m[d]||l;return a?n.createElement(h,r(r({ref:t},p),{},{components:a})):n.createElement(h,r({ref:t},p))}));function d(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=a.length,r=new Array(l);r[0]=u;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:o,r[1]=s;for(var c=2;c<l;c++)r[c]=a[c];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},39010:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>r,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>c});var n=a(87462),o=(a(67294),a(3905));const l={sidebar_position:1e4,slug:"2020-12-22",title:"Install Tomcat 9 on Ubuntu 20.04",authors:"mpolinowski",tags:["LINUX","Tomcat"]},r=void 0,s={unversionedId:"DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/index",id:"DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/index",title:"Install Tomcat 9 on Ubuntu 20.04",description:"Siem Reap, Cambodia",source:"@site/docs/DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/index.md",sourceDirName:"DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation",slug:"/DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/2020-12-22",permalink:"/docs/DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/2020-12-22",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"},{label:"Tomcat",permalink:"/docs/tags/tomcat"}],version:"current",sidebarPosition:1e4,frontMatter:{sidebar_position:1e4,slug:"2020-12-22",title:"Install Tomcat 9 on Ubuntu 20.04",authors:"mpolinowski",tags:["LINUX","Tomcat"]},sidebar:"tutorialSidebar",previous:{title:"Tomcat 9 Configuration",permalink:"/docs/DevOps/Tomcat/2020-12-23-tomcat9-configuration/2020-12-23"},next:{title:"Salt",permalink:"/docs/category/salt"}},i={},c=[{value:"Install Java",id:"install-java",level:2},{value:"Creating a System User",id:"creating-a-system-user",level:2},{value:"Install Tomcat 9",id:"install-tomcat-9",level:2},{value:"Download the latest Tomcat",id:"download-the-latest-tomcat",level:3},{value:"Extract the Files",id:"extract-the-files",level:3},{value:"Create a SystemD Service",id:"create-a-systemd-service",level:3},{value:"Access the Tomcat Webfrontend",id:"access-the-tomcat-webfrontend",level:2},{value:"Deploying a Demo Application",id:"deploying-a-demo-application",level:2},{value:"Manger App",id:"manger-app",level:3}],p={toc:c};function m(e){let{components:t,...l}=e;return(0,o.kt)("wrapper",(0,n.Z)({},p,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Siem Reap, Cambodia",src:a(1012).Z,width:"1500",height:"706"})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#install-java"},"Install Java")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#creating-a-system-user"},"Creating a System User")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#install-tomcat-9"},"Install Tomcat 9"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#download-the-latest-tomcat"},"Download the latest Tomcat")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#extract-the-files"},"Extract the Files")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#create-a-systemd-service"},"Create a SystemD Service")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#access-the-tomcat-webfrontend"},"Access the Tomcat Webfrontend")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#deploying-a-demo-application"},"Deploying a Demo Application"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#manger-app"},"Manger App"))))),(0,o.kt)("p",null,"Apache Tomcat is an open-source web server and Java servlet container. It is one of the most popular choices for building Java-based websites and applications. Tomcat is lightweight, easy to use, and has a robust ecosystem of add-ons."),(0,o.kt)("h2",{id:"install-java"},"Install Java"),(0,o.kt)("p",null,"Tomcat 9 requires Java SE 8 or later to be installed on the system. \xcc\u2019ll install OpenJDK 11 , the open-source implementation of the Java Platform."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"apt update\napt install openjdk-11-jdk\n")),(0,o.kt)("p",null,"Verify the installation by checking the Java version:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"java -version\n")),(0,o.kt)("h2",{id:"creating-a-system-user"},"Creating a System User"),(0,o.kt)("p",null,"I\u2019ll create a new system user and group with home directory ",(0,o.kt)("inlineCode",{parentName:"p"},"/opt/tomcat")," that will run the Tomcat service:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"useradd -m -U -d /opt/tomcat -s /bin/false tomcat\n")),(0,o.kt)("h2",{id:"install-tomcat-9"},"Install Tomcat 9"),(0,o.kt)("h3",{id:"download-the-latest-tomcat"},"Download the latest Tomcat"),(0,o.kt)("p",null,"Tomcat binary distribution is available for download from the ",(0,o.kt)("a",{parentName:"p",href:"https://tomcat.apache.org/download-90.cgi"},"Tomcat downloads page"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"wget https://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/tomcat-9/v9.0.41/bin/apache-tomcat-9.0.41.tar.gz -P /tmp\n")),(0,o.kt)("h3",{id:"extract-the-files"},"Extract the Files"),(0,o.kt)("p",null,"Extract the tar file to the Tomcat user home directory ",(0,o.kt)("inlineCode",{parentName:"p"},"/opt/tomcat")," directory:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"tar -xf /tmp/apache-tomcat-9.0.41.tar.gz -C /opt/tomcat/\nln -s /opt/tomcat/apache-tomcat-9.0.41 /opt/tomcat/latest\n")),(0,o.kt)("p",null,"Change the directory ownership to user and group tomcat:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"chown -R tomcat: /opt/tomcat\n")),(0,o.kt)("p",null,"The shell scripts inside the Tomcat\u2019s bin directory must be executable:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo sh -c 'chmod +x /opt/tomcat/latest/bin/*.sh'\n")),(0,o.kt)("h3",{id:"create-a-systemd-service"},"Create a SystemD Service"),(0,o.kt)("p",null,"Open your text editor and create a tomcat.service unit file in the ",(0,o.kt)("inlineCode",{parentName:"p"},"/etc/systemd/system/")," directory:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nano /etc/systemd/system/tomcat.service\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'[Unit]\nDescription=Tomcat 9 servlet container\nAfter=network.target\n\n[Service]\nType=forking\n\nUser=tomcat\nGroup=tomcat\n\nEnvironment="JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64"\nEnvironment="JAVA_OPTS=-Djava.security.egd=file:///dev/urandom -Djava.awt.headless=true"\n\nEnvironment="CATALINA_BASE=/opt/tomcat/latest"\nEnvironment="CATALINA_HOME=/opt/tomcat/latest"\nEnvironment="CATALINA_PID=/opt/tomcat/latest/temp/tomcat.pid"\nEnvironment="CATALINA_OPTS=-Xms512M -Xmx1024M -server -XX:+UseParallelGC"\n\nExecStart=/opt/tomcat/latest/bin/startup.sh\nExecStop=/opt/tomcat/latest/bin/shutdown.sh\n\n[Install]\nWantedBy=multi-user.target\n')),(0,o.kt)("p",null,"Find the Java home directory:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"find / -name java-11-openjdk-amd64\n\n/usr/lib/jvm/java-11-openjdk-amd64\n")),(0,o.kt)("p",null,"Save and close the file and notify systemd that a new unit file exists:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl daemon-reload\nsudo systemctl enable --now tomcat\nsudo systemctl status tomcat\n")),(0,o.kt)("p",null,"You can start, stop and restart Tomcat same as any other systemd service:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"service tomcat start\nservice tomcat stop\nservice tomcat restart\n")),(0,o.kt)("h2",{id:"access-the-tomcat-webfrontend"},"Access the Tomcat Webfrontend"),(0,o.kt)("p",null,"Open the port 8080 in your firewall:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ufw allow 8080/tcp\n")),(0,o.kt)("p",null,"And access the IP address of your server with your web browser:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Install Tomcat 9 on Ubuntu 20.04",src:a(90139).Z,width:"1146",height:"437"})),(0,o.kt)("h2",{id:"deploying-a-demo-application"},"Deploying a Demo Application"),(0,o.kt)("p",null,"To deploy an application, simply drag the application folder into the ",(0,o.kt)("strong",{parentName:"p"},"webapps")," folder in the Tomcat installation directory - in my case ",(0,o.kt)("inlineCode",{parentName:"p"},"/opt/tomcat/apache-tomcat-9.0.41/webapps"),". I do not have an application so I will just create an empty folder ",(0,o.kt)("inlineCode",{parentName:"p"},"boilerplate")," and add an ",(0,o.kt)("inlineCode",{parentName:"p"},"index.jsp")," file with the following content:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- nano /opt/tomcat/apache-tomcat-9.0.41/webapps/boilerplate/index.jsp --\x3e\n\n<%@ page language="java" contentType="text/html; charset=ISO-8859-1"\npageEncoding="ISO-8859-1"%>\n\n<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n<html>\n  <head>\n    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />\n    <title>Tomcat Boilerplate</title>\n  </head>\n  <body>\n    <h1>This is just a test..</h1>\n    <h3>Tomcats!</h3>\n  </body>\n</html>\n')),(0,o.kt)("p",null,"The application will automatically be deployed and be reachable under ",(0,o.kt)("inlineCode",{parentName:"p"},"/boilerplate/")," - e.g.:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"http://192.168.2.111:8080/boilerplate/\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"The compiled work file for the servlet can be found in ",(0,o.kt)("inlineCode",{parentName:"p"},"/opt/tomcat/apache-tomcat-9.0.41/work/Catalina/localhost/boilerplate"),".")),(0,o.kt)("h3",{id:"manger-app"},"Manger App"),(0,o.kt)("p",null,"To use the manager app we first have to create a user login. This can be done in the ",(0,o.kt)("inlineCode",{parentName:"p"},"tomcat-users.xml")," in the ",(0,o.kt)("inlineCode",{parentName:"p"},"conf")," directory. Add the ",(0,o.kt)("inlineCode",{parentName:"p"},"manager-gui")," role as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- nano /opt/tomcat/apache-tomcat-9.0.41/conf/tomcat-users.xml --\x3e\n\n<tomcat-users xmlns="http://tomcat.apache.org/xml"\n              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n              xsi:schemaLocation="http://tomcat.apache.org/xml tomcat-users.xsd"\n              version="1.0">\n\n  <role rolename="manager-gui"/>\n  <user username="admin" password="instar" roles="manager-gui"/>\n\n</tomcat-users>\n')),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Access to the Manager App is only allowed on ",(0,o.kt)("inlineCode",{parentName:"p"},"localhost"),". Since I am accessing remotely I will have to ",(0,o.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/36703856/access-tomcat-manager-app-from-different-host"},"add my IP address to the allowed")," ",(0,o.kt)("inlineCode",{parentName:"p"},"org.apache.catalina.valves.RemoteAddrValve")," inside the ",(0,o.kt)("inlineCode",{parentName:"p"},"context.xml")," of the manager app:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- nano /opt/tomcat/apache-tomcat-9.0.41/webapps/manager/META-INF/context.xml --\x3e\n\n<Valve className="org.apache.catalina.valves.RemoteAddrValve"\n         allow="127\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1|192.168.2.112" />\n')),(0,o.kt)("p",null,"or allow all address with an regular expression:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<Valve className="org.apache.catalina.valves.RemoteAddrValve"\n         allow=".*" />\n')),(0,o.kt)("p",null,"Restart your server:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"service tomcat restart\n")),(0,o.kt)("p",null,"I can now access the ",(0,o.kt)("strong",{parentName:"p"},"Manager App")," ",(0,o.kt)("inlineCode",{parentName:"p"},"http://192.168.2.111:8080/manager/html")," with the login ",(0,o.kt)("strong",{parentName:"p"},"admin/instar"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Install Tomcat 9 on Ubuntu 20.04",src:a(80603).Z,width:"1186",height:"711"})))}m.isMDXComponent=!0},1012:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-dbec03b1535301c8b293ac3087af0dd4.jpg"},90139:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/tomcat9-ubuntu-20-10-installation_01-720e9b8d20be446399f06b32a85fbecb.png"},80603:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/tomcat9-ubuntu-20-10-installation_02-55050835e3b0ff8bd44251d5bf676a65.png"}}]);