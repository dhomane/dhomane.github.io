"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[16511],{3905:(e,t,a)=>{a.d(t,{Zo:()=>b,kt:()=>p});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},b=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,b=s(e,["components","mdxType","originalType","parentName"]),g=c(a),p=i,m=g["".concat(l,".").concat(p)]||g[p]||d[p]||r;return a?n.createElement(m,o(o({ref:t},b),{},{components:a})):n.createElement(m,o({ref:t},b))}));function p(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=g;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<r;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},74700:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var n=a(87462),i=(a(67294),a(3905));const r={sidebar_position:7080,slug:"2022-01-16",title:"Zabbix v6 Creating triggers for Baseline monitoring and Anomaly detection",authors:"mpolinowski",tags:["LINUX","Zabbix"]},o=void 0,s={unversionedId:"DevOps/Zabbix/2022-01-16--zabbix-v6-baseline-monitoring/index",id:"DevOps/Zabbix/2022-01-16--zabbix-v6-baseline-monitoring/index",title:"Zabbix v6 Creating triggers for Baseline monitoring and Anomaly detection",description:"TST, Hong Kong",source:"@site/docs/DevOps/Zabbix/2022-01-16--zabbix-v6-baseline-monitoring/index.md",sourceDirName:"DevOps/Zabbix/2022-01-16--zabbix-v6-baseline-monitoring",slug:"/DevOps/Zabbix/2022-01-16--zabbix-v6-baseline-monitoring/2022-01-16",permalink:"/docs/DevOps/Zabbix/2022-01-16--zabbix-v6-baseline-monitoring/2022-01-16",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Zabbix/2022-01-16--zabbix-v6-baseline-monitoring/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"},{label:"Zabbix",permalink:"/docs/tags/zabbix"}],version:"current",sidebarPosition:7080,frontMatter:{sidebar_position:7080,slug:"2022-01-16",title:"Zabbix v6 Creating triggers for Baseline monitoring and Anomaly detection",authors:"mpolinowski",tags:["LINUX","Zabbix"]},sidebar:"tutorialSidebar",previous:{title:"Zabbix <3 Zimbra",permalink:"/docs/DevOps/Zabbix/2022-07-15-zabbix-for-zimbra/2022-07-15"},next:{title:"Zabbix v6 SMART HDD Check",permalink:"/docs/DevOps/Zabbix/2022-01-15--zabbix-v6-smart-hdd-check/2022-01-15"}},l={},c=[{value:"Anomaly Detection",id:"anomaly-detection",level:2},{value:"Baseline Detection",id:"baseline-detection",level:2},{value:"Baseline Trigger",id:"baseline-trigger",level:3},{value:"Deviation Count",id:"deviation-count",level:3}],b={toc:c};function d(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,n.Z)({},b,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"TST, Hong Kong",src:a(56353).Z,width:"1500",height:"622"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#anomaly-detection"},"Anomaly Detection")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#baseline-detection"},"Baseline Detection"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#baseline-trigger"},"Baseline Trigger")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#deviation-count"},"Deviation Count"))))),(0,i.kt)("p",null,"Taking a look at how to monitor deviations between seasonal data, calculate baseline values for your metrics and detect anomaly rates with the new Zabbix 6.0 LTS Machine learning functions."),(0,i.kt)("h2",{id:"anomaly-detection"},"Anomaly Detection"),(0,i.kt)("p",null,"Go to ",(0,i.kt)("strong",{parentName:"p"},"Configuration")," and ",(0,i.kt)("strong",{parentName:"p"},"Templates"),". Select the ",(0,i.kt)("strong",{parentName:"p"},"Linux by Zabbix Agent")," and click on ",(0,i.kt)("strong",{parentName:"p"},"Triggers"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zabbix Machine Learning",src:a(70400).Z,width:"1003",height:"356"})),(0,i.kt)("p",null,"Here we need to ",(0,i.kt)("strong",{parentName:"p"},"Create a Trigger")," - for example if the CPU utilization spikes 2-times in a day we want to be notified. The expression seen below can be constructed by clicking on ",(0,i.kt)("strong",{parentName:"p"},"Add"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zabbix Machine Learning",src:a(19166).Z,width:"879",height:"695"})),(0,i.kt)("p",null,"Here I am using ",(0,i.kt)("inlineCode",{parentName:"p"},"system.cpu.util")," as a data point. I want to analyze the data of the last 28 days. The time window for the detection is 1 day and I am expecting to see some seasonality over 1 week - e.g. the webserver traffic always spikes on mondays:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zabbix Machine Learning",src:a(92532).Z,width:"999",height:"487"})),(0,i.kt)("p",null,"Add the trigger and verify that it was created by switching to the ",(0,i.kt)("strong",{parentName:"p"},"Items")," tab:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zabbix Machine Learning",src:a(57683).Z,width:"963",height:"579"})),(0,i.kt)("h2",{id:"baseline-detection"},"Baseline Detection"),(0,i.kt)("p",null,"There are two algorithm that we can choose from here. The first one returns the baseline and the second the number of deviations from that baseline over a set period:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"baselinewma")," - Calculates the baseline by averaging data from the same timeframe in multiple equal\ntime periods ('seasons') using the weighted moving average (WMA) algorithm."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"baselinedev")," - Returns the number of deviations (by stddevpop algorithm) between the last data period\nand the same data periods in preceding seasons.")),(0,i.kt)("p",null,"We can use both as triggers for our server monitoring."),(0,i.kt)("h3",{id:"baseline-trigger"},"Baseline Trigger"),(0,i.kt)("p",null,"Create a new trigger that is called when the average memory utilization is 2-times higher than the calculated baseline over the last 4 weeks. Again, we can use the constructor to create the expressions and than add some math to it:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zabbix Machine Learning",src:a(34880).Z,width:"919",height:"348"})),(0,i.kt)("p",null,"Calculate the baseline over 4 weeks with a 1 week periodicity and 8h time windows:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zabbix Machine Learning",src:a(24649).Z,width:"970",height:"378"})),(0,i.kt)("p",null,"And get the average trend for the last 8h to compare with the calculated baseline:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zabbix Machine Learning",src:a(27263).Z,width:"958",height:"317"})),(0,i.kt)("p",null,"Add the trigger and verify that it was created on the ",(0,i.kt)("strong",{parentName:"p"},"Items")," tab:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zabbix Machine Learning",src:a(94918).Z,width:"1005",height:"624"})),(0,i.kt)("h3",{id:"deviation-count"},"Deviation Count"),(0,i.kt)("p",null,"Instead of comparing the baseline to the average value we can also detect direct deviations from the baseline. For example if the number of deviations in sent data from our webserver is greater than ",(0,i.kt)("inlineCode",{parentName:"p"},"0")," give us an alert:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zabbix Machine Learning",src:a(71802).Z,width:"803",height:"311"})),(0,i.kt)("p",null,"Again, we can use the constructor to create the expression for us:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zabbix Machine Learning",src:a(97505).Z,width:"987",height:"401"})))}d.isMDXComponent=!0},70400:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_Machine_Learning_01-cc4b7527204602804ff8881951d158e5.png"},19166:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_Machine_Learning_02-8cbc8815398dacf89ef4a728618e04d9.png"},92532:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_Machine_Learning_03-52a99a6060c6b6b0838e26617517619c.png"},57683:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_Machine_Learning_04-f1860e8e0380bae92f78b2888fbf4efb.png"},34880:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_Machine_Learning_05-9b8f5f1d16bb914d666565d3bc870f02.png"},24649:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_Machine_Learning_06-52290b6583ba9ea4ce9b193083afb129.png"},27263:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_Machine_Learning_07-4690d72473c71216993a1a995e61e72e.png"},94918:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_Machine_Learning_08-61c6575e8dae03b30259dd2c463622a1.png"},71802:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_Machine_Learning_09-ca15eee18b96de0cabed12d10f9bdbae.png"},97505:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Zabbix_Machine_Learning_10-403c91a1d0868c73a948ef752487f538.png"},56353:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-d8b333d1f9ddf34ac7392aef86b14c83.jpg"}}]);