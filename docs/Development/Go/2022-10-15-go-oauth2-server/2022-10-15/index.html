<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Development/Go/2022-10-15-go-oauth2-server/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Go OAuth2 Server | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/Development/Go/2022-10-15-go-oauth2-server/2022-10-15"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Go OAuth2 Server | Mike Polinowski"><meta data-rh="true" name="description" content="Simple OAuth2 Implementation in Go"><meta data-rh="true" property="og:description" content="Simple OAuth2 Implementation in Go"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/Development/Go/2022-10-15-go-oauth2-server/2022-10-15"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/Development/Go/2022-10-15-go-oauth2-server/2022-10-15" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/Development/Go/2022-10-15-go-oauth2-server/2022-10-15" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.714c4925.css">
<link rel="preload" href="/assets/js/runtime~main.23698315.js" as="script">
<link rel="preload" href="/assets/js/main.2d20e69f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/development">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/javascript">Javascript</a><button aria-label="Toggle the collapsible sidebar category &#x27;Javascript&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/python">Python</a><button aria-label="Toggle the collapsible sidebar category &#x27;Python&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/go">Go</a><button aria-label="Toggle the collapsible sidebar category &#x27;Go&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2022-12-27-go-data-structures/2022-12-27">Go Data Structures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2022-12-27-go-bubbles/2022-12-27">Go Bubbles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2022-12-26-go-webassembly/2022-12-26">Go WebAssembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2022-11-11-go-nts-client-ci/2022-11-11">Building a NTP/S Timeserver Client in Go with Gitlab CI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Development/Go/2022-10-15-go-oauth2-server/2022-10-15">Go OAuth2 Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2022-10-05-go-reducing-binary-size/2022-10-05">Go Build!</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2022-10-04-go-ntp-client/2022-10-04">Build a NTP/S Timeserver Client in Go</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2022-06-15-wails-go-react/2022-06-15">Wails - Build desktop apps using Go &amp; React</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-10-08--goftp/2021-10-08">goFTP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-09-24--golang-react-starter-part-iv/2021-09-24">Getting started with Go and React - React &amp; REST API&#x27;s</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-09-23--golang-react-starter-part-iii/2021-09-23">Getting started with Go and React - PostgreSQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-09-22--golang-react-starter-part-ii/2021-09-22">Getting started with Go and React - API Routes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-09-21--golang-react-starter-part-i/2021-09-21">Getting started with Go and React - Webservice, Routing and Status Log</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-09-11--golang-refresher-network/2021-09-11">Golang Refresher :: url &amp; http</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-09-11--golang-refresher-math-os/2021-09-11">Golang Refresher :: math &amp; os</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-09-11--golang-refresher-fmt-strings/2021-09-11">Golang Refresher :: fmt &amp; strings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-09-10--go-websockets/2021-09-10">Go Websockets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-06-03--mqtt-with-golang/2021-06-03">Paho MQTT Client with Golang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Go/2021-02-21-gofiber-container-gatsby/2021-02-21">GoFiber Container for your Gatsby Build</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/graphs">Graphs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Graphs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/react-native">React Native</a><button aria-label="Toggle the collapsible sidebar category &#x27;React Native&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/magento">Magento</a><button aria-label="Toggle the collapsible sidebar category &#x27;Magento&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/misc">Misc</a><button aria-label="Toggle the collapsible sidebar category &#x27;Misc&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/internet-of-things--machine-learning">Internet-of-Things &amp; Machine Learning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internet-of-Things &amp; Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/development"><span itemprop="name">Development</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/go"><span itemprop="name">Go</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Go OAuth2 Server</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Go OAuth2 Server</h1></header><p><img loading="lazy" alt="Shenzhen, China" src="/assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-0795219c47cded4f1a1480a5f18e4c60.jpg" width="1500" height="546" class="img_ev3q"></p><p><a href="https://github.com/mpolinowski/go-oauth2" target="_blank" rel="noopener noreferrer">Github Repository</a></p><blockquote><p>Coding along <a href="https://hackernoon.com/build-your-own-oauth2-server-in-go-7d0f660732c3" target="_blank" rel="noopener noreferrer">Build your own OAuth2 Server in Go</a>.</p></blockquote><ul><li><a href="#client-credentials-grant-flow-based-server">Client Credentials Grant Flow Based Server</a><ul><li><a href="#resource-server">Resource Server</a><ul><li><a href="#protecting-the-route">Protecting the Route</a></li></ul></li><li><a href="#authorization-server">Authorization Server</a><ul><li><a href="#routing">Routing</a></li></ul></li><li><a href="#complete-code">Complete Code</a></li></ul></li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Client -- Request Access Token --</span><span class="token operator">&gt;</span><span class="token plain"> OAuth2 Server </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">requires </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">client_id</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">client_secret</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OAuth2 Server -- Grant Access Token --</span><span class="token operator">&gt;</span><span class="token plain"> Client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Client -- API Call --</span><span class="token operator">&gt;</span><span class="token plain"> Resource Server </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">requires </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">access_token</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Resource Server -- Data Response --</span><span class="token operator">&gt;</span><span class="token plain"> Client</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">go mod init go-oauth2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="client-credentials-grant-flow-based-server">Client Credentials Grant Flow Based Server<a class="hash-link" href="#client-credentials-grant-flow-based-server" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="resource-server">Resource Server<a class="hash-link" href="#resource-server" title="Direct link to heading">​</a></h3><p>Provide an API that you want to protect using OAuth2:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;net/http&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/protected&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Write</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token function" style="color:rgb(80, 250, 123)">byte</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Secret Information in Need for Protection&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Fatal</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ListenAndServe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;:9096&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Go OAuth2 Server" src="data:image/png;base64,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" width="936" height="111" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="protecting-the-route">Protecting the Route<a class="hash-link" href="#protecting-the-route" title="Direct link to heading">​</a></h4><p>Validate the access token given with the request:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">validateToken</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">f http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">HandlerFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> srv </span><span class="token operator">*</span><span class="token plain">server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">HandlerFunc </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandlerFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token boolean">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> srv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ValidationBearerToken</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">StatusBadRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ServeHTTP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Adding the middleware in front of the route I want to protect:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/protected&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">validateToken</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Write</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token function" style="color:rgb(80, 250, 123)">byte</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Secret Information in Need for Protection&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> srv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Go OAuth2 Server" src="data:image/png;base64,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AAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACiO6AQAAIDiiE4AAAAojugEAACA4ohOAAAAKI7oBAAAgOKITgAAACju/wPkLb/0duDOAwAAAABJRU5ErkJggg==" width="892" height="168" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="authorization-server">Authorization Server<a class="hash-link" href="#authorization-server" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="routing">Routing<a class="hash-link" href="#routing" title="Direct link to heading">​</a></h4><ul><li><code>/credentials</code> for issuing client credentials (client_id and client_secret)</li></ul><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/credentials&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">//  create random client id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   clientId </span><span class="token operator">:=</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">New</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">String</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">//  create random client secret</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   clientSecret </span><span class="token operator">:=</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">New</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">String</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">//  save both in client store</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   err </span><span class="token operator">:=</span><span class="token plain"> clientStore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Set</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clientId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">models</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">     clientId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      Secret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> clientSecret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// scoped to resource url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      Domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http://localhost:9094&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      fmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Header</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Set</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Content-Type&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;application/json&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   json</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">NewEncoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Encode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;CLIENT_ID&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> clientId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;CLIENT_SECRET&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> clientSecret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>http://localhost:9096/credentials</em></p><p><img loading="lazy" alt="Go OAuth2 Server" src="/assets/images/Go_OAuth2_Server_03-dae03b7605936f01b643263c459ab579.png" width="947" height="145" class="img_ev3q"></p><p>On the <code>credentials</code> route I am now receiving random values for the Client ID and Secret:</p><ol><li><strong>client_id</strong>= <code>9f61b47b</code></li><li><strong>client<!-- -->_<!-- -->secret</strong>= <code>3d113393</code></li></ol><ul><li><code>/token</code> to issue token with client credentials</li></ul><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/token&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   srv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleTokenRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>http://localhost:9096/token?grant<!-- -->_<!-- -->type=client<!-- -->_<!-- -->credentials&amp;client<!-- -->_<!-- -->id=YOUR<!-- -->_<!-- -->CLIENT<!-- -->_<!-- -->ID&amp;client<!-- -->_<!-- -->secret=YOUR<!-- -->_<!-- -->CLIENT<!-- -->_<!-- -->SECRET&amp;scope=all</em></p><p><img loading="lazy" alt="Go OAuth2 Server" src="/assets/images/Go_OAuth2_Server_04-7a0caebaeddd4d9db876086ed90a8bac.png" width="956" height="178" class="img_ev3q"></p><p>Here I am getting the Access Token with an expiration time that I can use to access my resource:</p><ol><li><strong>access<!-- -->_<!-- -->token</strong> =	<code>SXH18FJHMI2GIP4GL_XTYQ</code></li></ol><p>I can now use my access token to unlock the protected route:</p><p><em>http://localhost:9096/protected?access<!-- -->_<!-- -->token=YOUR<!-- -->_<!-- -->ACCESS<!-- -->_<!-- -->TOKEN</em></p><p><img loading="lazy" alt="Go OAuth2 Server" src="/assets/images/Go_OAuth2_Server_05-1c7f63542c4154e22316f15cd1c24c11.png" width="888" height="143" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="complete-code">Complete Code<a class="hash-link" href="#complete-code" title="Direct link to heading">​</a></h3><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;encoding/json&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;fmt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;github.com/google/uuid&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;gopkg.in/oauth2.v3/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;net/http&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;time&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;gopkg.in/oauth2.v3/errors&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;gopkg.in/oauth2.v3/manage&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;gopkg.in/oauth2.v3/server&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;gopkg.in/oauth2.v3/store&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   manager </span><span class="token operator">:=</span><span class="token plain"> manage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">NewDefaultManager</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   manager</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">SetAuthorizeCodeTokenCfg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">manage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DefaultAuthorizeCodeTokenCfg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">// token memory store</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   manager</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">MustTokenStorage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">store</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">NewMemoryTokenStore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">// client memory store</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   clientStore </span><span class="token operator">:=</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">NewClientStore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   manager</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">MapClientStorage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clientStore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   srv </span><span class="token operator">:=</span><span class="token plain"> server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">NewDefaultServer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">manager</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   srv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">SetAllowGetAccessRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   srv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">SetClientInfoHandler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ClientFormHandler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   manager</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">SetRefreshTokenCfg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">manage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DefaultRefreshTokenCfg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   srv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">SetInternalErrorHandler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">err </span><span class="token builtin" style="color:rgb(189, 147, 249)">error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">re </span><span class="token operator">*</span><span class="token plain">errors</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Internal Error:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   srv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">SetResponseErrorHandler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">re </span><span class="token operator">*</span><span class="token plain">errors</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Response Error:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> re</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/token&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      srv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleTokenRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/credentials&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      clientId </span><span class="token operator">:=</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">New</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">String</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      clientSecret </span><span class="token operator">:=</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">New</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">String</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      err </span><span class="token operator">:=</span><span class="token plain"> clientStore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Set</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clientId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">models</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         ID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">     clientId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         Secret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> clientSecret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         Domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http://localhost:9094&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         fmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Header</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Set</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Content-Type&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;application/json&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      json</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">NewEncoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Encode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;CLIENT_ID&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> clientId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;CLIENT_SECRET&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> clientSecret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/protected&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">validateToken</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Write</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token function" style="color:rgb(80, 250, 123)">byte</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Secret Information in Need for Protection&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> srv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Fatal</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ListenAndServe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;:9096&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">validateToken</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">f http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">HandlerFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> srv </span><span class="token operator">*</span><span class="token plain">server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">HandlerFunc </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandlerFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token boolean">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> srv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ValidationBearerToken</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">StatusBadRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ServeHTTP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/go">Go</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Development/Go/2022-10-15-go-oauth2-server/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Development/Go/2022-11-11-go-nts-client-ci/2022-11-11"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Building a NTP/S Timeserver Client in Go with Gitlab CI</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Development/Go/2022-10-05-go-reducing-binary-size/2022-10-05"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Go Build!</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#client-credentials-grant-flow-based-server" class="table-of-contents__link toc-highlight">Client Credentials Grant Flow Based Server</a><ul><li><a href="#resource-server" class="table-of-contents__link toc-highlight">Resource Server</a></li><li><a href="#authorization-server" class="table-of-contents__link toc-highlight">Authorization Server</a></li><li><a href="#complete-code" class="table-of-contents__link toc-highlight">Complete Code</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.23698315.js"></script>
<script src="/assets/js/main.2d20e69f.js"></script>
</body>
</html>