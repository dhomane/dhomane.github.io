<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-IoT-and-Machine-Learning/Home_Automation/2019-01-05--zigbee2mqtt-xiaomi-fhem/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Zigbee Sensors in FHEM | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/Home_Automation/2019-01-05--zigbee2mqtt-xiaomi-fhem/2019-01-05"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Zigbee Sensors in FHEM | Mike Polinowski"><meta data-rh="true" name="description" content="Hongkong"><meta data-rh="true" property="og:description" content="Hongkong"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/Home_Automation/2019-01-05--zigbee2mqtt-xiaomi-fhem/2019-01-05"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/Home_Automation/2019-01-05--zigbee2mqtt-xiaomi-fhem/2019-01-05" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/Home_Automation/2019-01-05--zigbee2mqtt-xiaomi-fhem/2019-01-05" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.714c4925.css">
<link rel="preload" href="/assets/js/runtime~main.23698315.js" as="script">
<link rel="preload" href="/assets/js/main.2d20e69f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/internet-of-things--machine-learning">Internet-of-Things &amp; Machine Learning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internet-of-Things &amp; Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/machine-learning">Machine Learning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/aiops">AIOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;AIOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/home-automation">Home Automation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Home Automation&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-12-22--grafana-for-iot/2022-12-22">Grafana IoT Dashboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-12-15--rtsp-to-hls-ffmpeg/2022-12-15">Convert RTSP to HLS using FFmpeg</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-10-18-camera-ui-docker/2022-10-18">Run Camera.UI with Docker-Compose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-17-node-red-for-mqtt-autodiscovery/2022-07-17">MQTT Auto-Discovery - Use Node-RED to register Smarthome Devices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-16-openhab-mqtt-homie/2022-07-16">OpenHab - MQTT Homie Convention</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-15-node-red-mqtt-homie/2022-07-15">Node-RED - MQTT Homie Convention</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-10-home-assistant-mqtt-autodiscovery-part-i/2022-07-10">Home Assistant - MQTT Auto-Discovery :: Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-11-home-assistant-mqtt-autodiscovery-part-ii/2022-07-11">Home Assistant - MQTT Auto-Discovery :: Automation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-12-home-assistant-mqtt-python/2022-07-12">Home Assistant - Python Scripts as Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2020-12-03--openhab3-camera-binding/2020-12-03">OpenHAB 3 INSTAR Camera Binding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2020-12-02--openhab3-mqtt-binding/2020-12-02">OpenHAB 3 MQTT Binding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2020-12-01--openhab3-in-docker/2020-12-01">Trying out OpenHAB 3 in Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2020-09-16--testing-new-rest-api-with-nodered/2020-09-16">Testing a new REST API in Node-RED</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2020-09-15--mock-rest-api-with-nodered/2020-09-16">A Mock REST API in Node-RED and Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-11--loxone-miniserver/2019-02-11">Loxone Miniserver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-12-01--podman-hombridge-to-mqtt/2019-12-01">Podman Homebridge to MQTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-09--zoneminder-in-docker/2019-02-09">Zoneminder Dockerized</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-28--node-red-homekit-containerized/2019-09-28">Adding Homekit to your Node-RED Container in Podman</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-08--shinobi-on-debian/2019-02-08">Shinobi Video Surveillance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-27--home-assistant-podman-centos8/2019-09-27">Home Assistant, OpenHAB, Node-RED, ioBroker, MotionEye Containerized</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-07--motioneye-on-debian/2019-02-07">MotionEye Video Surveillance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-24--motioneye-podman-centos8/2019-09-24">Installing MotionEye on CentOS8 with Podman</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-01-05--zigbee2mqtt-xiaomi-fhem/2019-01-05">Zigbee Sensors in FHEM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-24--iobroker-podman-centos8/2019-09-24">Installing ioBroker on CentOS8 with Podman</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-12-01--openhab2-on-debian/2018-12-01">OpenHAB2 and MQTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-23--mqtt-camera-ai-video-security/2019-09-23">MQTT Camera AI Enhanced Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-30--home-assistant-on-debian/2018-11-30">Home Assistant and MQTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-29--node-red-and-mqtt/2018-11-29">Node-RED and MQTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-03-26--writing-a-homey-app/2019-03-26">Developing an App for the Homey Smarthome Gateway</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-28--node-red-on-android/2018-11-28">Node-RED on Android</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-16--ifttt-ip-camera-alarmserver/2019-02-15">IFTTT Alarmserver for IP Cameras</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-27--node-red-sql-logging/2018-11-27">Node-RED SQL Logging Datastreams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-15--ifttt-ip-camera/2019-02-15">IFTTT IP Camera</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-26--node-red-and-live-video/2018-11-26">Node-RED Dashboard and Videostreams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-25--webhooks-with-url-queries/2018-11-25">Webhooks with URL Queries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-24--node-red-webhooks/2018-11-24">Node-RED Webhooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-23--node-red-flows/2018-11-23">Node-RED Flows and how to Import them</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-21--nodered-dashboard-getting-started/2018-11-21">Creating Node-RED Admin Panel using node-red-dashboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-20--nodered-http-connect/2018-11-20">Node-RED Interaction over HTTP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-17--nodered-mqtt-connect/2018-11-17">A Collection of Node-RED MQTT Recipes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-13--nodered-ifttt/2018-11-13">Node-RED with IFTTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-12--nodered-sqlite/2018-11-12">Using SQLite with Node-RED on Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-05--nodered-cryptocurrency-dashboard/2018-11-05">Creating a Dashboard displaying Cryptocurrency Data using Node-RED</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-01--openhab2-mqtt-nodered/2018-11-01">Home Automation and IP Cameras</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-10-28--nodered-getting-started/2018-10-28">Getting Started with Node-RED (Windows 10 Edition)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/mqtt">MQTT</a><button aria-label="Toggle the collapsible sidebar category &#x27;MQTT&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/internet-of-things--machine-learning"><span itemprop="name">Internet-of-Things &amp; Machine Learning</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/home-automation"><span itemprop="name">Home Automation</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Zigbee Sensors in FHEM</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Zigbee Sensors in FHEM</h1></header><p><img loading="lazy" alt="Hongkong" src="/assets/images/photo-19194765263_69ad0f_o-3362aad2900cbbb31478efff6821a7c9.png" width="1500" height="633" class="img_ev3q"></p><ul><li><a href="#zigbee-communication-without-a-proprietary-hub">ZigBee Communication without a proprietary Hub</a><ul><li><a href="#setting-up-the-bridge">Setting up the bridge</a></li><li><a href="#running-the-bridge">Running the bridge</a><ul><li><a href="#determine-location-of-cc2531-usb-sniffer-and-checking-user-permissions">Determine location of CC2531 USB sniffer and checking user permissions</a></li><li><a href="#installation">Installation</a></li><li><a href="#configuration">Configuration</a></li><li><a href="#running-zigbee2mqtt">Running ZigBee2MQTT</a></li><li><a href="#running-zigbee2mqtt-as-a-daemon">Running ZigBee2MQTT as a Daemon</a></li><li><a href="#update-zigbee2mqtt-to-the-latest-version">Update zigbee2mqtt to the latest version</a></li></ul></li><li><a href="#pairing-devices">Pairing Devices</a></li></ul></li><li><a href="#adding-our-sensors-to-fhem">Adding our Sensors to FHEM</a></li><li><a href="#adding-sql-logging">Adding SQL Logging</a><ul><li><a href="#installing-mariadb-on-our-raspberry-pi">Installing MariaDB on our Raspberry Pi</a></li><li><a href="#configuring-mariadb-for-fhem">Configuring MariaDB for FHEM</a></li><li><a href="#log-filter">Log Filter</a></li><li><a href="#average--reduce">Average / Reduce</a></li></ul></li><li><a href="#compare-with-data-from-web-apis">Compare with Data from Web-APIs</a><ul><li><a href="#visualize-logs">Visualize Logs</a></li><li><a href="#add-the-mqtt-input-to-an-existing-flow">Add the MQTT input to an existing Flow</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="zigbee-communication-without-a-proprietary-hub">ZigBee Communication without a proprietary Hub<a class="hash-link" href="#zigbee-communication-without-a-proprietary-hub" title="Direct link to heading">​</a></h2><p>Zigbee is a specification for a suite of high-level communication protocols used to create personal area networks with small, low-power digital radios, such as for home automation, medical device data collection, and other low-power low-bandwidth needs, designed for small scale projects which need wireless connection. Hence, Zigbee is a low-power, low data rate, and close proximity wireless ad hoc network.</p><p>The <a href="https://github.com/Koenkk/zigbee2mqtt" target="_blank" rel="noopener noreferrer">Zigbee2MQTT</a> bridge enables you to use selected <a href="https://www.zigbee2mqtt.io/information/supported_devices.html" target="_blank" rel="noopener noreferrer">supported ZigBee devices</a> <strong>without the otherwise mandatory Hub and Vendor Cloud</strong> connection. Among the devices that you can control are smart (ZigBee) light bulbs from Belkin, IKEA, OSRAM and Philips as well as smart sensors from SmartThings and Xiaomi.</p><p>The ZigBee bridge consists of a <strong>ZigBee Sniffer Module</strong> and a controlling software written in <strong>Node.js</strong>. It bridges events and allows you to control your Zigbee devices via <strong>MQTT</strong>. In this way you can integrate your Zigbee devices with whatever smart home infrastructure you are using.</p><p><a href="https://www.zigbee2mqtt.io/getting_started/what_do_i_need.html" target="_blank" rel="noopener noreferrer">Needed Hardware</a>:</p><ul><li>CC debugger</li><li>CC2531 USB sniffer</li><li>Downloader cable CC2531</li><li>PC or Raspberry Pi to run bridge	</li></ul><p>The Debugger, Sniffer and connecting cable can be ordered directly through <a href="https://community.home-assistant.io/t/zigbee2mqtt-getting-rid-of-your-proprietary-zigbee-bridges-xiaomi-hue-tradfri/52108/193" target="_blank" rel="noopener noreferrer">online shops like AliExpress</a>.</p><p>The debugger and cable are only used once to flash the firmware onto the stick. There is alternative way to do that <a href="https://www.zigbee2mqtt.io/information/alternative_flashing_methods.html" target="_blank" rel="noopener noreferrer">using an Arduino board instead</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-the-bridge">Setting up the bridge<a class="hash-link" href="#setting-up-the-bridge" title="Direct link to heading">​</a></h3><ol><li>Install <a href="http://www.ti.com/tool/FLASH-PROGRAMMER" target="_blank" rel="noopener noreferrer">SmartRF Flash programmer</a> (<strong>NOT V2</strong>). This software is free but requires a Texas Instruments account in order to download.</li></ol><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/flash_00-9c3e2ce91ac113b5404151af6272035e.png" width="730" height="564" class="img_ev3q"></p><hr><ol start="2"><li>Install the <a href="http://www.ti.com/general/docs/lit/getliterature.tsp?baseLiteratureNumber=swrc212&amp;fileType=zip" target="_blank" rel="noopener noreferrer">CC debugger driver</a> on your PC (Windows only). Before continuing, verify that the CC Debugger driver has been installed correctly. In case the CC Debugger is not recognized correctly <a href="https://www.youtube.com/watch?v=jyKrxxXOvQY" target="_blank" rel="noopener noreferrer">install the driver manually</a>.</li></ol><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/driver_00-7ac3d349fb12ef14e032d29469608534.png" width="730" height="456" class="img_ev3q"></p><hr><ol start="3"><li>Connect <code>CC debugger</code> --&gt; <code>Downloader cable CC2531</code> --&gt; <code>CC2531 USB sniffer</code>.</li></ol><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/ccdebugger_00-70977fc8ac6a0c4ccf899fb423b96a86.png" width="730" height="405" class="img_ev3q"></p><hr><ol start="4"><li>Connect <strong>BOTH</strong> the <code>CC2531 USB sniffer</code> and the <code>CC debugger</code> to your PC using USB.</li><li>If the light on the CC debugger is RED press set reset button on the CC debugger. The light on the CC debugger should now turn GREEN. If not use <a href="http://www.ti.com/lit/ug/swru197h/swru197h.pdf" target="_blank" rel="noopener noreferrer">CC debugger user guide</a> to troubleshoot your problem. </li><li>Download and unzip the firmware <a href="https://github.com/Koenkk/Z-Stack-firmware/tree/master/coordinator/default/CC2531" target="_blank" rel="noopener noreferrer">CC2531ZNP-Prod.hex</a></li><li>Start SmartRF Flash Programmer, setup as shown below and press <code>Perform actions</code>. </li></ol><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/flash_01-417a62a9d19195d18e7c549ba0120d17.png" width="702" height="610" class="img_ev3q"></p><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/flash_02-763841217c45884845c12533e7974b83.png" width="702" height="612" class="img_ev3q"></p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-bridge">Running the bridge<a class="hash-link" href="#running-the-bridge" title="Direct link to heading">​</a></h3><p>After flashing your CC2531 USB sniffer with CC2531ZNP-Prod.hex firmware we can remove the CC Debugger and connecting cable and plug the Sniffer into our Linux computer you can use a <strong>Raspberry Pi 3</strong> with <strong>Raspbian Stretch Lite</strong>, but will work on any Linux machine.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="determine-location-of-cc2531-usb-sniffer-and-checking-user-permissions">Determine location of CC2531 USB sniffer and checking user permissions<a class="hash-link" href="#determine-location-of-cc2531-usb-sniffer-and-checking-user-permissions" title="Direct link to heading">​</a></h4><p>We first need to determine the location of the CC2531 USB sniffer. Connect the CC2531 USB to your Raspberry Pi. Most of the times the location of the CC2531 is <code>/dev/ttyACM0</code>. This can be verified by:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"> -l /dev/ttyACM0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">crw-rw---- </span><span class="token number">1</span><span class="token plain"> root dialout </span><span class="token number">166</span><span class="token plain">, </span><span class="token number">0</span><span class="token plain"> Apr </span><span class="token number">21</span><span class="token plain"> </span><span class="token number">13</span><span class="token plain">:14 /dev/ttyACM0  </span><span class="token comment" style="color:rgb(98, 114, 164)"># &lt;-- CC2531 on /dev/ttyACM0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="data:image/png;base64,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" width="728" height="35" class="img_ev3q"></p><hr><p>As an alternative, the device can also be mapped by an ID. This can be handy if you have multiple serial devices connected to your pi. In the example below the device location is: <code>/dev/serial/by-id/usb-Texas_Instruments_TI_CC2531_USB_CDC___0X00124B0018E32D5B-if00</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"> -l /dev/serial/by-id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lrwxrwxrwx </span><span class="token number">1</span><span class="token plain"> root root </span><span class="token number">13</span><span class="token plain"> Apr </span><span class="token number">21</span><span class="token plain"> </span><span class="token number">13</span><span class="token plain">:14 usb-Texas_Instruments_TI_CC2531_USB_CDC___0X00124B0018ED113B-if00 -</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">/ttyACM0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_02-82d6f9858274d4f4c94991e74578032c.png" width="732" height="59" class="img_ev3q"></p><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a class="hash-link" href="#installation" title="Direct link to heading">​</a></h4><p>To use ZigBee2MQTT we first need to install Node.js and Git:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can confirm that you have installed Git and Node correctly by running the following commands:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> --version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">node</span><span class="token plain"> -v</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="data:image/png;base64,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" width="731" height="63" class="img_ev3q"></p><hr><p>Then clone <a href="https://github.com/Koenkk/zigbee2mqtt" target="_blank" rel="noopener noreferrer">ZigBee2MQTT from Github</a> and change the owner of the <code>/opt/zigbee2mqtt</code> directory to your default Linux user - in our case this is <code>nodeadmin</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> clone https://github.com/Koenkk/zigbee2mqtt.git /opt/zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">chown</span><span class="token plain"> -R pi:pi /opt/zigbee2mqtt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then change into the directory and use <code>npm</code> to install all dependencies:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> /opt/zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_04-8c492f6ff1078999d56c6d319eeaed3e.png" width="730" height="230" class="img_ev3q"></p><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">​</a></h4><p>Before we can start zigbee2mqtt we need to edit the configuration.yaml file. This file contains the configuration which will be used by zigbee2mqtt. Open the configuration file:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">nano</span><span class="token plain"> /opt/zigbee2mqtt/data/configuration.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_05-83bb56213a7de46aa190577818335d67.png" width="732" height="318" class="img_ev3q"></p><hr><p>I am going to use a local Mosquitto MQTT server running on a INSTAR Full HD Camera on <em>192.168.2.115</em>. Alternatively, you can install a <a href="https://wiki.instar.comhttps://wiki.instar.com/en/Software/Linux/Node-RED/#installing-mosquitto" target="_blank" rel="noopener noreferrer">local Mosquitto Server</a> on your Raspberry Pi and add it via <code>server: &#x27;mqtt://localhost&#x27;</code> in the config file.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Home Assistant integration (MQTT discovery)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">homeassistant</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># allow new devices to join</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">permit_join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># MQTT settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">mqtt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># MQTT base topic for zigbee2mqtt MQTT messages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">base_topic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># MQTT server URL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;mqtt://192.168.2.115&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># MQTT server authentication, uncomment if required:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># user: my_user</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># password: my_password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Serial settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">serial</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Location of CC2531 USB sniffer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> /dev/ttyACM0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I am not sure if Zigbee2MQTT offer TLS support - I will have to look into that. Also, I deactivated the user authentication on my MQTT server for now to have an easier time debugging - user name and password have to be added here before reactivating it.</p><p>Make sure that <code>permit_join</code> is set to <code>true</code>, to allow new devices to be added. It can be set to <code>false</code> once all your Zigbee devices are integrated.</p><p>For the serial port you can use the <a href="#determine-location-of-cc2531-usb-sniffer-and-checking-user-permissions">location of CC2531 USB sniffer</a> that we determined to be either <code>/dev/ttyACM0</code> or <code>/dev/serial/by-id/usb-Texas_Instruments_TI_CC2531_USB_CDC___0X00124B0018ED113B-if00</code> - both can be used interchangeably (the location might differ in your case!).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="running-zigbee2mqtt">Running ZigBee2MQTT<a class="hash-link" href="#running-zigbee2mqtt" title="Direct link to heading">​</a></h4><p>Now that we have setup everything correctly we can start zigbee2mqtt directly from our console to see if there are any error messages:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> /opt/zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">npm</span><span class="token plain"> start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should see the status LED on your CC2531 light up green and hopefully a friendly console log like this:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_06-2c53a882296d8292ead0e5e293613bda.png" width="729" height="362" class="img_ev3q"></p><hr><p>You can see that the service is running, connected to the local MQTT server and published a message to <code>zigbee2mqtt/bridge/state</code> with the payload <code>online</code>. We can use the program <a href="https://github.com/thomasnordquist/MQTT-Explorer" target="_blank" rel="noopener noreferrer">MQTT Explorer</a> to verify that the message was received by our Mosquitto server:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_07-1cb3b391f9bd233c1bfde6a57403287e.png" width="730" height="295" class="img_ev3q"></p><hr><p>Looks like we were successful!</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="running-zigbee2mqtt-as-a-daemon">Running ZigBee2MQTT as a Daemon<a class="hash-link" href="#running-zigbee2mqtt-as-a-daemon" title="Direct link to heading">​</a></h4><p>To run zigbee2mqtt as a service and start it automatically on boot we will run zigbee2mqtt with <code>systemctl</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">nano</span><span class="token plain"> /etc/systemd/system/zigbee2mqtt.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Add the following to this file to automatically run the <code>index.js</code> file from the <code>zigbee2mqtt</code> bridge inside the Node runtime:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Description=zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">After=network.target</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ExecStart=/usr/bin/node /opt/zigbee2mqtt/index.js</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">StandardOutput=syslog</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">StandardError=syslog</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SyslogIdentifier=zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Restart=always</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> # Restart service after 10 seconds if node service crashes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> RestartSec=10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WantedBy=multi-user.target</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_08-bb57aa3cbee7c495e4cec1c337d93e54.png" width="732" height="250" class="img_ev3q"></p><hr><p>Save the file, exit and verify that the configuration works:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> systemctl daemon-reload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> systemctl start zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemctl status zigbee2mqtt.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_09-b1a8ca76d8255bc3ac057fe0f66104be.png" width="731" height="185" class="img_ev3q"></p><hr><p>Now that everything works, we want <code>systemctl</code> to start <code>zigbee2mqtt</code> automatically on boot, this can be done by executing:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo systemctl enable zigbee2mqtt.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="data:image/png;base64,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" width="732" height="44" class="img_ev3q"></p><hr><p>To stop, restart or check the log of our service run the following commands:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Stopping zigbee2mqtt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> systemctl stop zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Starting zigbee2mqtt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> systemctl start zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># View the log of zigbee2mqtt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> journalctl -u zigbee2mqtt.service -f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="update-zigbee2mqtt-to-the-latest-version">Update zigbee2mqtt to the latest version<a class="hash-link" href="#update-zigbee2mqtt-to-the-latest-version" title="Direct link to heading">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Stop zigbee2mqtt and go to directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> systemctl stop zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> /opt/zigbee2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Backup configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cp</span><span class="token plain"> -R data data-backup</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Update</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> checkout HEAD -- npm-shrinkwrap.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> pull</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">rm</span><span class="token plain"> -rf node_modules</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Restore configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cp</span><span class="token plain"> -R data-backup/* data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">rm</span><span class="token plain"> -rf data-backup</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start zigbee2mqtt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> systemctl start zigbee2mqtt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pairing-devices">Pairing Devices<a class="hash-link" href="#pairing-devices" title="Direct link to heading">​</a></h3><p>The <a href="https://www.zigbee2mqtt.io/information/supported_devices.html" target="_blank" rel="noopener noreferrer">number of devices that you can use with the zigbee2mqtt bridge</a> is steadily growing (there are alternative <a href="https://www.zigbee2mqtt.io/getting_started/pairing_devices.html" target="_blank" rel="noopener noreferrer">pairing instructions available here</a>). In this tutorial we are going to add 3 <a href="https://xiaomi-mi.com/sockets-and-sensors/" target="_blank" rel="noopener noreferrer">XiaoMi Mi Home</a> sensors - a <a href="https://xiaomi-mi.com/sockets-and-sensors/xiaomi-mi-temperature-humidity-sensor/" target="_blank" rel="noopener noreferrer">Temperature &amp; Humidity Sensor</a>, a <a href="https://xiaomi-mi.com/sockets-and-sensors/xiaomi-mi-wireless-switch/" target="_blank" rel="noopener noreferrer">Wireless Switch</a> and a <a href="https://xiaomi-mi.com/sockets-and-sensors/xiaomi-mi-occupancy-sensor/" target="_blank" rel="noopener noreferrer">Home Occupancy Sensor</a>.</p><p><strong>IMPORTANT</strong>: Before you start, make sure that <a href="#configuration">permit_join: true</a> is set in your <code>configuration.yaml</code>. Otherwise new devices cannot join the network! Also verify that the <a href="#running-zigbee2mqtt-as-a-daemon">ZigBee2MQTT Bridge is running</a>.</p><p>We first start with the <strong>Temperature &amp; Humidity Sensor</strong> that has a pairing button on its side. Press the button for about 5 seconds - the <strong>blue LED will start to blink</strong>: in my case it started to blink slowly in 3-time sequences. After a few seconds the blinking sped up and stopped and the device was paired with the ZigBee Bridge.</p><p>The pairing can be found inside a log file in <code>/opt/zigbee2mqtt/data/log/</code>:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:34:17 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> New device &#x27;undefined&#x27; with address 0x00158d00023a21c8 connected</span><span class="token tag" style="color:rgb(255, 121, 198)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:34:17 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/bridge/log&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;type&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;device_connected&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;message&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0x00158d00023a21c8&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;meta&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:34:17 PM - warn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Device with modelID &#x27;undefined&#x27; is not supported.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:34:17 PM - warn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">Please see</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//www.zigbee2mqtt.io/how_tos/how_to_support_new_devices.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:34:17 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/0x00158d00023a21c8&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">29.63</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">134</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:34:17 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/0x00158d00023a21c8&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">29.63</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">134</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;humidity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">60.12</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:35:05 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/0x00158d00023a21c8&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">29.12</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">134</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;humidity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">60.12</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:35:05 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/0x00158d00023a21c8&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">29.12</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">134</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;humidity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">57.13</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:35:08 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Device incoming</span><span class="token punctuation" style="color:rgb(248, 248, 242)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:35:08 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/bridge/log&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;type&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pairing&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;message&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;device incoming&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Shortly afterwards the sensor data started coming in:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_11-6ad13c0824847078292634f30513c468.png" width="730" height="364" class="img_ev3q"></p><hr><p>So far so good. But the <strong>device ID</strong> was a bit hard to read and memorize: <code>0x00158d00023a21c8</code>. Luckily this can be adjusted in <code>/opt/zigbee2mqtt/data/configuration.yaml</code>:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_12-fe95e32fe09d968255aacfb9f62a376d.png" width="732" height="195" class="img_ev3q"></p><hr><p>All paired devices will be listed at the bottom of the configuration file - just change the <code>friendly_name</code> to something human-readable. Remember that this will also change the MQTT topic the Zigbee bridge is using to publish the sensor readouts:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;zigbee2mqtt/temp_hum_sensor&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">payload</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;{&quot;temperature&quot;:26.33,&quot;linkquality&quot;:78,&quot;humidity&quot;:54.32,&quot;battery&quot;:99,&quot;voltage&quot;:3005}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The topic changed from <code>zigbee2mqtt/0x00158d00023a21c8</code> to <code>zigbee2mqtt/temp_hum_sensor</code>! <strong>Note</strong>: I thought I remembered that this worked without restarting the service - but this time it was necessary to do that ¯<!-- -->\<em>(ツ)</em>\/¯</p><p>But pairing both the <strong>Wireless Switch</strong> and <strong>Home Occupancy Sensor</strong> turned out to be more difficult. Holding the pairing button - that here could only be reached with a metal pin - gave the same pattern. The <strong>blue LED started flashing</strong> - first slowly, then fast. But I kept getting timeouts for both devices - that identified as <code>0x00158d00023d229c</code> and <code>0x00158d00020b3dff</code> - for the pairing process inside the <code>/opt/zigbee2mqtt/data/log/</code></p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">Cannot get the Node Descriptor of the Device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">0x00158d00023d229c (Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Timed out after 10000 ms)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">Cannot get the Node Descriptor of the Device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">0x00158d00020b3dff (Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Timed out after 10000 ms)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can <a href="https://www.zigbee2mqtt.io/getting_started/pairing_devices.html" target="_blank" rel="noopener noreferrer">find an instruction</a> that you need to press and hold the pairing button for 5 seconds (until the blue LED starts flashing), then release and keep pressing the button repeatedly (1s interval) afterwards - which feels a little bit counter-intuitive. But it actually works. Checking the log file shows that a <strong>Occupancy Sensor</strong> with the ID <code>0x00158d00020b3dff</code> was connected:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:55:03 PM - warn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Device with modelID &#x27;undefined&#x27; is not supported.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:55:03 PM - warn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">Please see</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//www.zigbee2mqtt.io/how_tos/how_to_support_new_devices.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:55:41 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Device incoming</span><span class="token punctuation" style="color:rgb(248, 248, 242)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:55:41 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/bridge/log&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;type&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pairing&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;message&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;device incoming&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:55:49 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/0x00158d00020b3dff&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;occupancy&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token boolean important">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Repeating the same for the <strong>Wireless Switch</strong> and a new device with ID <code>0x00158d00023d229c</code> showed up - excellent!</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:50:57 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> New device &#x27;undefined&#x27; with address 0x00158d00023d229c connected</span><span class="token tag" style="color:rgb(255, 121, 198)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:50:57 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/bridge/log&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;type&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;device_connected&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;message&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0x00158d00023d229c&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;meta&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:50:57 PM - warn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Device with modelID &#x27;undefined&#x27; is not supported.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:50:57 PM - warn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">Please see</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//www.zigbee2mqtt.io/how_tos/how_to_support_new_devices.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:50:58 PM - warn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Device with modelID &#x27;undefined&#x27; is not supported.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:50:58 PM - warn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">Please see</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//www.zigbee2mqtt.io/how_tos/how_to_support_new_devices.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:51:28 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/0x00158d00023d229c&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;click&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;single&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">102</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p> Again, we can adjust that a human-readable name is displayed instead of the ID in <code>/opt/zigbee2mqtt/data/configuration.yaml</code>:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">&#x27;0x00158d00023a21c8&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">friendly_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;temp_hum_sensor&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">retain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">&#x27;0x00158d00023d229c&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">friendly_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;smart_button&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">retain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">&#x27;0x00158d00020b3dff&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">friendly_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;motion_pir_sensor&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">retain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The new names will now be used for the corresponding MQTT topics:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:55:49 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/motion_pir_sensor&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;occupancy&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token boolean important">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:57:19 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/motion_pir_sensor&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;occupancy&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token boolean important">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:59:11 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/temp_hum_sensor&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">26.55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">141</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;humidity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">60.77</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">3:59:12 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/temp_hum_sensor&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">26.55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">141</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;humidity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">54.63</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">4:00:10 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/smart_button&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;duration&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">835</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;click&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;single&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">4:00:17 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/smart_button&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">102</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;duration&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">835</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;click&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;double&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">4:00:19 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/smart_button&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;duration&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">835</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;click&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;triple&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">4:00:20 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/smart_button&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">102</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;duration&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">835</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;click&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;quadruple&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">4:00:23 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/smart_button&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;duration&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">835</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;click&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;long&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">4:00:24 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/smart_button&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;duration&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">1094</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;click&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;long_release&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">4:00:30 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/motion_pir_sensor&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;occupancy&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token boolean important">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">4:00:30 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/temp_hum_sensor&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">27.73</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">141</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;humidity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">54.63</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4/22/2019</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">4:00:30 PM - info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token key atrule">MQTT publish</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> topic &#x27;zigbee2mqtt/temp_hum_sensor&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> payload &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">27.73</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;linkquality&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">141</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">&quot;humidity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">69.32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that the <strong>Occupancy Sensor</strong> sends a <code>true</code> or <code>false</code> payload depending on if motion was detected or not. The <strong>Temperature &amp; Humidity Sensor</strong> just sends number values for temperature and humidity. And the <strong>Wireless Button</strong> sends click events and can discern between <code>single</code>, <code>double</code>, <code>triple</code>, <code>quadruple</code> and <code>long / long_release</code> clicks.</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_13-22dd18004ead4ac6c607c7272585ca0d.png" width="730" height="383" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-our-sensors-to-fhem">Adding our Sensors to FHEM<a class="hash-link" href="#adding-our-sensors-to-fhem" title="Direct link to heading">​</a></h2><p>First we need to add a <a href="https://github.com/oskarn97/fhem-xiaomi-mqtt" target="_blank" rel="noopener noreferrer">new module</a> to FHEM that allows us to communicate with our Zigbee2MQTT Bridge:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">update </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> https://raw.githubusercontent.com/oskarn97/fhem-xiaomi-mqtt/master/controls_xiaomi-zb2mqtt.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">update check xiaomi-zb2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">update all xiaomi-zb2mqtt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">shutdown</span><span class="token plain"> restart</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_14-6afa245bb887b4068aeba0ae74b6ca14.png" width="730" height="159" class="img_ev3q"></p><hr><p>Once FHEM is back up we can define the bridge module that will handle the communication for us:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">define ZigbeeBridge XiaomiMQTTDevice bridge</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Just a few seconds later we already start seeing readings coming in:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_15-9d31ed57d4361a3d0a62d4c9a431c5f7.png" width="844" height="851" class="img_ev3q"></p><hr><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;devices&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;message&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;ieeeAddr&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0x00124b0018ed113b&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Coordinator&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;ieeeAddr&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0x00158d00023a21c8&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;EndDevice&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;model&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;WSDCGQ01LM&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;friendly_name&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;temp_hum_sensor&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;nwkAddr&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">29097</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;manufId&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">4151</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;manufName&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;LUMI&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;powerSource&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Battery&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;modelId&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;lumi.sens&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;ieeeAddr&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0x00158d00023d229c&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;EndDevice&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;model&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;WXKG01LM&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;friendly_name&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;smart_button&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;nwkAddr&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">40807</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;manufId&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">4151</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;manufName&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;LUMI&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;powerSource&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Battery&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;modelId&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;lumi.sensor_switch&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;ieeeAddr&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0x00158d00020b3dff&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;EndDevice&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;model&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;RTCGQ01LM&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;friendly_name&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;motion_pir_sensor&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;nwkAddr&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">2091</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;manufId&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">4151</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;manufName&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;LUMI&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;powerSource&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Battery&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;modelId&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;lumi.sensor_motion&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Our sensors have been recognized through the FHEM connector - nice! And we have a new <em>Room</em> in our list called <strong>XiaoMiMQTTDevice</strong> holding all our sensors:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_16-435e03a61ee33e39fbf8d023b282358d.png" width="730" height="273" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-sql-logging">Adding SQL Logging<a class="hash-link" href="#adding-sql-logging" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-mariadb-on-our-raspberry-pi">Installing MariaDB on our Raspberry Pi<a class="hash-link" href="#installing-mariadb-on-our-raspberry-pi" title="Direct link to heading">​</a></h3><p>We will start by installing the MariaDB (<em>MySQL</em>) Client and Server. Additionally, we need two Perl packages to be able to connect FHEM to the DB Client:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> mysql-server mysql-client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> libdbi-perl libclass-dbi-mysql-perl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This should install and start your MariaDB instance. We can now continue to configure our database. By default the database can only be accessed by localhost - this might be perfectly fine (and is the secure option), but if you want to be able to access data on your Raspberry Pi from different computers we have to comment out the line <code>bind-address = 127.0.0.1</code> inside:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">nano</span><span class="token plain"> /etc/mysql/mariadb.conf.d/50-server.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_17-6744d6329008333b1f04c16ac49131a3.png" width="731" height="450" class="img_ev3q"></p><hr><p>We can now enter our database with the following command (just press enter when asked for a password):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo mysql -u root -p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We will assign a new root password with the first line (see below - change the &#x27;instar&#x27; string with your real password):</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ON</span><span class="token plain"> </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TO</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;root&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">@&#x27;%&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;instar&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">USAGE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ON</span><span class="token plain"> </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TO</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;root&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">@&#x27;%&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WITH</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">OPTION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For those change to take affect we now need to restart our SQL server <code>sudo service mysql restart</code>.</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_18-051f387de6976180acf4e6ff9de99d79.png" width="733" height="281" class="img_ev3q"></p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-mariadb-for-fhem">Configuring MariaDB for FHEM<a class="hash-link" href="#configuring-mariadb-for-fhem" title="Direct link to heading">​</a></h3><p>We can now use a SQL Client, e.g. <a href="https://sqlectron.github.io/#gui" target="_blank" rel="noopener noreferrer">SQLElectron-GUI</a> to further configure our database.</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_19-64d89a97332d09ec96788b662d98d7d5.png" width="730" height="499" class="img_ev3q"></p><hr><p>We are going to create a database called <code>fhem</code> as well as a user <code>fhemuser</code> with the login <code>instar</code> (change all of those at will) that will be used for our FHEM-generated data:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DATABASE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">fhem</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CHARACTER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SET</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">utf8</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">USER</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;fhemuser&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">@&#x27;%&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;instar&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">REVOKE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ROUTINE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VIEW</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">USER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ALTER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SHOW</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VIEW</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ALTER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ROUTINE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> EVENT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SUPER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">INSERT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> RELOAD</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DELETE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FILE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SHOW</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DATABASES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TRIGGER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SHUTDOWN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">REPLICATION</span><span class="token plain"> CLIENT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">OPTION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> PROCESS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">REFERENCES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UPDATE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DROP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">REPLICATION</span><span class="token plain"> SLAVE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">EXECUTE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">LOCK</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TEMPORARY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">INDEX</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ON</span><span class="token plain"> </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;fhemuser&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">@&#x27;%&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UPDATE</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">user</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SET</span><span class="token plain"> max_questions </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> max_updates </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> max_connections </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">User</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;fhemuser&#x27;</span><span class="token plain"> </span><span class="token operator">AND</span><span class="token plain"> Host </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;%&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ROUTINE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VIEW</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ALTER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SHOW</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VIEW</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ALTER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ROUTINE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> EVENT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">INSERT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DELETE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TRIGGER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">OPTION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">REFERENCES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UPDATE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DROP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">EXECUTE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">LOCK</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TEMPORARY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">INDEX</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ON</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">fhem</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TO</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;fhemuser&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">@&#x27;%&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">USE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">fhem</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">history</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TIMESTAMP</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">timestamp</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CURRENT_TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ON</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UPDATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CURRENT_TIMESTAMP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">DEVICE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TYPE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">EVENT</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">512</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">READING</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">VALUE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">255</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">UNIT</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">KEY</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">IDX_HISTORY</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">DEVICE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">READING</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TIMESTAMP</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">VALUE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">KEY</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">DEVICE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">DEVICE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">READING</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">current</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TIMESTAMP</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">timestamp</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CURRENT_TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ON</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UPDATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CURRENT_TIMESTAMP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">DEVICE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TYPE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">EVENT</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">512</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">READING</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">VALUE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">255</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">UNIT</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_20-be6ba2556f9d92ed8abb16e04acea3d2.png" width="730" height="468" class="img_ev3q"></p><hr><p>When successful, this will have created a database with the name <code>fhem</code> and two tables called <code>current</code> and <code>history</code> (For me the new table did not show up in SQLElecton right away after it was created. I disconnected, edited the database entry - see 2 screenshots up - and set the <code>Initial Database</code> to <code>fhem</code>. After reconnecting everything looked as it should):</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_21-4fdde281597a3fbb4927d7938dcc1e9d.png" width="730" height="533" class="img_ev3q"></p><hr><p>Let&#x27;s now add our database to FHEM. We do this by copying the <code>db.conf</code> template to the FHEM root directory and editing the MySQL section:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cp</span><span class="token plain"> /opt/fhem/contrib/dblog/db.conf /opt/fhem/db.conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">chown</span><span class="token plain"> fhem:dialout /opt/fhem/db.conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">nano</span><span class="token plain"> /opt/fhem/db.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_22-b580774a83455fe946a6de8a29547b1a.png" width="730" height="275" class="img_ev3q"></p><hr><div class="language-perl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-perl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">%dbconfig= (</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    connection =&gt; &quot;mysql:database=fhem;host=localhost;port=3306&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    user =&gt; &quot;fhemuser&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    password =&gt; &quot;instar&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    # optional enable(1) / disable(0) UTF-8 support (at least V 4.042 is necessary)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    utf8 =&gt; 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now all we have to do is to tell FHEM to read the configuration file and start using our database setup to store all events:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">define DBLogging DbLog /opt/fhem/db.conf .*:.*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_23-15da2a25d4823b902c7ad5b6df2d496e.png" width="730" height="572" class="img_ev3q"></p><hr><p>And don&#x27;t forget to the set the <strong>DBLogType</strong> to <code>Current/History</code> (see bottom of the screenshot above). We can verify that the logging has started by querying the content of our <strong>Current Table</strong>:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">current</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_24-147abac3005892c832eec215f54c923d.png" width="730" height="642" class="img_ev3q"></p><hr><p>To make sure that the connection with your database is re-established if for whatever reason it fails, run the following command in FHEM: <code>define DBLogging_Reopen at +*00:15:00 set DBLogging reopen</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-filter">Log Filter<a class="hash-link" href="#log-filter" title="Direct link to heading">​</a></h3><p>We set up FHEM to log every event, which quickly leads to a huge pile of - mostly useless - data. You can check your current history with the followinf command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">SELECT DEVICE, COUNT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> FROM </span><span class="token function" style="color:rgb(80, 250, 123)">history</span><span class="token plain"> GROUP BY DEVICE ORDER BY </span><span class="token number">2</span><span class="token plain"> DESC</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_25-b0a5a7cb339b0301e68e9d13baa1b228.png" width="730" height="506" class="img_ev3q"></p><hr><p>In my case only the temperature/humidity sensor and motion detector generates data that I want to use in later projects - the rest should be excluded. For this, we can go back to our DBLogging device in FHEM - <code>http://&lt;RaspiIP&gt;:8083/fhem?detail=DBLogging</code> and change the default <strong>DbLogSelectionMode</strong> to <code>Exclude/Include</code>:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_26-28962af0930b1226f426d9ceb13eb7b7.png" width="730" height="108" class="img_ev3q"></p><hr><ul><li><strong>Exclude</strong>: DbLog behaves just as usual. This means everything specified in the regex in DEF will be logged by default and anything excluded via the DbLogExclude attribute will not be logged</li><li><strong>Include</strong>: Nothing will be logged, except the readings specified via regex in the DbLogInclude attribute (in source devices). Neither the Regex set in DEF will be considered nor the device name of the source device itself.</li><li><strong>Exclude/Include</strong>: Just almost the same as Exclude, but if the reading matches the DbLogExclude attribute, then it will further be checked against the regex in DbLogInclude whicht may possibly re-include the already excluded reading.</li></ul><p>That means with <code>Exclude/Include</code> selected for our logging service we can now edit every device that is generating log entries and <code>set attr &lt;name&gt; DbLogExclude .*</code>:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_29-82697eef96df5ee2f4727c9ff79db523.png" width="730" height="314" class="img_ev3q"></p><hr><p>The regular expression <code>.*</code> includes everything and so nothing is logged anymore. <strong>Note</strong>: If you already have many devices included, simply use the following command to set this attribute for all your devices: <code>attr .* DbLogExclude .*</code>. To automate this for future devices use the following <em>notify</em> function:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">define n_DbLogExclude notify global:DEFINED.* attr </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$EVTPART1</span><span class="token plain"> DbLogExclude .*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In a second step we can go in and use <code>set attr &lt;name&gt; DbLogInclude &lt;variable&gt;</code> to include selected variables for our log:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_30-d49693af7f6b998c53127293c7d9aa6a.png" width="730" height="375" class="img_ev3q"></p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="average--reduce">Average / Reduce<a class="hash-link" href="#average--reduce" title="Direct link to heading">​</a></h3><p>Additionally FHEM offers a Log reduction function that allows us to average every event that is older then n-days to only 1 event per hour:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">name</span><span class="token operator">&gt;</span><span class="token plain"> reduceLogNbl </span><span class="token operator">&lt;</span><span class="token plain">n</span><span class="token operator">&gt;</span><span class="token plain"> average</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we want to keep our data for 3 months this would be <code>set DBLogging reduceLogNbl 90 average</code>:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_27-07a738697f309266f352ad9fc0944dea.png" width="730" height="538" class="img_ev3q"></p><hr><p>We can automate this in FHEM with:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">define at_DbLoggingReduce at *04:30:00 </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> DBLogging reduceLogNbl </span><span class="token number">90</span><span class="token plain"> average</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_28-7eeb0fe5ae86e80b293465f68cc5b708.png" width="730" height="628" class="img_ev3q"></p><hr><p>You can further reduce your data logs for entries older then 24hrs:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">define DBLogging_Reduce at +*24:00:00 </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> DBLogging reduceLog </span><span class="token number">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="compare-with-data-from-web-apis">Compare with Data from Web-APIs<a class="hash-link" href="#compare-with-data-from-web-apis" title="Direct link to heading">​</a></h2><p>I now have a reading for the temperature inside my office - and might add a few more temperature sensors in the future. But it would be interesting to see how well the temperatures I measure fit the temperatures I can get from an online weather services like <a href="https://darksky.net/forecast/22.5446,114.0545/si12/en" target="_blank" rel="noopener noreferrer">DarkSky.net</a>. Click the link and select your city - you will find the coordinates that DarkSky assigns to your location inside the URL - in case of Shenzhen, China this is <code>22.5446,114.0545</code>:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_31-57c4ddf772e548a3cbbff2741f9a9b68.png" width="733" height="509" class="img_ev3q"></p><hr><p>Once we know our ID we can start using the integrated weather module in FHEM to query the corresponding information for our location. Just make sure that your Raspberry Pi has the following Perl libraries installed so FHEM knows how to handle the API&#x27;s JSON response (<code>shutdown restart</code> FHEM after the installation was successful):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt</span><span class="token plain"> -y </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> libjson-perl libdatetime-format-strptime-perl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The command to add a weather device in FHEM then looks like this:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">define </span><span class="token operator">&lt;</span><span class="token plain">name</span><span class="token operator">&gt;</span><span class="token plain"> Weather </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">API</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token plain">API</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">,</span><span class="token operator">&lt;</span><span class="token plain">apioptions</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">apikey</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token plain">apikey</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">location</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token plain">location</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">interval</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token plain">interval</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">lang</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token plain">lang</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For me this results to <code>define ShenZhenWeather Weather API=DarkSkyAPI,cachemaxage:600 apikey=09878945fdskv876 location=22.5446,114.0545 interval=3600 lang=en</code>. <strong>Note</strong>: the API key inside this command does not work - you have to get your own free key by <a href="https://darksky.net/dev" target="_blank" rel="noopener noreferrer">registering with DarkSky</a>.</p><p>You should see your first reading coming in a few seconds later:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_32-6a23fece225162ce3c0d64c7598f1aae.png" width="730" height="663" class="img_ev3q"></p><hr><p>We can also output the data for a 7 day forecast on our FHEM interface by defining an HTML output:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">define ShenZhenWeatherHtml weblink htmlCode </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">WeatherAsHtml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ShenZhenWeatherHtml&quot;</span><span class="token plain">,7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_34-90eec18362b57f14524bd44d18c4f42c.png" width="730" height="418" class="img_ev3q"></p><hr><p>We can now reduce the amount of variables that we record by using <code>event-on-update-reading</code>, so by the next update I only receive (and log - see <code>DbLogInclude</code>) the following:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_35-89083b0787563a9a279ad8e2e1f52a0f.png" width="730" height="433" class="img_ev3q"></p><hr><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">apparentTemperature,cloudCover,condition,humidity,ozone,pressure,temp_c,uvIndex,visibility,wind,windGust,wind_direction</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_36-6cc079c32f494ef9ff877eaa7da8253b.png" width="730" height="267" class="img_ev3q"></p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="visualize-logs">Visualize Logs<a class="hash-link" href="#visualize-logs" title="Direct link to heading">​</a></h3><p>We can quickly write the API response to a log file:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">define FileLog_ShenZhenWeather FileLog ./log/ShenZhenWeather-%Y.log ShenZhenWeather</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can check that the file is written with <code>cat /opt/fhem/log/ShenZhenWeather-2019.log</code>.</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_33-8c501915614d270cddee2e127919fb47.png" width="730" height="267" class="img_ev3q"></p><hr><p>We can now use the integrated plot function to create a little SVG plot for our log:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_37-162d260d3de5d3a3863e6bf4aaef756f.png" width="730" height="491" class="img_ev3q"></p><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_38-783ca116cbf3b1df8faf2c78b544c48c.png" width="730" height="587" class="img_ev3q"></p><hr><p>Generating the plot will add received data points to your plot. You can adjust the axis range and highlight colours to your need.</p><p>Going back to the <strong>ShenZhenWeather</strong> log definition, we can now also add the temperature and humidity reading from our XiaoMi sensor to the same log file:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_39-0494f3251ad37a63f194df1a347f5613.png" width="730" height="338" class="img_ev3q"></p><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_40-182af11e186b2dd70518c5d03c373055.png" width="730" height="89" class="img_ev3q"></p><hr><p>And then go and add it to our plot - voilá :</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_41-8369d7b55f28e7339cd72a3f65a841e2.png" width="730" height="634" class="img_ev3q"></p><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_42-4682465a6dfa107d4e1c0e2b6fc88908.png" width="730" height="626" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-zigbee-devices-to-control-instar-ip-cameras-in-node-red">Using Zigbee Devices to control INSTAR IP Cameras in Node-RED<a class="hash-link" href="#using-zigbee-devices-to-control-instar-ip-cameras-in-node-red" title="Direct link to heading">​</a></h2><p>We now set up the Zigbee Bridge, connected Zigbee sensors and made sure that the messages are send to our Mosquitto MQTT server. We also found out the topics that our bridge uses for each sensors to publish its messages - <code>zigbee2mqtt/motion_pir_sensor</code>, <code>zigbee2mqtt/temp_hum_sensor</code> and <code>zigbee2mqtt/smart_button</code> - and what kind of payload to expect.</p><p>Now we can use the program <a href="https://wiki.instar.com/en/Advanced_User/OpenHAB_Home_Automation/Mosquitto_Installation_on_Windows/#testing-the-mqtt-server-with-mqttfx" target="_blank" rel="noopener noreferrer">MQTT.fx</a> to verify that the message was received by our Mosquitto server:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_x11-a43f050388c51df578b8ccc739675ebd.png" width="730" height="427" class="img_ev3q"></p><hr><p>Every time the state changes the sensor will send a Zigbee message to our Bridge, which then forwards its payload to our Mosquitto server - perfect!</p><p>We can now start our <a href="https://nodered.org/" target="_blank" rel="noopener noreferrer">Node-RED</a> - that we either installed under <a href="https://wiki.instar.com/en/Advanced_User/Node-RED_and_MQTT/" target="_blank" rel="noopener noreferrer">Windows 10</a>, on a <a href="https://wiki.instar.com/enhttps://wiki.instar.com/en/Advanced_User/openHABian_on_Raspberry_Pi/Node-RED_Setup/" target="_blank" rel="noopener noreferrer">Raspberry Pi</a> or a <a href="https://wiki.instar.com/en/Software/Linux/Node-RED/" target="_blank" rel="noopener noreferrer">Debian Linux Server</a>, add <strong>MQTT Nodes</strong> and subscribe to all 3 MQTT topics:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_x12-51b4a8b987fc8c4d2f411f8ec6a44d6c.png" width="730" height="339" class="img_ev3q"></p><hr><p>Connect all 3 of them to a <strong>Debug Node</strong> and deploy the flow. Click the button, warm up the temp sensor and trigger the motion detection - the MQTT messages will show up in the debug pane in Node-RED:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_13-22dd18004ead4ac6c607c7272585ca0d.png" width="730" height="383" class="img_ev3q"></p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-the-mqtt-input-to-an-existing-flow">Add the MQTT input to an existing Flow<a class="hash-link" href="#add-the-mqtt-input-to-an-existing-flow" title="Direct link to heading">​</a></h3><p>In the following sequence we are using the input for the wireless button to switch <strong>Alarm Areas</strong> on our cameras - we already used the same sequence for the <a href="https://wiki.instar.com/en/Advanced_User/Alexa_Voice_Control_without_Cloud/" target="_blank" rel="noopener noreferrer">Amazon Alexa Integration</a> (the complete flow can be found in the <a href="https://wiki.instar.com/en/Software/Linux/Home_Assistant/" target="_blank" rel="noopener noreferrer">Home Assistant Tutorial</a>):</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_x14-7ead2abe7e62f029084260f4f3cddd3a.png" width="730" height="261" class="img_ev3q"></p><hr><p>You can copy the following JSON code and import it into Node-RED (<a href="https://wiki.instar.com/en/Software/Linux/Node-RED/#using-node-red-to-communicate-with-your-camera" target="_blank" rel="noopener noreferrer">How do I import flows to Node-RED?</a>):</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ebde9a4c.90efe8&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;link out&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;17b43655.05bd3a&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;links&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;57b22bf7.0e2874&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;5eb0d369.b3b15c&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;b5ce97db.b3f4f8&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;f335d7f4.4bbe18&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">1308</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;accb31dd.a130c&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;mqtt in&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;17b43655.05bd3a&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Wireless Button&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;topic&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;zigbee2mqtt/smart_button&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;qos&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;broker&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;40415d07.67dd94&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">780</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2537690e.6230d6&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2537690e.6230d6&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;json&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;17b43655.05bd3a&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;property&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;payload&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;action&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;pretty&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">929</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;17df313d.2e7aff&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;17df313d.2e7aff&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;change&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;17b43655.05bd3a&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;single / double&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;rules&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;t&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;set&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;p&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;payload&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;pt&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;msg&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;to&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;payload.click&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;tot&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;msg&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;action&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;property&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;from&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;to&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;reg&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">1076</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1f97ee5b.dfc642&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1f97ee5b.dfc642&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;string&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;17b43655.05bd3a&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;methods&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;replaceAll&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;str&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;single&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;str&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{\&quot;val\&quot; : \&quot;on\&quot;}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;replaceAll&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;str&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;double&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;str&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{\&quot;val\&quot; : \&quot;off\&quot;}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;prop&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;payload&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;propout&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;payload&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;object&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;msg&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;objectout&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;msg&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">1226</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ebde9a4c.90efe8&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;40415d07.67dd94&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;mqtt-broker&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Debian Mosquitto&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;broker&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;localhost&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;port&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1883&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;clientid&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;usetls&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;compatmode&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;keepalive&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;60&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;cleansession&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;birthTopic&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;birthQos&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;birthPayload&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;closeTopic&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;closePayload&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;willTopic&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;willQos&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token property">&quot;willPayload&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <strong>MQTT Node</strong> outputs the message from our button as a string. We first have to turn it into a JavaScript Object with a <strong>JSON Node</strong>.</p><p>Next follows a <strong>Change Node</strong> that changes the Message Payload to the value of <strong>Click</strong> - as we learnt above, this value can either be <code>single</code>, <code>double</code>, <code>triple</code>, <code>quadruple</code>, <code>long</code> or <code>release</code>:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_x15-336aea7d022128ad48537bd5d2bfcf18.png" width="730" height="316" class="img_ev3q"></p><hr><p>After that follows a <strong>String Node</strong> (this node type <a href="https://wiki.instar.com/en/Software/Linux/Node-RED/#the-node-red-admin-panel" target="_blank" rel="noopener noreferrer">has to be installed manually</a> - it is called <code>node-red-contrib-string</code>) that searches for the payload <code>single</code> or <code>double</code> and replaces them with something that we need to trigger the Flow below - in this case we need a JSON expression that either sets a value to <code>on</code> or <code>off</code>: <code>{&quot;val&quot; : &quot;on&quot;}</code> / <code>{&quot;val&quot; : &quot;off&quot;}</code>:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/zigbee2mqtt_x16-508d58eb148bed61debf9572f2dbd2ce.png" width="730" height="539" class="img_ev3q"></p><hr><p>And last but not least we add a <strong>Link Node</strong> to plug it in to all 4 sequences for the for the 4 alarm areas. Now every time we single-click the Wireless Button all areas are activated. A double-click deactivates them:</p><hr><p><img loading="lazy" alt="Zigbee2MQTT" src="/assets/images/nodered_x01-6d896109bdeb13a1b99adee0442a079e.gif" width="730" height="467" class="img_ev3q"></p><hr><p>We attached a <strong>Debug Node</strong> to the MQTT input to visualize the input given by the Wireless Button - <strong>Note</strong> that only the <code>single</code> and <code>double</code> click trigger the Alarm Area Sequences - the rest of the input options can be used for other functions.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/linux">LINUX</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/io-t">IoT</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/mqtt">MQTT</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/smarthome">Smarthome</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/Home_Automation/2019-01-05--zigbee2mqtt-xiaomi-fhem/index.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-24--motioneye-podman-centos8/2019-09-24"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Installing MotionEye on CentOS8 with Podman</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-24--iobroker-podman-centos8/2019-09-24"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Installing ioBroker on CentOS8 with Podman</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#zigbee-communication-without-a-proprietary-hub" class="table-of-contents__link toc-highlight">ZigBee Communication without a proprietary Hub</a><ul><li><a href="#setting-up-the-bridge" class="table-of-contents__link toc-highlight">Setting up the bridge</a></li><li><a href="#running-the-bridge" class="table-of-contents__link toc-highlight">Running the bridge</a></li><li><a href="#pairing-devices" class="table-of-contents__link toc-highlight">Pairing Devices</a></li></ul></li><li><a href="#adding-our-sensors-to-fhem" class="table-of-contents__link toc-highlight">Adding our Sensors to FHEM</a></li><li><a href="#adding-sql-logging" class="table-of-contents__link toc-highlight">Adding SQL Logging</a><ul><li><a href="#installing-mariadb-on-our-raspberry-pi" class="table-of-contents__link toc-highlight">Installing MariaDB on our Raspberry Pi</a></li><li><a href="#configuring-mariadb-for-fhem" class="table-of-contents__link toc-highlight">Configuring MariaDB for FHEM</a></li><li><a href="#log-filter" class="table-of-contents__link toc-highlight">Log Filter</a></li><li><a href="#average--reduce" class="table-of-contents__link toc-highlight">Average / Reduce</a></li></ul></li><li><a href="#compare-with-data-from-web-apis" class="table-of-contents__link toc-highlight">Compare with Data from Web-APIs</a><ul><li><a href="#visualize-logs" class="table-of-contents__link toc-highlight">Visualize Logs</a></li></ul></li><li><a href="#using-zigbee-devices-to-control-instar-ip-cameras-in-node-red" class="table-of-contents__link toc-highlight">Using Zigbee Devices to control INSTAR IP Cameras in Node-RED</a><ul><li><a href="#add-the-mqtt-input-to-an-existing-flow" class="table-of-contents__link toc-highlight">Add the MQTT input to an existing Flow</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.23698315.js"></script>
<script src="/assets/js/main.2d20e69f.js"></script>
</body>
</html>