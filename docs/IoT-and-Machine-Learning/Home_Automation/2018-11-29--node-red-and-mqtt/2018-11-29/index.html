<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-IoT-and-Machine-Learning/Home_Automation/2018-11-29--node-red-and-mqtt/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Node-RED and MQTT | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-29--node-red-and-mqtt/2018-11-29"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Node-RED and MQTT | Mike Polinowski"><meta data-rh="true" name="description" content="Mongkok, Hong Kong"><meta data-rh="true" property="og:description" content="Mongkok, Hong Kong"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-29--node-red-and-mqtt/2018-11-29"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-29--node-red-and-mqtt/2018-11-29" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-29--node-red-and-mqtt/2018-11-29" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.714c4925.css">
<link rel="preload" href="/assets/js/runtime~main.23698315.js" as="script">
<link rel="preload" href="/assets/js/main.2d20e69f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/internet-of-things--machine-learning">Internet-of-Things &amp; Machine Learning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internet-of-Things &amp; Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/machine-learning">Machine Learning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/aiops">AIOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;AIOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/home-automation">Home Automation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Home Automation&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-12-22--grafana-for-iot/2022-12-22">Grafana IoT Dashboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-12-15--rtsp-to-hls-ffmpeg/2022-12-15">Convert RTSP to HLS using FFmpeg</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-10-18-camera-ui-docker/2022-10-18">Run Camera.UI with Docker-Compose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-17-node-red-for-mqtt-autodiscovery/2022-07-17">MQTT Auto-Discovery - Use Node-RED to register Smarthome Devices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-16-openhab-mqtt-homie/2022-07-16">OpenHab - MQTT Homie Convention</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-15-node-red-mqtt-homie/2022-07-15">Node-RED - MQTT Homie Convention</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-10-home-assistant-mqtt-autodiscovery-part-i/2022-07-10">Home Assistant - MQTT Auto-Discovery :: Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-11-home-assistant-mqtt-autodiscovery-part-ii/2022-07-11">Home Assistant - MQTT Auto-Discovery :: Automation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2022-07-12-home-assistant-mqtt-python/2022-07-12">Home Assistant - Python Scripts as Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2020-12-03--openhab3-camera-binding/2020-12-03">OpenHAB 3 INSTAR Camera Binding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2020-12-02--openhab3-mqtt-binding/2020-12-02">OpenHAB 3 MQTT Binding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2020-12-01--openhab3-in-docker/2020-12-01">Trying out OpenHAB 3 in Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2020-09-16--testing-new-rest-api-with-nodered/2020-09-16">Testing a new REST API in Node-RED</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2020-09-15--mock-rest-api-with-nodered/2020-09-16">A Mock REST API in Node-RED and Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-11--loxone-miniserver/2019-02-11">Loxone Miniserver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-12-01--podman-hombridge-to-mqtt/2019-12-01">Podman Homebridge to MQTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-09--zoneminder-in-docker/2019-02-09">Zoneminder Dockerized</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-28--node-red-homekit-containerized/2019-09-28">Adding Homekit to your Node-RED Container in Podman</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-08--shinobi-on-debian/2019-02-08">Shinobi Video Surveillance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-27--home-assistant-podman-centos8/2019-09-27">Home Assistant, OpenHAB, Node-RED, ioBroker, MotionEye Containerized</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-07--motioneye-on-debian/2019-02-07">MotionEye Video Surveillance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-24--motioneye-podman-centos8/2019-09-24">Installing MotionEye on CentOS8 with Podman</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-01-05--zigbee2mqtt-xiaomi-fhem/2019-01-05">Zigbee Sensors in FHEM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-24--iobroker-podman-centos8/2019-09-24">Installing ioBroker on CentOS8 with Podman</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-12-01--openhab2-on-debian/2018-12-01">OpenHAB2 and MQTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-09-23--mqtt-camera-ai-video-security/2019-09-23">MQTT Camera AI Enhanced Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-30--home-assistant-on-debian/2018-11-30">Home Assistant and MQTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-29--node-red-and-mqtt/2018-11-29">Node-RED and MQTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-03-26--writing-a-homey-app/2019-03-26">Developing an App for the Homey Smarthome Gateway</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-28--node-red-on-android/2018-11-28">Node-RED on Android</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-16--ifttt-ip-camera-alarmserver/2019-02-15">IFTTT Alarmserver for IP Cameras</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-27--node-red-sql-logging/2018-11-27">Node-RED SQL Logging Datastreams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-02-15--ifttt-ip-camera/2019-02-15">IFTTT IP Camera</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-26--node-red-and-live-video/2018-11-26">Node-RED Dashboard and Videostreams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-25--webhooks-with-url-queries/2018-11-25">Webhooks with URL Queries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-24--node-red-webhooks/2018-11-24">Node-RED Webhooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-23--node-red-flows/2018-11-23">Node-RED Flows and how to Import them</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-21--nodered-dashboard-getting-started/2018-11-21">Creating Node-RED Admin Panel using node-red-dashboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-20--nodered-http-connect/2018-11-20">Node-RED Interaction over HTTP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-17--nodered-mqtt-connect/2018-11-17">A Collection of Node-RED MQTT Recipes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-13--nodered-ifttt/2018-11-13">Node-RED with IFTTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-12--nodered-sqlite/2018-11-12">Using SQLite with Node-RED on Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-05--nodered-cryptocurrency-dashboard/2018-11-05">Creating a Dashboard displaying Cryptocurrency Data using Node-RED</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-01--openhab2-mqtt-nodered/2018-11-01">Home Automation and IP Cameras</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-10-28--nodered-getting-started/2018-10-28">Getting Started with Node-RED (Windows 10 Edition)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/mqtt">MQTT</a><button aria-label="Toggle the collapsible sidebar category &#x27;MQTT&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/internet-of-things--machine-learning"><span itemprop="name">Internet-of-Things &amp; Machine Learning</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/home-automation"><span itemprop="name">Home Automation</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Node-RED and MQTT</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Node-RED and MQTT</h1></header><p><img loading="lazy" alt="Mongkok, Hong Kong" src="/assets/images/photo-kt456d_645dhfh6dgjkhg4_d-d94be8da2191bc5802e65ae5dc6fb4a1.jpg" width="1978" height="1045" class="img_ev3q"></p><ul><li><a href="#debian-installation">Debian Installation</a></li><li><a href="#creating-a-node-administrator-user">Creating a Node Administrator User</a></li><li><a href="#installing-node-red">Installing Node-RED</a><ul><li><a href="#run-node-red-as-a-service">Run Node-RED as a Service</a></li><li><a href="#create-the-ssl-certificate">Create the SSL Certificate</a></li><li><a href="#configuring-node-red">Configuring Node-RED</a></li><li><a href="#the-node-red-admin-panel">The Node-RED Admin Panel</a></li></ul></li><li><a href="#installing-mosquitto">Installing Mosquitto</a><ul><li><a href="#configuring-mosquitto">Configuring Mosquitto</a></li><li><a href="#testing-mosquitto-from-an-external-machine">Testing Mosquitto from an external Machine</a></li><li><a href="#adding-ssl-encryption">Adding SSL Encryption</a></li></ul></li><li><a href="#using-node-red-to-communicate-with-your-camera">Using Node-RED to communicate with your Camera</a><ul><li><a href="#alarm-set-flow">Alarm SET Flow</a></li><li><a href="#alarm-recording">Alarm Recording</a><ul><li><a href="#ftp-snapshot">FTP Snapshot</a></li></ul></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="debian-installation">Debian Installation<a class="hash-link" href="#debian-installation" title="Direct link to heading">​</a></h2><p>We choose to install Node-RED through Node.js under <strong>Debian 9 Linux</strong> on our mini PC - you can check the <a href="https://nodejs.org/en/download/package-manager/" target="_blank" rel="noopener noreferrer">Node.js Wiki</a> for more Linux flavours. To create the installation USB stick we <a href="https://www.debian.org/CD/netinst/" target="_blank" rel="noopener noreferrer">downloaded the minimal amd64 image</a> and used the tool <strong>Etcher</strong> to prepare the USB stick. Once the USB stick is ready, deactivate secure boot in your mini PC&#x27;s BIOS and boot from the stick. We are not going to need a desktop environment. But <strong>make sure that you install the SSH service</strong> - as we are going to use the SSH service to set up the Debian server.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-node-administrator-user">Creating a Node Administrator User<a class="hash-link" href="#creating-a-node-administrator-user" title="Direct link to heading">​</a></h2><p>Let&#x27;s create a user to administer the Node.js processes:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">adduser nodeadmin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x01-4f87afae694793818059175974d56ca5.png" width="730" height="269" class="img_ev3q"></p><hr><p>And make sure that the user is allowed to use the <code>sudo</code> command and switch users:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">addgroup nodeadmin </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">su</span><span class="token plain"> - nodeadmin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x02-aca859aa197c6ccbe1d713f32fcad062.png" width="730" height="277" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-node-red">Installing Node-RED<a class="hash-link" href="#installing-node-red" title="Direct link to heading">​</a></h2><p>We first need to install the <a href="https://nodejs.org/en/" target="_blank" rel="noopener noreferrer">Node.js</a> runtime and will use the Node Packet Manager (npm) to install <a href="https://nodered.org" target="_blank" rel="noopener noreferrer">Node-RED</a> in the second step:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> -sL https://deb.nodesource.com/setup_11.x </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">bash</span><span class="token plain"> -</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> -y nodejs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Type in the install command and use your <code>nodeadmin</code> password to be allowed to execute it with <code>sudo</code>:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x03-10528f7fb2f0ec443d565c8581a13130.png" width="730" height="236" class="img_ev3q"></p><hr><p><em>(in case of the screenshot above, Node.js was already installed from a setup)</em></p><p>Now, with the Node runtime installed, we can install Node-RED using the Node Package Manager <code>npm</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> -g --unsafe-perm node-red</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x04-66eb84d6bfb61dc64a835c3ea24ba06e.png" width="730" height="183" class="img_ev3q"></p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-node-red-as-a-service">Run Node-RED as a Service<a class="hash-link" href="#run-node-red-as-a-service" title="Direct link to heading">​</a></h3><p><a href="https://pm2.io/doc/en/runtime/guide/process-management/" target="_blank" rel="noopener noreferrer">PM2</a> is a process manager for Node.js. It makes it easy to run applications on boot and ensure they are restarted if necessary. Just like Node-RED, we can install PM2 from npm:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> -g pm2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pm2 start /usr/bin/node-red</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x05-39450ab186643891a75e7140fa18cc34.png" width="730" height="198" class="img_ev3q">
<img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x06-8e0efc82a6af22524f35544124ee6590.png" width="730" height="237" class="img_ev3q"></p><hr><p>The second command takes the Node-RED process and runs it inside the Node.js runtime. PM2 is able to generate and configure a start-up script suitable for the platform it is being run on. Run these commands and follow the instructions it provides:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x07-61e5b382c111d3842e7dfaba0ff9cfa2.png" width="780" height="730" class="img_ev3q"></p><hr><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pm2 save</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pm2 startup</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">env</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:rgb(189, 147, 249);font-style:italic">PATH</span><span class="token operator">=</span><span class="token environment constant" style="color:rgb(189, 147, 249)">$PATH</span><span class="token plain">:/usr/bin /usr/lib/node_modules/pm2/bin/pm2 startup systemd -u nodeadmin --hp /home/nodeadmin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The default port for the Node-RED admin panel is <code>1880</code> - let&#x27;s make sure that FirewallD allows this traffic:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> firewall-cmd --permanent --zone</span><span class="token operator">=</span><span class="token plain">public --add-port</span><span class="token operator">=</span><span class="token number">1880</span><span class="token plain">/tcp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-ssl-certificate">Create the SSL Certificate<a class="hash-link" href="#create-the-ssl-certificate" title="Direct link to heading">​</a></h3><p>We can create a self-signed key and certificate pair with OpenSSL in a single command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> openssl req -x509 -nodes -days </span><span class="token number">365</span><span class="token plain"> -newkey rsa:2048 -keyout /home/nodeadmin/.node-red/certs/node-red-selfsigned.key -out /home/nodeadmin/.node-red/certs/node-red-selfsigned.crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x08-00f6575bfc4f746f0888f9009217e3ff.png" width="730" height="342" class="img_ev3q"></p><hr><p><strong>Note</strong> that the server name is set to the local IP address of our Debian server (you have to change it according to your setup). If you want to access your Node-RED installation over a domain, you have to use this one here instead.</p><p>These options will create both a key file and a certificate. We will be asked a few questions about our server in order to embed the information correctly in the certificate. Those certificates will be used in the next step to set up the access over HTTPS to the Node-RED Admin-Panel.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-node-red">Configuring Node-RED<a class="hash-link" href="#configuring-node-red" title="Direct link to heading">​</a></h3><p>You will be able to find the Node-RED configuration file under <code>/home/nodeadmin/.node-red/</code>. Let&#x27;s open the file to add some additional configuration:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">nano</span><span class="token plain"> /home/nodeadmin/.node-red/settings.js</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x09-f0912b4f427d0a1210e7889a9fa991a0.png" width="730" height="245" class="img_ev3q"></p><hr><p>With all the comments removed the file should boil down to the following:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> fs </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">require</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;fs&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">uiPort</span><span class="token operator">:</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token constant" style="color:rgb(189, 147, 249)">PORT</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> </span><span class="token number">1880</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">mqttReconnectTime</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">15000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">serialReconnectTime</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">15000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">debugMaxLength</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">httpAdminRoot</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/admin&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">httpStatic</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/home/nodeadmin/.node-red/static/&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">ui</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reddash&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">adminAuth</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;credentials&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">users</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;admin&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token literal-property property">password</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;$2a$08$k.syiLYKsLGJdy01hPolj.m7dfgZXWz0do4oKkesLrJExoYgFBZYu&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token literal-property property">permissions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token literal-property property">permissions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;read&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">https</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">key</span><span class="token operator">:</span><span class="token plain"> fs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">readFileSync</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/home/nodeadmin/.node-red/certs/node-red-selfsigned.key&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">cert</span><span class="token operator">:</span><span class="token plain"> fs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">readFileSync</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/home/nodeadmin/.node-red/certs/node-red-selfsigned.crt&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">requireHttps</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">functionGlobalContext</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">logging</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">console</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token literal-property property">level</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;info&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token literal-property property">metrics</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token literal-property property">audit</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">editorTheme</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">projects</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token literal-property property">enabled</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Noteable changes:</p><ul><li>Uncommented the import of <code>fs</code> (needed to add the SSL certificate)</li><li>httpAdminRoot is set to <code>/admin</code> - that means that Node-RED admin panel is available under <code>https://&lt;IP Address&gt;:1880/admin/</code> instead of  <code>https://&lt;IP Address&gt;:1880/</code></li><li>We created a folder <code>/home/nodeadmin/.node-red/static/</code> to host static content for the Node-RED flow.</li><li>The <a href="https://flows.nodered.org/node/node-red-dashboard" target="_blank" rel="noopener noreferrer">node-red-dashboard</a> is an optional plugin for Node-RED that allows us to create - well, a dashboard... The line <code>ui: { path: &quot;reddash&quot; }</code> sets the URL for this dashboard to  <code>https://&lt;IP Address&gt;:1880/reddash/</code>.</li><li>For the <code>adminAuth</code> we create an Admin Login and set the default permission to <code>read</code> - which means that everyone can open the dashboard and see our Node-RED flows - but only the admin has the right to change them (you can remove the default permission, if not necessary).</li><li>For <code>https</code> we linked in the certificate we created in the step before. Don&#x27;t forget to set <code>requireHttps: true</code> to enforce an encrypted connection.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-node-red-admin-panel">The Node-RED Admin Panel<a class="hash-link" href="#the-node-red-admin-panel" title="Direct link to heading">​</a></h3><p>If you followed the recommendations above, you are now able to access Node-RED over <code>https://&lt;IP Address&gt;:1880/admin/</code> - in my case this is <code>https://192.168.2.111:1880/admin/</code>. Click on the user icon in the top left, login with the admin login you generated in the previous step and click on menu icon (on the right of the user login) and open the <strong>Manage Palette</strong> menu:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x10-b14594dec82a2a43fed3573ac62faf64.png" width="730" height="341" class="img_ev3q"></p><hr><p>In the following tutorials we are going to use a couple of functions that don&#x27;t come with Node-RED directly. But we can install them from the <a href="https://flows.nodered.org" target="_blank" rel="noopener noreferrer">Node-RED Flow Library</a> - feel free to browse it and see if there is something that you can use.</p><p>You can install those from the palette menu - I already did that and highlighted them in my list of installed nodes:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x11-9cde5e2cc285fa42fc67b174bd50b522.png" width="730" height="775" class="img_ev3q"></p><hr><p>Switch to the <strong>Install Tab</strong> and search for those entries and click the install button:</p><ul><li>node-red-contrib-alexa-local</li><li>node-red-contrib-bigtimer</li><li>node-red-contrib-mjpgcamera</li><li>node-red-contrib-string</li><li>node-red-dashboard</li></ul><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x12-45b6cc4ff1fb8c26a14781ff21e9df32.png" width="730" height="296" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-mosquitto">Installing Mosquitto<a class="hash-link" href="#installing-mosquitto" title="Direct link to heading">​</a></h2><p>MQTT is a machine-to-machine messaging protocol, designed to provide lightweight publish/subscribe communication to &quot;Internet of Things&quot; devices. It is commonly used for geo-tracking fleets of vehicles, home automation, environmental sensor networks, and utility-scale data collection. Mosquitto is a popular MQTT broker that has great community support and is easy to install and configure.</p><p>We are going to use it to exchange states between subflows in Node-RED. MQTT will also come in handy once we start using other home automation systems like <a href="https://www.openhab.org" target="_blank" rel="noopener noreferrer">OpenHAB</a>, <a href="https://www.home-assistant.io" target="_blank" rel="noopener noreferrer">Home Assistant</a> or <a href="http://iobroker.net" target="_blank" rel="noopener noreferrer">ioBroker</a>. We will be able to let those programs control our INSTAR IP cameras using the MQTT protocol.</p><p>First, download their repository signing key and install it:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">wget http://repo.mosquitto.org/debian/mosquitto-repo.gpg.key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo apt-key add mosquitto-repo.gpg.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now tell apt-get where to find the software by adding the repository URL to a file in <code>/etc/apt/sources.list.d/</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo nano /etc/apt/sources.list.d/mosquitto.list</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will open up a new, blank file. Paste the following line into the file.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">deb http://repo.mosquitto.org/debian stretch main</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x13-cf9c4bd7791ff9d16fd0cc9eb3fefbdf.png" width="729" height="54" class="img_ev3q"></p><hr><p>Save and close out of the editor, then update with apt-get to pull in the new package information. Then install the mosquitto package and its client software:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo apt-get update</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo apt-get install mosquitto mosquitto-clients</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x14-fcade13bd8249b965e0f2bc1f0ebb704.png" width="731" height="400" class="img_ev3q"></p><hr><p>To test the Mosquitto service log in to your server a second time, so you have two terminals side-by-side. In the new terminal, use mosquitto_sub to subscribe to the test topic:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mosquitto_sub -h localhost -t </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The -h flag specifies the hostname of the MQTT server, and -t is the topic name. You&#x27;ll see no output after hitting ENTER because mosquitto_sub is waiting for messages to arrive. Switch back to your other terminal and publish a message:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x15-ec77f0ff415d8e8fe93ace1f462b870e.png" width="757" height="70" class="img_ev3q"></p><hr><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mosquitto_pub -h localhost -t </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"> -m </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hello world&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The options for mosquitto_pub are the same as mosquitto_sub, though this time we use the additional -m option to specify our message. Hit ENTER, and you should see hello world pop up in the other terminal. You&#x27;ve sent your first MQTT message!</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x16-97b04904d6080311e9e0ac1a108a050b.png" width="760" height="76" class="img_ev3q"></p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-mosquitto">Configuring Mosquitto<a class="hash-link" href="#configuring-mosquitto" title="Direct link to heading">​</a></h3><p>Mosquitto includes a utility to generate a special password file called mosquitto_passwd. This command will prompt you to enter a password for the specified username (we choose <strong>debian</strong> in the example), and place the results in <code>/etc/mosquitto/passwd</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mosquitto_passwd -c /etc/mosquitto/passwd debian</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x17-56e157085a96f6105401a0afe49d7d27.png" width="729" height="89" class="img_ev3q"></p><hr><p>Now create a new configuration file for Mosquitto and tell it to use this password file to require logins for all connections:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">nano</span><span class="token plain"> /etc/mosquitto/conf.d/default.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This should open an empty file. Paste in the following:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">allow_anonymous </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">password_file /etc/mosquitto/passwd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x18-88695209479b7b5f6ecbfcea89df2684.png" width="729" height="68" class="img_ev3q"></p><hr><p><code>allow_anonymous false</code> disables all non-authenticated connections, and the <code>password_file</code> line tells Mosquitto where to look for user and password information. Save and exit the file.</p><p>Now you need to restart Mosquitto and test your changes.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">service</span><span class="token plain"> mosquitto reload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing-mosquitto-from-an-external-machine">Testing Mosquitto from an external Machine<a class="hash-link" href="#testing-mosquitto-from-an-external-machine" title="Direct link to heading">​</a></h3><p>Since your devices that you want to connect will probably contacting your MQTT Server from an external IP address, let&#x27;s test this and make sure everything is working. First let&#x27;s now open the MQTT Port in our FirewallD configuration:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo firewall-cmd --permanent --zone=public --add-port=1883/tcp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo firewall-cmd --reload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo firewall-cmd --list-all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>[We use MQTT.fx to debug our MQTT Server. Let&#x27;s install it on another machine (Linux, Windows or macOS) and click on the Cog Wheel icon left to the Connect and Disconnect button to add our newly setup MQTT server:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x19-3b334d73643a3fa7860e7ea3166a27f2.png" width="730" height="285" class="img_ev3q"></p><hr><p>Replace the IP address (&quot;192.168.2.111&quot;) with the address of your Linux machine that runs the MQTT service and add the login that you created for the Mosquitto server. Save the settings and connect to the server - the green light on the right should show that the connection was successfully establish.</p><p>Change to the <strong>Subscribe</strong> tab type in <code>test</code> and hit <strong>Subscribe</strong>:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x20-3c4dfd8071443df9880a0ad2ce0c35fa.png" width="730" height="194" class="img_ev3q"></p><hr><p>Switch to the <strong>Publish</strong> tab, type in test - as the topic you want to publish a message under - and add a message as payload in the text field below, e.g. <code>{&quot;hello&quot;:&quot;world&quot;}</code>. Then hit publish:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x21-ba937c6d73d0850db8ccd56b2f541c33.png" width="730" height="184" class="img_ev3q"></p><hr><p>Switch back to the <strong>Subscribe</strong> tab to verify that MQTT.fx successfully published the message and that our Mosquitto server notified clients with subscriptions to the topic about the change - in this case only our MQTT.fx instance:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x22-f5abb81be2036279cd5128ded688b5d2.png" width="730" height="458" class="img_ev3q"></p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-ssl-encryption">Adding SSL Encryption<a class="hash-link" href="#adding-ssl-encryption" title="Direct link to heading">​</a></h3><p>We are only going to use the MQTT protocol on our secure local network and decided to not encrypt the messages send by our IoT devices. If you plan to use the MQTT communication over the internet there is no way around wrapping those messages in an SSL/TLS encryption layer.</p><p>There are two (external) tutorials that will help you setting this up. The first tutorial shows you how to <a href="http://www.steves-internet-guide.com/mosquitto-tls/" target="_blank" rel="noopener noreferrer">work with a self-signed certificate</a> and the second one helps you to set up <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-16-04" target="_blank" rel="noopener noreferrer">Certbot and use Lets-Encrypt</a> to create the certificate and auto-renew it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-node-red-to-communicate-with-your-camera">Using Node-RED to communicate with your Camera<a class="hash-link" href="#using-node-red-to-communicate-with-your-camera" title="Direct link to heading">​</a></h2><p>The Node-RED admin panel is a visual tool to string function nodes into functional flows. all the flows used in this tutorial can be downloaded from here and imported into the admin panel using <strong>Import Dialogue</strong>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="alarm-set-flow">Alarm SET Flow<a class="hash-link" href="#alarm-set-flow" title="Direct link to heading">​</a></h4><p>Please copy the <a href="https://wiki.instar.com/Node-RED_Flows/nodered_flow_set-alarm-office.json" target="_blank" rel="noopener noreferrer">Set Alarm Flow</a> and open the import window on the Node-RED panel:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x23-8c51bb1a123272538f0a965d2089021f.png" width="730" height="371" class="img_ev3q"></p><hr><p>Paste the content into the input text field and hit the <strong>Import</strong> button:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x24-12748a8ca66fe657b6e01390d36fc370.png" width="730" height="287" class="img_ev3q"></p><hr><p>The Node-RED flow should be imported into a new tab, called <strong>SET Alarm Office</strong>. Hit the red <strong>Deploy</strong> button to save and load the flow:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x25-fb303c1a500db4d151aead15a7fa84e3.png" width="730" height="285" class="img_ev3q"></p><hr><p>We <a href="#configuring-node-red">configured Node-RED</a> to display the admin panel on <code>https://&lt;IP of your Server&gt;/admin</code>. You can switch to <code>https://&lt;IP of your Server&gt;/reddash</code> to see the corresponding <strong>Node-RED Dashboard</strong>. Just type in your <strong>INSTAR Full HD cameras</strong> IP address and hit submit:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x26-6d88a9297fdfb351ea534cb7f29ef37f.png" width="730" height="373" class="img_ev3q"></p><hr><p>This flow can, of course, also be used with any other IP camera model - you just have to exchange the CGI commands used with the one that you need from our documentation for <a href="https://wiki.instar.comhttps://wiki.instar.com/en/1080p_Series_CGI_List/" target="_blank" rel="noopener noreferrer">Full HD</a>, <a href="https://wiki.instar.com/720p_Series_CGI_List/" target="_blank" rel="noopener noreferrer">HD</a> and <a href="https://wiki.instar.comhttps://wiki.instar.com/en/Advanced_User/CGI_Commands/VGA_Series_CGI_List/" target="_blank" rel="noopener noreferrer">VGA</a> camera models:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x27-58580fc9f25739de2e2e8b0ad1ab7b7a.png" width="730" height="377" class="img_ev3q"></p><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="alarm-recording">Alarm Recording<a class="hash-link" href="#alarm-recording" title="Direct link to heading">​</a></h4><p>You can download this <a href="https://wiki.instar.com/Node-RED_Flows/nodered_flow_alarm_recording_outdoor.json" target="_blank" rel="noopener noreferrer">Alarm Recording Flow</a> here.</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x37-2fc49416932362e384e849c13d3035f6.png" width="730" height="667" class="img_ev3q"></p><hr><p>The first one enables you to manually upload a snapshot via FTP. And the second uses the PIR Motion Detector of your camera (of course, only applicable to camera&#x27;s with PIR sensors) to detect motions, activate the nightvision LEDs and start a 1min Recording on the internal SD card of your camera every time an alarm is triggered. The use case is - you want to disable the IR nightvision LEDs during the night, which saves you electricity, makes your camera less intrusive and prevents the spider web problem (insects love the warm and illuminated front of your camera).</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="ftp-snapshot">FTP Snapshot<a class="hash-link" href="#ftp-snapshot" title="Direct link to heading">​</a></h5><p>To use this flow, we will need to configure an FTP server on Debian 9 Stretch Linux allowing our INSTAR IP cameras to upload snapshots and videos when a motion alarm was triggered. The following tutorial will explain how to install and configure FTP server using <code>vsFTPd</code> daemon.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> vsftpd </span><span class="token function" style="color:rgb(80, 250, 123)">ftp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By default, the vsFTPd server comes configured to allow system users to access their home directories with read-only access. We will have to make changes to the vsFTPd config file <code>/etc/vsftpd.conf</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">nano</span><span class="token plain"> /etc/vsftpd.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x28-039bd8031549f2093954c9f595854ea2.png" width="730" height="230" class="img_ev3q"></p><hr><p>The result should look something like this:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">listen</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">listen_ipv6</span><span class="token operator">=</span><span class="token plain">NO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">local_enable</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">write_enable</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">dirmessage_enable</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">use_localtime</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">xferlog_enable</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">connect_from_port_20</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">secure_chroot_dir</span><span class="token operator">=</span><span class="token plain">/var/run/vsftpd/empty</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">pam_service_name</span><span class="token operator">=</span><span class="token plain">vsftpd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">rsa_cert_file</span><span class="token operator">=</span><span class="token plain">/etc/ssl/certs/nginx-selfsigned.crt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">rsa_private_key_file</span><span class="token operator">=</span><span class="token plain">/etc/ssl/private/nginx-selfsigned.key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ssl_enable</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># implicit_ssl=YES</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">listen_port</span><span class="token operator">=</span><span class="token number">21</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">allow_anon_ssl</span><span class="token operator">=</span><span class="token plain">NO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">force_local_data_ssl</span><span class="token operator">=</span><span class="token plain">NO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">force_local_logins_ssl</span><span class="token operator">=</span><span class="token plain">NO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ssl_tlsv1</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ssl_sslv2</span><span class="token operator">=</span><span class="token plain">NO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ssl_sslv3</span><span class="token operator">=</span><span class="token plain">NO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">userlist_file</span><span class="token operator">=</span><span class="token plain">/etc/vsftpd.userlist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">userlist_enable</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">userlist_deny</span><span class="token operator">=</span><span class="token plain">NO</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We are using the <a href="#create-the-ssl-certificate">SSL Certificate</a> that we generated for our NGINX server (of course you can also create a separate certificate for Node-RED following the instructions from the link above) and tell Node-RED to enforce SSL encryption. Note that we <strong>cannot use implicit SSL</strong> - as our Full HD cameras only use explicit encryption.</p><p><strong>You can skip this part for HD and VGA cameras</strong>, as they do not support FTPS. Just leave <code>ssl_enable=NO</code> to deactivate the encryption.</p><p>The above config file will only grant a <strong>read-only</strong> access to any system user listed within <code>/etc/passwd</code> file. To add <strong>write access</strong> for all system local user uncomment or add the following stanza <code>write_enable=YES</code>. The new configuration file consists of:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x29-15b39ec13f49e20fad83ad77609f5ff4.png" width="728" height="157" class="img_ev3q"></p><hr><p>By default, our FTP server allows access to any system user defined within <code>/etc/passwd</code> file. In order to allow only specific users to be able to login we can include the following lines into our configuration file:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">userlist_file</span><span class="token operator">=</span><span class="token plain">/etc/vsftpd.userlist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">userlist_enable</span><span class="token operator">=</span><span class="token plain">YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">userlist_deny</span><span class="token operator">=</span><span class="token plain">NO</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x30-31d7dbd4ca15bb829cf1cfce0a29f825.png" width="730" height="326" class="img_ev3q"></p><hr><p>The above will enable a predefined user list where any user listed within <code>/etc/vsftpd.userlist</code> will have access to the FTP server. Let&#x27;s first create a new user for the FTP service called <code>ftpuser</code> by typing the following command and adding a UNIX password:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> adduser ftpuser</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s create a new <code>/etc/vsftpd.userlist</code> user list and add our <code>ftpuser</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> ftpuser </span><span class="token operator">&gt;</span><span class="token plain"> /etc/vsftpd.userlist</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, restart your vsFTPd:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> systemctl restart vsftpd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can check if the FTP service is running on port 21 with the tool <code>netstat</code> - but you might have to install <code>net-tools</code> first:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> net-tools</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">netstat</span><span class="token plain"> -npl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x31-dc497e5d898241d03d04fe1d26bee159.png" width="730" height="417" class="img_ev3q"></p><hr><p>Now open port 20/21 in your firewall:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> firewall-cmd --permanent --zone</span><span class="token operator">=</span><span class="token plain">public --add-port</span><span class="token operator">=</span><span class="token number">20</span><span class="token plain">-21/tcp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> firewall-cmd --reload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> firewall-cmd --list-all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can test access to your FTP server using your default web browser - just prepend a <code>ftp://</code> to your Linux servers IP address, e.g. <code>ftp://192.168.2.111</code>, and log in with the <code>ftpuser</code>:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="data:image/png;base64,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" width="730" height="349" class="img_ev3q"></p><hr><p>Note that the directory that is used for the <code>ftpuser</code> is his <strong>home</strong> directory in <code>/home/ftpuser/</code>.  You can use a tool like the <a href="https://filezilla-project.org/download.php?type=client" target="_blank" rel="noopener noreferrer">Filezilla Client</a> to login to your FTP Server and upload a file to check if the write access is working (the advantage of using Filezilla over just trying to send an image directly from the FTP service of your INSTAR Full HD camera is, that Filezilla will give a more thorough error report, in case that something goes wrong): </p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x33-48e155bce061c63d97e39840bc2ae892.png" width="730" height="700" class="img_ev3q"></p><hr><p>Now it&#x27;s time to try to upload a test image from our INSTAR Full HD camera to the FTP server. Let&#x27;s create a folder <code>/home/ftpuser/outdoorcam</code> on our Linux server and add the FTP information to our camera configuration and press <strong>Apply</strong>:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x34-4f3ab2212a2a31d93f1fe9cce83d1bbd.png" width="730" height="506" class="img_ev3q"></p><hr><p><strong>Note</strong> that we added <code>TLS encryption</code> just as we defined it in <code>/etc/vsftpd.conf</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ssl_tlsv1=YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ssl_sslv2=NO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ssl_sslv3=NO</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Note2</strong> that we need to use the <strong>PORT Mode</strong> since we are operating the FTP server behind a firewall!</p><p>We now just have one issue left - the files will be uploaded to the <code>/home/ftpuser</code> directory and will be owned by the <code>ftpuser</code>. Since we are going to start the Node-RED process with a different user - <code>nodeadmin</code> - we have to make sure that the files can also be handled by Node-RED. Type <code>sudo nano /etc/vsftpd.conf</code> and add the following line:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">local_umask=0002</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also make the uploaded files executable - if that is something you need... <strong>potential dangerous</strong> - by changing this line to <code>file_open_mode=0777</code>.</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x35-2bea25736aeb3bb1645587d61f4c90cf.png" width="730" height="450" class="img_ev3q"></p><hr><p>To open the <code>/home/ftpuser</code> directory to us type:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> -R </span><span class="token number">777</span><span class="token plain"> /home/ftpuser</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This way we are able to set the directory to be the Static Directory of our Node-RED Dashboard and display uploaded images:</p><hr><p><img loading="lazy" alt="Node-RED and INSTAR IP Cameras" src="/assets/images/Node-RED_x36-6d64acfaa36b12292be57ab011d31a68.png" width="730" height="251" class="img_ev3q"></p><hr></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/io-t">IoT</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/node-red">Node-RED</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/mqtt">MQTT</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-29--node-red-and-mqtt/index.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/IoT-and-Machine-Learning/Home_Automation/2018-11-30--home-assistant-on-debian/2018-11-30"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Home Assistant and MQTT</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/IoT-and-Machine-Learning/Home_Automation/2019-03-26--writing-a-homey-app/2019-03-26"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Developing an App for the Homey Smarthome Gateway</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#debian-installation" class="table-of-contents__link toc-highlight">Debian Installation</a></li><li><a href="#creating-a-node-administrator-user" class="table-of-contents__link toc-highlight">Creating a Node Administrator User</a></li><li><a href="#installing-node-red" class="table-of-contents__link toc-highlight">Installing Node-RED</a><ul><li><a href="#run-node-red-as-a-service" class="table-of-contents__link toc-highlight">Run Node-RED as a Service</a></li><li><a href="#create-the-ssl-certificate" class="table-of-contents__link toc-highlight">Create the SSL Certificate</a></li><li><a href="#configuring-node-red" class="table-of-contents__link toc-highlight">Configuring Node-RED</a></li><li><a href="#the-node-red-admin-panel" class="table-of-contents__link toc-highlight">The Node-RED Admin Panel</a></li></ul></li><li><a href="#installing-mosquitto" class="table-of-contents__link toc-highlight">Installing Mosquitto</a><ul><li><a href="#configuring-mosquitto" class="table-of-contents__link toc-highlight">Configuring Mosquitto</a></li><li><a href="#testing-mosquitto-from-an-external-machine" class="table-of-contents__link toc-highlight">Testing Mosquitto from an external Machine</a></li><li><a href="#adding-ssl-encryption" class="table-of-contents__link toc-highlight">Adding SSL Encryption</a></li></ul></li><li><a href="#using-node-red-to-communicate-with-your-camera" class="table-of-contents__link toc-highlight">Using Node-RED to communicate with your Camera</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.23698315.js"></script>
<script src="/assets/js/main.2d20e69f.js"></script>
</body>
</html>