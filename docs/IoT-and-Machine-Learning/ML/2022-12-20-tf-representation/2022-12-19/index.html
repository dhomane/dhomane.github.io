<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-IoT-and-Machine-Learning/ML/2022-12-20-tf-representation/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Tensorflow Representation Learning | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2022-12-20-tf-representation/2022-12-19"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tensorflow Representation Learning | Mike Polinowski"><meta data-rh="true" name="description" content="Build a Denoising Autoencoder in Tensorflow using the mnist Digits Dataset"><meta data-rh="true" property="og:description" content="Build a Denoising Autoencoder in Tensorflow using the mnist Digits Dataset"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2022-12-20-tf-representation/2022-12-19"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2022-12-20-tf-representation/2022-12-19" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2022-12-20-tf-representation/2022-12-19" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.714c4925.css">
<link rel="preload" href="/assets/js/runtime~main.23698315.js" as="script">
<link rel="preload" href="/assets/js/main.2d20e69f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/internet-of-things--machine-learning">Internet-of-Things &amp; Machine Learning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internet-of-Things &amp; Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/machine-learning">Machine Learning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-14-yolov7_to_tensorflow/2023-01-14">YOLOv7 to Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-13-yolov7_data_conversion/2023-01-13">YOLOv7 Label Conversion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-10-yolov7_custom_data/2023-01-10">YOLOv7 Training with Custom Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-08-depth-vision-midas/2023-01-08">MiDaS Depth Vision</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-05-yolov7/2023-01-05">YOLOv7 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-31-tf-rnn-text-generation/2022-12-31">Recurrent Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-28-tf-gan-image-generator/2022-12-28">Deep Convolutional Generative Adversarial Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-21-tf-downsampling/2022-12-21">Tensorflow Downsampling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-21-tf-deepdream/2022-12-21">Tensorflow Deep Dream</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-20-tf-representation/2022-12-19">Tensorflow Representation Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-19-tf-hub/2022-12-19">Tensorflow Hub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-18-tf-transfer-learning/2022-12-18">Tensorflow Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-16-tf-cifar/2022-12-16">Tensorflow Image Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-12-tf-breast-cancer-classification-part6/2022-12-12">Breast Histopathology Image Segmentation Part 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-12-tf-breast-cancer-classification-part5/2022-12-12">Breast Histopathology Image Segmentation Part 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part4/2022-12-11">Breast Histopathology Image Segmentation Part 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part3/2022-12-11">Breast Histopathology Image Segmentation Part 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part2/2022-12-11">Breast Histopathology Image Segmentation Part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-10-tf-breast-cancer-classification-part1/2022-12-10">Breast Histopathology Image Segmentation Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-11-27-containerized-deep-learning/2022-11-27">Deep Docker on Arch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-04-pytorch-face-restoration/2022-04-04">Face Restoration with GFPGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-03-pytorch-real-super-resolution/2022-04-03">Super Resolution with Real-ESRGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-02-pytorch-super-resolution/2022-04-02">Super Resolution with ESRGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-01-tensorflow-audio-classifier/2022-04-01">Deep Audio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-20--yolo-app-yolov5-data-prep/2022-02-20">Yolo App - YOLOv5 Data Preparation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-19--yolo-app-flask/2022-02-19">Yolo App - Flask Web Application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-18--yolo-app-ocr/2022-02-18">Yolo App - Tesseract Optical Character Recognition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-17--yolo-app-prediction-pipeline/2022-02-17">Yolo App - Pipeline Predictions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-16--yolo-app-tensorflow-model/2022-02-16">Yolo App - Train a Model with Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-15--yolo-app-get-data/2022-02-15">Yolo App - Data Collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-10--opencv-optical-flow-tracking/2021-12-10">OpenCV Optical Flow Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-09--opencv-camshift-tracking/2021-12-09">OpenCV CAMshift Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-08--opencv-meanshift-tracking/2021-12-08">OpenCV Meanshift Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-07--opencv-detection-and-tracking/2021-12-07">OpenCV Object Detection and Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-06--opencv-object-tracking/2021-12-06">OpenCV Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-05--opencv-face-detection/2021-12-05">OpenCV Face Detection and Privacy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-04--opencv-image-objects/2021-12-04">OpenCV Image Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-03--opencv-image-operations/2021-12-03">OpenCV Image Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-02--opencv-with-videos/2021-12-02">OpenCV, Streams and Video Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-01--opencv-with-images/2021-12-01">OpenCV and Images</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-15--facebook-prophet-introduction/2021-11-15">Introduction into FB Prophet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-14--tensorflow-model-for-tfjs/2021-11-14">Tensorflow.js React App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-13--tensorflow-model-zoo/2021-11-13">Tensorflow2 Model Zoo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-12--tensorflow-crash-course-part-v/2021-11-12">Tensorflow2 Crash Course - Part V</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-11--tensorflow-crash-course-part-iv/2021-11-11">Tensorflow2 Crash Course - Part IV</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-10--tensorflow-crash-course-part-iii/2021-11-10">Tensorflow2 Crash Course - Part III</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-09--tensorflow-crash-course-part-ii/2021-11-09">Tensorflow2 Crash Course - Part II</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/2021-11-08">Tensorflow Crash Course - Part I</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tensorflow Crash Course - Part I&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-07--opencv-crash-course-part-ii/2021-11-07">OpenCV Crash Course Part II</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-06--opencv-crash-course-part-i/2021-11-06">OpenCV Crash Course Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-05--license-plates-yolov4-opencv-tesseract/2021-11-05">License Plate Recognition with YOLOv4, OpenCV and Tesseract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-04--installing-yolov4/2021-11-04">Installing YOLOv4 with Anaconda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-03--streamlit-opencv-mediapipe/2021-11-03">Streamlit user interface for openCV/Mediapipe face mesh app</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-02--spacy_ner_predictions/2021-11-02">spaCy NER Predictions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-01--spacy_natural_language_processing/2021-11-01">spaCy NER on Arch Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2019-04-01--introduction-to-keras/2019-04-01">Introduction to Keras</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-10-31--tesseract_ocr_arch_linux/2021-10-31">Tesseract OCR on Arch Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2019-03-31--introduction-to-tensorflow-2-beta/2019-03-31">Introduction to TensorFlow 2 Beta</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2018-01-02--machine-learning-with-python/2018-01-02">Machine Learning with SciKit Learn</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/aiops">AIOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;AIOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/home-automation">Home Automation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Home Automation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/mqtt">MQTT</a><button aria-label="Toggle the collapsible sidebar category &#x27;MQTT&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/internet-of-things--machine-learning"><span itemprop="name">Internet-of-Things &amp; Machine Learning</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/machine-learning"><span itemprop="name">Machine Learning</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Tensorflow Representation Learning</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Tensorflow Representation Learning</h1></header><p><img loading="lazy" alt="Guangzhou, China" src="/assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-918471126c0472aad97358a725e1a399.jpg" width="1500" height="383" class="img_ev3q"></p><ul><li><a href="#denoising-autoencoder">Denoising Autoencoder</a><ul><li><a href="#inspecting-the-dataset">Inspecting the Dataset</a></li><li><a href="#adding-noise">Adding Noise</a></li><li><a href="#build-the-autoencoder">Build the Autoencoder</a></li><li><a href="#train-the-autoencoder">Train the Autoencoder</a></li><li><a href="#evaluate-the-model">Evaluate the Model</a></li></ul></li></ul><blockquote><p><a href="https://github.com/mpolinowski/tf-mnist-digits" target="_blank" rel="noopener noreferrer">Github</a></p></blockquote><p>Auto encoders are a type of <strong>Artificial Neural Networks</strong> (<em>ANN</em>) that are used to perform data encoding (<strong>Representation Learning</strong>). Auto encoder use the same data for input data and output data:</p><ul><li><strong>Feed Forward ANN</strong> (<em>Supervised Learning</em>):<ul><li><em>Cat Image</em> <code>=&gt;</code> <strong>ANN</strong> <code>&lt;=</code> <em>True Label (Cat)</em></li></ul></li><li><strong>Auto Encoder ANN</strong> (<em>Unsupervised Learning</em>):<ul><li><em>Cat Image</em> <code>=&gt;</code> <strong>Encoder ANN</strong>/<strong>Decoder ANN</strong> <code>=&gt;</code> <strong>Reconstructed Cat Image</strong> <code>=&gt;</code> <code>&lt;=</code> <em>Cat Image</em></li></ul></li></ul><p>The encoding side of this network generates a representation of the input image (<em>dimensionality reduction</em>). The decoding side then takes the encoded image and tries to reconstruct the input image from it. The performance metric for an Auto Encoder is the similarity between the input and output image.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="denoising-autoencoder">Denoising Autoencoder<a class="hash-link" href="#denoising-autoencoder" title="Direct link to heading">​</a></h2><p>A common use-case for autoencoders is the removal of noise from data, e.g. compression artifacts in low resolution images. This is done by feeding the autoencoder the compressed image and comparing the reconstructed output image to the original, non-compressed image. This training will give us a model that allows us to remove compression artifacts from similarly &quot;mis-treated&quot; images.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="inspecting-the-dataset">Inspecting the Dataset<a class="hash-link" href="#inspecting-the-dataset" title="Direct link to heading">​</a></h3><p>Start by loading the mnist digits dataset - which is provided by Keras:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># download mnist dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">datasets </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> mnist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> mnist</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">load_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can inspect a random set of 225 images and their labels from the set using matplotlib:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># inspect a larger set of images</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## create a 15x15 grid</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">W_grid </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">L_grid </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> axes </span><span class="token operator">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subplots</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">L_grid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> W_grid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> axes </span><span class="token operator">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subplots</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">L_grid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> W_grid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> figsize </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">17</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">17</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## flaten the 15 x 15 matrix into 225 array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">axes </span><span class="token operator">=</span><span class="token plain"> axes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ravel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## get the length of the training dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">n_training </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">arange</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> W_grid </span><span class="token operator">*</span><span class="token plain"> L_grid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># select a random number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    index </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">randint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> n_training</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># read and display an image with the selected index    </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    axes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imshow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    axes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_title</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">y_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> fontsize </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    axes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">axis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;off&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subplots_adjust</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">hspace</span><span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tight_layout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Tensorflow Transfer Learning" src="/assets/images/Tensorflow_Transfer_Learning_01-10a1422e089c2fcf1a2f51cb2c12cb37.png" width="1638" height="980" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-noise">Adding Noise<a class="hash-link" href="#adding-noise" title="Direct link to heading">​</a></h3><p>The dataset is clean of noise and can be used as our reference material. To create the &quot;dirty&quot; set of images we can use Numpy to add some random variations:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># create a 28x28 matrix of random number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># added_noise = np.random.randn(*(28,28))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">noise_factor </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">added_noise </span><span class="token operator">=</span><span class="token plain"> noise_factor </span><span class="token operator">*</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">randn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imshow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">added_noise</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Tensorflow Transfer Learning" src="/assets/images/Tensorflow_Transfer_Learning_03-0ea0f8701df080b1796b70f18086ad10.png" width="630" height="475" class="img_ev3q"></p><p>We can add noise to an existing image the same way:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># adding noise to our image</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## how much noise do we need</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">noise_factor </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## select an image</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sample_image </span><span class="token operator">=</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">666</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## and add noise map to it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">noisy_sample_image </span><span class="token operator">=</span><span class="token plain"> sample_image </span><span class="token operator">+</span><span class="token plain"> noise_factor </span><span class="token operator">*</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">randn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># previs noisy image</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imshow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">noisy_sample_image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> cmap</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;gray&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Tensorflow Transfer Learning" src="data:image/png;base64,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8ODN9Ur/z/38KJ5++mnvg169esXGxg4fPrywsLBTp042DQgL8KPjm0NkZGRAQED9d1GWlJTExMTYONINatWqVVJSUkFBgd2D3BDvKbiVzosxpmPHjpGRkU381EyePHnDhg1ffvll3VKSMTExVVVVpaWldZmmfy5+fhQNpKSkGGOa+LlAoyjam0NQUFDfvn03b97s/WNtbe3mzZsHDhxo71Q3oqysrLCwMDY21u5BbkhiYmJMTEzdeXG73bt27bqpz4sx5uTJk+fOnWuyp8bj8UyePHnNmjVffPFFYmJi3fN9+/YNDAysOxd5eXknTpxosufiakfRwP79+40xTfZcQIjVe24aLVu2nD59enx8vMPhmD59+v79+xcuXBgaGmr3XNfh5ZdfdjgcxpjDhw9PmjTp9OnTCxYsaNGihd1ziZSVlR0+fNjpdL733nspKSkhISFVVVWtWrWqqan505/+1L1796qqqt/97ncXL1585513muzqK1c8ioCAgP/7v/9r2bLlpUuX9u7d+9RTT4WGhv71r39tmkeRmZm5bNmyVatWxcXFlZWVlZWVBQQEBAYGBgcHFxcXv/vuu3369Pnxxx+feeaZ+Pj4mTNn2j3vlV3tKAoLC+fOnRsaGlpVVbV169ZJkyb16tXr1VdftXte3Bi73/aM6/DOO++0b98+KChowIABubm5do9z3caMGRMbGxsUFHTbbbeNGTOmoKDA7omuw5dfftng38748eM9Hk9tbe306dOjo6MdDsfw4cPz8vLsnvRarngUFy9eHDFiRNu2bQMDAxMSEiZOnOh0Ou2e9Kp+/p/YokWLvB/66aefnnvuudatWzdv3vzBBx88deqUrZNey9WO4sSJE0OHDo2IiHA4HJ07d/7973/vcrnsHhY3imXyAABQxGu0AAAoomgBAFBE0QIAoIiiBQBAEUULAIAiihYAAEUULQAAiihaAAAUUbQAACiiaAEAUETRAgCgiKIFAEARRQsAgCKKFgAARRQtAACKKFoAABRRtAAAKKJoAQBQRNECAKCIogUAQBFFCwCAIooWAABFFC0AAIooWgAAFFG0AAAoomgBAFBE0QIAoIiiBQBAEUULAICi/wdmN23tsN+oBQAAAABJRU5ErkJggg==" width="632" height="475" class="img_ev3q"></p><p>Now we can run a loop over both our training and testing dataset, add the same amount of random noise to each image and store those &quot;dirty&quot; datasets in variables:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># add noise to all images in training dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">X_train_noisy </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">noise_factor </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> sample_image </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  sample_image_noisy </span><span class="token operator">=</span><span class="token plain"> sample_image </span><span class="token operator">+</span><span class="token plain"> noise_factor </span><span class="token operator">*</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">randn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  sample_image_noisy </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">clip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sample_image_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  X_train_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">append</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sample_image_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># convert list to np array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">X_train_noisy </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_train_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># add noise to all images in testing dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">X_test_noisy </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">noise_factor </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> sample_image </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  sample_image_noisy </span><span class="token operator">=</span><span class="token plain"> sample_image </span><span class="token operator">+</span><span class="token plain"> noise_factor </span><span class="token operator">*</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">randn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  sample_image_noisy </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">clip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sample_image_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  X_test_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">append</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sample_image_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># convert list to np array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">X_test_noisy </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_test_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="build-the-autoencoder">Build the Autoencoder<a class="hash-link" href="#build-the-autoencoder" title="Direct link to heading">​</a></h3><p>The autoencoder is based on a regular Keras sequential model and consists of the encoder - that is basically the same convolution layer used in regular CNNs with supervised learning - and an decoder - that is an &quot;encoder in reverse&quot;. The decoder takes the representation of the image generated by the encoder from the representation layer and has to reconstruct the initial image from this compress data:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># build autoencoder model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">models</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># build the encoder CNN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">16</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strides</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;same&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> input_shape</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">MaxPooling2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;same&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strides</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;same&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">MaxPooling2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;same&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># representation layer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strides</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;same&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># build the decoder CNN </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">UpSampling2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2DTranspose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strides</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;same&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">UpSampling2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2DTranspose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strides</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> activation</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;sigmoid&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;same&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">compile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">loss</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;binary_crossentropy&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> optimizer</span><span class="token operator">=</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">optimizers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Adam</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">lr</span><span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">summary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="train-the-autoencoder">Train the Autoencoder<a class="hash-link" href="#train-the-autoencoder" title="Direct link to heading">​</a></h3><p>For the training we now feed the generated noisy dataset into the encoder and have the autencoder compress and reconstruct each image. After those steps we provide to original - noise-free - image to compare the reconstructed image to. The training is complete when we reach a minimum of differences between both of them:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_train_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">          </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          X_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          epochs</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          batch_size</span><span class="token operator">=</span><span class="token number">200</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="evaluate-the-model">Evaluate the Model<a class="hash-link" href="#evaluate-the-model" title="Direct link to heading">​</a></h3><p>To get an idea how well our model is performing we can take the first 15 images from the noisy test dataset and compare these source images with the predicted de-noised image:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># test training</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># take 15 images from noisy test set and predict de-noised state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">denoised_images </span><span class="token operator">=</span><span class="token plain"> autoencoder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_test_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">15</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># plot noisy input vs denoised output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> axes </span><span class="token operator">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subplots</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nrows</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ncols</span><span class="token operator">=</span><span class="token number">15</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> figsize</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">30</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> row </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">X_test_noisy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">15</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> denoised_images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> axes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ax </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ax</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imshow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> cmap</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;gray&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Tensorflow Transfer Learning" src="/assets/images/Tensorflow_Transfer_Learning_05-653fd9653d8eaafea733a86a77b2dd60.png" width="2049" height="419" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/python">Python</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/machine-learning">Machine Learning</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/tensorflow">Tensorflow</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2022-12-20-tf-representation/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/IoT-and-Machine-Learning/ML/2022-12-21-tf-deepdream/2022-12-21"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tensorflow Deep Dream</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/IoT-and-Machine-Learning/ML/2022-12-19-tf-hub/2022-12-19"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tensorflow Hub</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#denoising-autoencoder" class="table-of-contents__link toc-highlight">Denoising Autoencoder</a><ul><li><a href="#inspecting-the-dataset" class="table-of-contents__link toc-highlight">Inspecting the Dataset</a></li><li><a href="#adding-noise" class="table-of-contents__link toc-highlight">Adding Noise</a></li><li><a href="#build-the-autoencoder" class="table-of-contents__link toc-highlight">Build the Autoencoder</a></li><li><a href="#train-the-autoencoder" class="table-of-contents__link toc-highlight">Train the Autoencoder</a></li><li><a href="#evaluate-the-model" class="table-of-contents__link toc-highlight">Evaluate the Model</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.23698315.js"></script>
<script src="/assets/js/main.2d20e69f.js"></script>
</body>
</html>