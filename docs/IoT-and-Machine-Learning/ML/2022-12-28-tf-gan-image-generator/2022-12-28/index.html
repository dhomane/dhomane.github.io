<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-IoT-and-Machine-Learning/ML/2022-12-28-tf-gan-image-generator/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Deep Convolutional Generative Adversarial Network | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2022-12-28-tf-gan-image-generator/2022-12-28"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deep Convolutional Generative Adversarial Network | Mike Polinowski"><meta data-rh="true" name="description" content="Use Adversarial Networks to generate Images"><meta data-rh="true" property="og:description" content="Use Adversarial Networks to generate Images"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2022-12-28-tf-gan-image-generator/2022-12-28"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2022-12-28-tf-gan-image-generator/2022-12-28" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2022-12-28-tf-gan-image-generator/2022-12-28" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.714c4925.css">
<link rel="preload" href="/assets/js/runtime~main.23698315.js" as="script">
<link rel="preload" href="/assets/js/main.2d20e69f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/internet-of-things--machine-learning">Internet-of-Things &amp; Machine Learning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internet-of-Things &amp; Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/machine-learning">Machine Learning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-14-yolov7_to_tensorflow/2023-01-14">YOLOv7 to Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-13-yolov7_data_conversion/2023-01-13">YOLOv7 Label Conversion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-10-yolov7_custom_data/2023-01-10">YOLOv7 Training with Custom Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-08-depth-vision-midas/2023-01-08">MiDaS Depth Vision</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-05-yolov7/2023-01-05">YOLOv7 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-31-tf-rnn-text-generation/2022-12-31">Recurrent Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-28-tf-gan-image-generator/2022-12-28">Deep Convolutional Generative Adversarial Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-21-tf-downsampling/2022-12-21">Tensorflow Downsampling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-21-tf-deepdream/2022-12-21">Tensorflow Deep Dream</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-20-tf-representation/2022-12-19">Tensorflow Representation Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-19-tf-hub/2022-12-19">Tensorflow Hub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-18-tf-transfer-learning/2022-12-18">Tensorflow Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-16-tf-cifar/2022-12-16">Tensorflow Image Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-12-tf-breast-cancer-classification-part6/2022-12-12">Breast Histopathology Image Segmentation Part 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-12-tf-breast-cancer-classification-part5/2022-12-12">Breast Histopathology Image Segmentation Part 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part4/2022-12-11">Breast Histopathology Image Segmentation Part 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part3/2022-12-11">Breast Histopathology Image Segmentation Part 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part2/2022-12-11">Breast Histopathology Image Segmentation Part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-10-tf-breast-cancer-classification-part1/2022-12-10">Breast Histopathology Image Segmentation Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-11-27-containerized-deep-learning/2022-11-27">Deep Docker on Arch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-04-pytorch-face-restoration/2022-04-04">Face Restoration with GFPGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-03-pytorch-real-super-resolution/2022-04-03">Super Resolution with Real-ESRGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-02-pytorch-super-resolution/2022-04-02">Super Resolution with ESRGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-01-tensorflow-audio-classifier/2022-04-01">Deep Audio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-20--yolo-app-yolov5-data-prep/2022-02-20">Yolo App - YOLOv5 Data Preparation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-19--yolo-app-flask/2022-02-19">Yolo App - Flask Web Application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-18--yolo-app-ocr/2022-02-18">Yolo App - Tesseract Optical Character Recognition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-17--yolo-app-prediction-pipeline/2022-02-17">Yolo App - Pipeline Predictions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-16--yolo-app-tensorflow-model/2022-02-16">Yolo App - Train a Model with Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-15--yolo-app-get-data/2022-02-15">Yolo App - Data Collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-10--opencv-optical-flow-tracking/2021-12-10">OpenCV Optical Flow Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-09--opencv-camshift-tracking/2021-12-09">OpenCV CAMshift Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-08--opencv-meanshift-tracking/2021-12-08">OpenCV Meanshift Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-07--opencv-detection-and-tracking/2021-12-07">OpenCV Object Detection and Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-06--opencv-object-tracking/2021-12-06">OpenCV Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-05--opencv-face-detection/2021-12-05">OpenCV Face Detection and Privacy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-04--opencv-image-objects/2021-12-04">OpenCV Image Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-03--opencv-image-operations/2021-12-03">OpenCV Image Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-02--opencv-with-videos/2021-12-02">OpenCV, Streams and Video Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-01--opencv-with-images/2021-12-01">OpenCV and Images</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-15--facebook-prophet-introduction/2021-11-15">Introduction into FB Prophet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-14--tensorflow-model-for-tfjs/2021-11-14">Tensorflow.js React App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-13--tensorflow-model-zoo/2021-11-13">Tensorflow2 Model Zoo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-12--tensorflow-crash-course-part-v/2021-11-12">Tensorflow2 Crash Course - Part V</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-11--tensorflow-crash-course-part-iv/2021-11-11">Tensorflow2 Crash Course - Part IV</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-10--tensorflow-crash-course-part-iii/2021-11-10">Tensorflow2 Crash Course - Part III</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-09--tensorflow-crash-course-part-ii/2021-11-09">Tensorflow2 Crash Course - Part II</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/2021-11-08">Tensorflow Crash Course - Part I</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tensorflow Crash Course - Part I&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-07--opencv-crash-course-part-ii/2021-11-07">OpenCV Crash Course Part II</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-06--opencv-crash-course-part-i/2021-11-06">OpenCV Crash Course Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-05--license-plates-yolov4-opencv-tesseract/2021-11-05">License Plate Recognition with YOLOv4, OpenCV and Tesseract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-04--installing-yolov4/2021-11-04">Installing YOLOv4 with Anaconda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-03--streamlit-opencv-mediapipe/2021-11-03">Streamlit user interface for openCV/Mediapipe face mesh app</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-02--spacy_ner_predictions/2021-11-02">spaCy NER Predictions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-01--spacy_natural_language_processing/2021-11-01">spaCy NER on Arch Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2019-04-01--introduction-to-keras/2019-04-01">Introduction to Keras</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-10-31--tesseract_ocr_arch_linux/2021-10-31">Tesseract OCR on Arch Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2019-03-31--introduction-to-tensorflow-2-beta/2019-03-31">Introduction to TensorFlow 2 Beta</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2018-01-02--machine-learning-with-python/2018-01-02">Machine Learning with SciKit Learn</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/aiops">AIOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;AIOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/home-automation">Home Automation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Home Automation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/mqtt">MQTT</a><button aria-label="Toggle the collapsible sidebar category &#x27;MQTT&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/internet-of-things--machine-learning"><span itemprop="name">Internet-of-Things &amp; Machine Learning</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/machine-learning"><span itemprop="name">Machine Learning</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Deep Convolutional Generative Adversarial Network</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deep Convolutional Generative Adversarial Network</h1></header><p><img loading="lazy" alt="Guangzhou, China" src="/assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-296769d73822f07b0ac5dc952f56bfa1.jpg" width="1500" height="662" class="img_ev3q"></p><ul><li><a href="#training-dataset">Training Dataset</a></li><li><a href="#building-the-generator">Building the Generator</a></li><li><a href="#building-the-discriminator">Building the Discriminator</a></li><li><a href="#loss-function">Loss Function</a></li><li><a href="#model-training">Model Training</a></li></ul><p><a href="https://www.tensorflow.org/tutorials/generative/dcgan" target="_blank" rel="noopener noreferrer">Generative Adversarial Networks</a> (GANs) are one of the most interesting ideas in computer science today. Two models are trained simultaneously by an adversarial process. A <strong>Generator</strong> (&quot;the artist&quot;) learns to create images that look real, while a <strong>Discriminator</strong> (&quot;the art critic&quot;) learns to tell real images apart from fakes.</p><p>During training, the generator progressively becomes better at creating images that look real, while the discriminator becomes better at telling them apart. The process reaches equilibrium when the discriminator can no longer distinguish real images from fakes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="training-dataset">Training Dataset<a class="hash-link" href="#training-dataset" title="Direct link to heading">​</a></h2><p>To train the discriminator I am going to use the <a href="https://github.com/zalandoresearch/fashion-mnist" target="_blank" rel="noopener noreferrer">Fashion mnist dataset</a> provided by Keras:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">BUFFER_SIZE </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">60000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">BATCH_SIZE </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">256</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EPOCHS </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">noise_dim </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">num_examples_to_generate </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">seed </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">num_examples_to_generate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> noise_dim</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">generator_optimizer </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">optimizers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Adam</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1e-4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">discriminator_optimizer </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">optimizers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Adam</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1e-4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># import keras fashion mnist fashion dataset (60000 labeled images 28x28)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">train_images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> train_labels</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">datasets</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">fashion_mnist</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">load_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## preprocess images</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># print(rain_images.shape[0])</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## 60000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">train_images </span><span class="token operator">=</span><span class="token plain"> train_images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">train_images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;float32&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">train_images </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">train_images </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">127.5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">127.5</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># Normalize the images to [-1, 1]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## batch / shuffle images</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">train_dataset </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Dataset</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">from_tensor_slices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">train_images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shuffle</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BUFFER_SIZE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">batch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BATCH_SIZE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Fashion-MNIST is a dataset of Zalando&#x27;s article images—consisting of a training set of <code>60,000</code> examples. Each example is a <code>28</code>x<code>28</code> grayscale image, associated with a label from <code>10</code> classes:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># visualize dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imshow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">train_images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">59999</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> cmap </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;gray&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Tensorflow Transfer Learning" src="data:image/png;base64,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Y8aMuOyyy2LNmjVx5MiRWoxHZhpqPQDjw6FDh2JoaCja2tpG3d7W1ha//vWvazRV9S1atCieeOKJuOSSS2L//v3x0EMPxRe/+MV48803o7m5udbj1UxXV1dExCmvj9/dl4vly5fHjTfeGPPmzYudO3fG3/3d38WKFStiy5YtUV9fX+vxTrvh4eG455574qqrrorLLrssIk5eD01NTTFt2rRR+47n6+FU5yEi4mtf+1rMnTs3Ojo64o033ohvf/vbsX379vjJT35Sw2nJgQIIp9GKFStG/rxgwYJYtGhRzJ07N55++um4/fbbazgZZ4qbb7555M/z58+PBQsWxIUXXhgbN26MJUuW1HCysdHZ2RlvvvlmNs+F/TAfdh7uvPPOkT/Pnz8/Zs2aFUuWLImdO3fGhRdeWO0xyYhfAXNazJgxI+rr6z/wKr4DBw5Ee3t7jaaqvWnTpsWnP/3p2LFjR61HqanfXQOujw+64IILYsaMGePyGrnrrrvihRdeiJ///Ocxe/bskdvb29vj+PHj0d3dPWr/8Xo9fNh5OJVFixZFRIzL64EziwLIadHU1BSXX355bNiwYeS24eHh2LBhQyxevLiGk9VWX19f7Ny5M2bNmlXrUWpq3rx50d7ePur66O3tjVdffTXr6yMiYu/evXH48OFxdY0URRF33XVXPPvss/Gzn/0s5s2bN+r+yy+/PBobG0ddD9u3b4/du3ePq+vho87Dqbz++usREePqeuDM5FfAnDarV6+OVatWxec+97m48sor45FHHon+/v647bbbaj1a1XzrW9+K66+/PubOnRv79u2LBx98MOrr6+OWW26p9Whjrq+vb9Sqxa5du+L111+P1tbWOO+88+Kee+6J733ve3HxxRfHvHnz4v7774+Ojo644YYbajf0GPhj56G1tTUeeuihWLlyZbS3t8fOnTvjvvvui4suuiiWLVtWw6lPr87Ozli/fn08//zz0dzcPPK8vpaWlpg4cWK0tLTE7bffHqtXr47W1taYOnVq3H333bF48eL4/Oc/X+PpT5+POg87d+6M9evXx5e+9KWYPn16vPHGG3HvvffG1VdfHQsWLKjx9Ix7tX4ZMuPLv/zLvxTnnXde0dTUVFx55ZXF1q1baz1SVd10003FrFmziqampuJTn/pUcdNNNxU7duyo9VhV8fOf/7yIiA9sq1atKori5H8Fc//99xdtbW1FuVwulixZUmzfvr22Q4+BP3Yejhw5Ulx33XXFueeeWzQ2NhZz584t7rjjjqKrq6vWY59Wp/r7R0Tx+OOPj+xz9OjR4q//+q+Lc845p5g0aVLx1a9+tdi/f3/thh4DH3Uedu/eXVx99dVFa2trUS6Xi4suuqj427/926Knp6e2g5OFUlEURTULJwAAteU5gAAAmVEAAQAyowACAGRGAQQAyIwCCACQGQUQACAzCiAAQGYUQACAzCiAAACZUQABADKjAAIAZEYBBADIjAIIAJAZBRAAIDMKIABAZhRAAIDMKIAAAJlRAAEAMqMAAgBkRgEEAMiMAggAkBkFEAAgMwogAEBmFEAAgMwogAAAmVEAAQAyowACAGRGAQQAyIwCCACQGQUQACAzCiAAQGb+H916fZfC/tSuAAAAAElFTkSuQmCC" width="640" height="480" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-the-generator">Building the Generator<a class="hash-link" href="#building-the-generator" title="Direct link to heading">​</a></h2><p>The Discriminator expects an image as provided by the Fashion mnist dataset - grayscale and with the dimensions 28px times 28px. We can mow build a generator function that based from a random noise seed can generate an image like that:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># build image generator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## the generator should take noise and transform it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## into something the discriminator accepts as a true image</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">make_generator_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">256</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> use_bias</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> input_shape</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">BatchNormalization</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">LeakyReLU</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Reshape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">256</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Because we used &quot;same&quot; padding and stride = 1, the output is the same size as input 7 x 7 but with 128 filters instead</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2DTranspose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strides</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;same&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> use_bias</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">BatchNormalization</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">LeakyReLU</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Because we used &quot;same&quot; padding and stride = 2, the output is double the size of the input 14 x 14 but with 64 filters instead</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2DTranspose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strides</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;same&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> use_bias</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">BatchNormalization</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">LeakyReLU</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Because we used &quot;same&quot; padding and stride = 2, the output is double the size of the input 28 x 28 but with 1 filter instead</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2DTranspose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strides</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;same&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> use_bias</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> activation</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;tanh&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">summary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> model</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">generator </span><span class="token operator">=</span><span class="token plain"> make_generator_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The final layer outputs an image representation with the dimensions <code>(None, 28, 28, 1)</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Model: </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sequential&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">_________________________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Layer </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                Output Shape              Param </span><span class="token comment" style="color:rgb(98, 114, 164)">#   </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> dense </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Dense</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">               </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">12544</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">             </span><span class="token number">1254400</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> batch_normalization </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BatchN  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">12544</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">            </span><span class="token number">50176</span><span class="token plain">     </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ormalization</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                                                   </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> leaky_re_lu </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">LeakyReLU</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">     </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">12544</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">             </span><span class="token number">0</span><span class="token plain">         </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> reshape </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Reshape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">           </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">7</span><span class="token plain">, </span><span class="token number">7</span><span class="token plain">, </span><span class="token number">256</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain">         </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> conv2d_transpose </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Conv2DTra  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">7</span><span class="token plain">, </span><span class="token number">7</span><span class="token plain">, </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">        </span><span class="token number">819200</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> nspose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                                                         </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> batch_normalization_1 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Batc  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">7</span><span class="token plain">, </span><span class="token number">7</span><span class="token plain">, </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">        </span><span class="token number">512</span><span class="token plain">       </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> hNormalization</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> leaky_re_lu_1 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">LeakyReLU</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">7</span><span class="token plain">, </span><span class="token number">7</span><span class="token plain">, </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain">         </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> conv2d_transpose_1 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Conv2DT  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">14</span><span class="token plain">, </span><span class="token number">14</span><span class="token plain">, </span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">       </span><span class="token number">204800</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ranspose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                                                       </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> batch_normalization_2 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Batc  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">14</span><span class="token plain">, </span><span class="token number">14</span><span class="token plain">, </span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">       </span><span class="token number">256</span><span class="token plain">       </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> hNormalization</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> leaky_re_lu_2 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">LeakyReLU</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">14</span><span class="token plain">, </span><span class="token number">14</span><span class="token plain">, </span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">        </span><span class="token number">0</span><span class="token plain">         </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> conv2d_transpose_2 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Conv2DT  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">None, </span><span class="token number">28</span><span class="token plain">, </span><span class="token number">28</span><span class="token plain">, </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">        </span><span class="token number">1600</span><span class="token plain">      </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ranspose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                                                       </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                                 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Total params: </span><span class="token number">2,330</span><span class="token plain">,944</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Trainable params: </span><span class="token number">2,305</span><span class="token plain">,472</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Non-trainable params: </span><span class="token number">25,472</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">_________________________________________________________________</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Since we are not yet providing any training the entire function will just take any noise and upscale it to our image dimensions:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># run the generator with a random noise seed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">noise </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">generated_image </span><span class="token operator">=</span><span class="token plain"> generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">noise</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> training</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">generated_image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imshow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">generated_image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> cmap</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;gray&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The generated image shape is <code>(1, 28, 28, 1)</code> and is represented by:</p><p><img loading="lazy" alt="Tensorflow Transfer Learning" src="/assets/images/Tensorflow_Transfer_Learning_02-040d0c721709afd4b5d75eab81f890c9.png" width="640" height="480" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-the-discriminator">Building the Discriminator<a class="hash-link" href="#building-the-discriminator" title="Direct link to heading">​</a></h2><p>Now that we have our generator - that takes in noise and transforms them into whatever we want to train him to do - we can now build the discriminator - who&#x27;s task it is going to be to evaluate those generated images (or data in general):</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># build image discriminator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">make_discriminator_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strides</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;same&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> input_shape</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">LeakyReLU</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Dropout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strides</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> padding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;same&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">LeakyReLU</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Dropout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Flatten</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">## the input image is reduced to a single output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">## yes/no - how close is this image to a true image</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">summary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> model</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">discriminator </span><span class="token operator">=</span><span class="token plain"> make_discriminator_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we can take the generated image from before and let the - yet to be trained - discriminator decide if it is a real image or not:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">## feed random seed generated image to discriminator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## the model will have to be trained to output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## positive =&gt; real images / negative =&gt; detected false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">decision </span><span class="token operator">=</span><span class="token plain"> discriminator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">generated_image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Decision: &quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> decision</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Currently, the output is not yet that helpful. The discriminator decided that the noisy input is <code>0.00307573</code> - which means nothing. yet:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Decision</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">  tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Tensor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0.00307573</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> shape</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dtype</span><span class="token operator">=</span><span class="token plain">float32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="loss-function">Loss Function<a class="hash-link" href="#loss-function" title="Direct link to heading">​</a></h2><p>To be able to give feedback on the performance of the prediction model we need a numeric representation of it. For the discriminator training we can compare it&#x27;s prediction to <code>1</code> when the input image was a true image from our training dataset and compare it to <code>0</code> for fake, generated images:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># define loss function that calculates the difference</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># between a model prediction and the the true label</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cross_entropy </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">BinaryCrossentropy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">from_logits</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## discriminator loss compares predictions on true images to an array of 1s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">## and predictions on generated images to an array of 0s.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">discriminator_loss</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">real_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> fake_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    real_loss </span><span class="token operator">=</span><span class="token plain"> cross_entropy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ones_like</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">real_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> real_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fake_loss </span><span class="token operator">=</span><span class="token plain"> cross_entropy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">zeros_like</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fake_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> fake_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    total_loss </span><span class="token operator">=</span><span class="token plain"> real_loss </span><span class="token operator">+</span><span class="token plain"> fake_loss </span><span class="token comment" style="color:rgb(98, 114, 164)"># sum up both losses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> total_loss</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>During the training Tensorflow will try to minimize this loss - the deviation from the expected value. So that every true image will result in a value close to <code>1</code> and every fake one will end up with <code>0</code>.</p><p>So with the discriminator training set we now need to quantify the generator performance. Here the optimum performance is reached when the discriminator judges the generated image to be a true image and assigns it a value close to <code>1</code>:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">## generator loss is low when it&#x27;s output is judged as a `1` by the discriminator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">generator_loss</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fake_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    gen_loss </span><span class="token operator">=</span><span class="token plain"> cross_entropy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ones_like</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fake_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> fake_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> gen_loss</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="model-training">Model Training<a class="hash-link" href="#model-training" title="Direct link to heading">​</a></h2><p>Before running the training we can define <strong>Checkpoints</strong> that allow us to use the weights generated by an earlier training:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">checkpoint_dir </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;./training_checkpoints&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">checkpoint_prefix </span><span class="token operator">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">checkpoint_dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ckpt&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">checkpoint </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Checkpoint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">generator_optimizer</span><span class="token operator">=</span><span class="token plain">generator_optimizer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                 discriminator_optimizer</span><span class="token operator">=</span><span class="token plain">discriminator_optimizer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                 generator</span><span class="token operator">=</span><span class="token plain">generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                 discriminator</span><span class="token operator">=</span><span class="token plain">discriminator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we can take both the discriminator and generator and train them to minimize their respective loss functions. The training steps are defined as:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">## training steps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:rgb(248, 248, 242)">@tf</span><span class="token decorator annotation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token decorator annotation punctuation" style="color:rgb(248, 248, 242)">function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">train_step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">## generate random noise as generator input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    noise </span><span class="token operator">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">BATCH_SIZE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> noise_dim</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">GradientTape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> gen_tape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">GradientTape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> disc_tape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">## call the generator and feed in the noise seed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      generated_images </span><span class="token operator">=</span><span class="token plain"> generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">noise</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> training</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">## pass the true images to discriminator to perform classification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      real_output </span><span class="token operator">=</span><span class="token plain"> discriminator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> training</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">## pass the generated images to discriminator to perform classification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      fake_output </span><span class="token operator">=</span><span class="token plain"> discriminator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">generated_images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> training</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">## generator loss function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      gen_loss </span><span class="token operator">=</span><span class="token plain"> generator_loss</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fake_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">## discriminator loss function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      disc_loss </span><span class="token operator">=</span><span class="token plain"> discriminator_loss</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">real_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> fake_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">## calculate the gradient of the losses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    gradients_of_generator </span><span class="token operator">=</span><span class="token plain"> gen_tape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">gradient</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gen_loss</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">trainable_variables</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    gradients_of_discriminator </span><span class="token operator">=</span><span class="token plain"> disc_tape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">gradient</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">disc_loss</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> discriminator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">trainable_variables</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">## apply the optimizers and update weights</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    generator_optimizer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">apply_gradients</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gradients_of_generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">trainable_variables</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    discriminator_optimizer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">apply_gradients</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gradients_of_discriminator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> discriminator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">trainable_variables</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Those steps will be handled by the training function:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">## training function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dataset</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> epochs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> epoch </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">epochs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    start </span><span class="token operator">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> image_batch </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      train_step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">image_batch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">## save images that are being generated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    display</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">clear_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">wait</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    generate_and_save_images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                             epoch </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                             seed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">## create checkpoint every 15 epochs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">epoch </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">%</span><span class="token plain"> </span><span class="token number">15</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      checkpoint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">save</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">file_prefix </span><span class="token operator">=</span><span class="token plain"> checkpoint_prefix</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Time for epoch {} is {} sec&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">epoch </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">-</span><span class="token plain">start</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">## generate after the final epoch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  display</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">clear_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">wait</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  generate_and_save_images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                           epochs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                           seed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The training function will display the generated images  after each epoch and allows us to follow the progress of the training:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">## create visual representation of generated images over epochs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">generate_and_save_images</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> epoch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> test_input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  predictions </span><span class="token operator">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">test_input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> training</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  fig </span><span class="token operator">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">figure</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">figsize</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">predictions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subplot</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imshow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">predictions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token number">127.5</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">127.5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> cmap</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;gray&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">axis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;off&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">savefig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;image_at_epoch_{:04d}.png&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">epoch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Tensorflow Transfer Learning" src="/assets/images/timelapse-c8ceb2801f0787167cbcd0e2be622279.gif" width="400" height="400" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/python">Python</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/machine-learning">Machine Learning</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/tensorflow">Tensorflow</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2022-12-28-tf-gan-image-generator/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/IoT-and-Machine-Learning/ML/2022-12-31-tf-rnn-text-generation/2022-12-31"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Recurrent Neural Networks</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/IoT-and-Machine-Learning/ML/2022-12-21-tf-downsampling/2022-12-21"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tensorflow Downsampling</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#training-dataset" class="table-of-contents__link toc-highlight">Training Dataset</a></li><li><a href="#building-the-generator" class="table-of-contents__link toc-highlight">Building the Generator</a></li><li><a href="#building-the-discriminator" class="table-of-contents__link toc-highlight">Building the Discriminator</a></li><li><a href="#loss-function" class="table-of-contents__link toc-highlight">Loss Function</a></li><li><a href="#model-training" class="table-of-contents__link toc-highlight">Model Training</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.23698315.js"></script>
<script src="/assets/js/main.2d20e69f.js"></script>
</body>
</html>