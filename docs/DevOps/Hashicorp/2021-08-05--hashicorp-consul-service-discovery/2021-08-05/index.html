<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-DevOps/Hashicorp/2021-08-05--hashicorp-consul-service-discovery/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Hashicorp Consul Refresher - Service Discovery | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/DevOps/Hashicorp/2021-08-05--hashicorp-consul-service-discovery/2021-08-05"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Hashicorp Consul Refresher - Service Discovery | Mike Polinowski"><meta data-rh="true" name="description" content="Cheung Chau, Hongkong"><meta data-rh="true" property="og:description" content="Cheung Chau, Hongkong"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/DevOps/Hashicorp/2021-08-05--hashicorp-consul-service-discovery/2021-08-05"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/DevOps/Hashicorp/2021-08-05--hashicorp-consul-service-discovery/2021-08-05" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/DevOps/Hashicorp/2021-08-05--hashicorp-consul-service-discovery/2021-08-05" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.714c4925.css">
<link rel="preload" href="/assets/js/runtime~main.23698315.js" as="script">
<link rel="preload" href="/assets/js/main.2d20e69f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/hashicorp">Hashicorp</a><button aria-label="Toggle the collapsible sidebar category &#x27;Hashicorp&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-12-07-hashicorp-vault-ca-certificates/2022-12-07">Hashicorp Vault - Certificate Authority</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-12-05-hashicorp-consul-vault-certificates-part3/2022-12-05">Hashicorp Consul - Vault Cert Management Part 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-12-05-hashicorp-consul-vault-certificates-part2/2022-12-05">Hashicorp Consul - Vault Cert Management Part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-12-04-hashicorp-consul-vault-certificates-part1/2022-12-04">Hashicorp Consul - Vault Cert Management Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-12-03-hashicorp-vault-installation/2022-12-03">Hashicorp Vault - Installation 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-11-24-hashicorp-consul-connect/2022-11-24">Hashicorp Nomad - Working with Consul Connect</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-11-18-hashicorp-nomad-grav/2022-11-18">Deploy Grav CMS with Hashicorp Nomad</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-11-16-hashicorp-nomad-mautic/2022-11-16">Deploy Mautic with Hashicorp Nomad</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-11-15-hashicorp-nomad-nginx-load-balancing/2022-11-15">Hashicorp Nomad for NGINX Load-balancing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-11-15-hashicorp-nomad-balanced-nts/2022-11-15">Hashicorp Nomad Secure &amp; Balanced NTS Time Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-11-12-hashicorp-nomad-certbot-renewal/2022-11-12">Hashicorp Nomad to Renew your TLS Certificates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-11-11-hashicorp-nomad-for-borg-backups/2022-11-11">Hashicorp Nomad to run periodic backups</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-10-25-hashicorp-nomad-for-osticket-part-ii/2022-10-25">Hashicorp Nomad to set up an OSTicket Helpdesk - Part II</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-10-23-hashicorp-nomad-ports/2022-10-23">Hashicorp Nomad - Working with Ports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-10-23-hashicorp-consul-connect/2022-10-23">Hashicorp Nomad - Working with Consul Connect</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-10-22-hashicorp-nomad-sidecar-pattern/2022-10-22">Hashicorp Nomad Sidecar Pattern</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-10-21-hashicorp-nomad-for-osticket-part-i/2022-10-21">Hashicorp Nomad to set up an OSTicket Helpdesk - Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-09-24--nomad-nginx-ingress/2022-09-24">NGINX Ingress with Nomad</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-09-22--nomad-nts-timeserver/2022-09-22">Secure Timeserver - Deploying a NTS Server using Hashicorp Nomad</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-06-08-hashicorp-waypoint-nomad/2022-06-09">Hashicorp Waypoint with Nomad</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-06-07-hashicorp-waypoint-docker/2022-06-07">Hashicorp Waypoint with Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-29-hashicorp-nomad-with-nginx-loadbalancer/2022-05-29">Hashicorp Nomad with NGINX Loadbalancer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-28-hashicorp-nomad-for-elastic-part-2/2022-05-28">Hashicorp Nomad to set up an Elasticsearch Cluster Part II</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-27-hashicorp-nomad-for-elastic/2022-05-27">Hashicorp Nomad to set up an Elasticsearch Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-26-hashicorp-nomad-with-gitlab-part-2/2022-05-26">App Deployment with Hashicorp Nomad from Gitlab Part Deux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-25-hashicorp-nomad-with-gitlab/2022-05-25">App Deployment with Hashicorp Nomad from Gitlab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-24-hashicorp-nomad-with-nginx/2022-05-24">Hashicorp Nomad for NGINX Web Proxies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-22-hashicorp-dojo-nomad-consul-part-2/2022-05-22">Hashicorp Nomad with Consul II - The Reckoning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-21-hashicorp-dojo-consul-refresher/2022-05-21">Hashicorp Dojo Consul Refresher</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-20-hashicorp-dojo-nomad-consul/2022-05-20">Hashicorp Nomad with Consul Service Discovery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-19-hashicorp-dojo-nomad-access-control/2022-05-19">Hashicorp Nomad Access Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-18-hashicorp-dojo-nomad-adding-encryption/2022-05-18">Hashicorp Nomad Adding Encryption to your Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-17-hashicorp-dojo-nomad-deployment/2022-05-17">Hashicorp Nomad Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-16-hashicorp-dojo-nomad-starter/2022-05-16">Hashicorp Nomad Dojo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2022-05-15-hashicorp-nomad-refresher/2022-05-15">Hashicorp Nomad Refresher</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-10-11--hashicorp-consul-in-production/2021-10-11">Hashicorp Consul in Production</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-10-10--hashicorp-nomad-in-production/2021-10-10">Hashicorp Nomad in Production</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-09-06--hashicorp-terraform-providers-variables-attributes/2021-09-07">Hashicorp Terraform - Providers, Variables &amp; Attributes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-09-05--hashicorp-terraform-setup/2021-09-05">Hashicorp Terraform - Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-25--hashicorp-vault-logging/2021-08-25">Hashicorp Vault - Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-23--hashicorp-vault-rest-api/2021-08-23">Hashicorp Vault - Rest API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-22--hashicorp-vault-policies/2021-08-22">Hashicorp Vault - ACL Policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-21--hashicorp-vault-secrets-tokens/2021-08-21">Hashicorp Vault - Secrets &amp; Tokens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-20--hashicorp-vault-setup/2021-08-20">Hashicorp Vault - Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-14--hashicorp-consul-tls-encryption/2021-08-14">Hashicorp Consul Refresher - Gossip TLS Encryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-13--hashicorp-consul-access-control-lists/2021-08-13">Hashicorp Consul Refresher - Access Control Lists</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-12--hashicorp-consul-service-mesh/2021-08-12">Hashicorp Consul Refresher - Service Mesh</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-11--hashicorp-consul-backups/2021-08-11">Hashicorp Consul Refresher - Backups</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-10--hashicorp-consul-key-value-store/2021-08-10">Hashicorp Consul Refresher - Key Value Store</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-09--hashicorp-consul-services/2021-08-09">Hashicorp Consul Refresher - Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-08--hashicorp-nomad-access-control-lists/2021-08-08">Nomad Access Control Lists</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-07--hashicorp-nomad-job-configuration/2021-08-07">Nomad Job Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-06--hashicorp-consul-traefik-loadbalancing/2021-08-06">Hashicorp Consul Refresher - Loadbalancing with Traefik</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-06--hashicorp-consul-fabio-loadbalancing/2021-08-06">Hashicorp Consul Refresher - Loadbalancing with Fabio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-05--hashicorp-consul-service-discovery/2021-08-05">Hashicorp Consul Refresher - Service Discovery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-04--hashicorp-nomad-job-specifications/2021-08-04">Hashicorp Nomad Refresher - Job Specifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-03--hashicorp-nomad-jobs/2021-08-03">Hashicorp Nomad Refresher - Jobs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-02--hashicorp-nomad-security/2021-08-02">Hashicorp Nomad Refresher - Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2021-08-01--hashicorp-nomad-refresher/2021-08-01">Hashicorp Nomad Refresher - Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2020-10-26--hashicorp-packer-provisioner/2020-10-26">HashiCorp Packer Provisioning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2020-10-25--hashicorp-packer-and-virtualbox-autoinstall/2020-10-25">HashiCorp Packer with Virtualbox (Autoinstall)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2020-10-24--hashicorp-packer-and-virtualbox-preseed/2020-10-24">HashiCorp Packer with Virtualbox (Preseed)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2020-10-23--hashicorp-packer-machine-image/2020-10-23">HashiCorp Packer Machine Images Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2020-08-19--consul-deployment-guide/2020-08-19">Consul Deployment Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2020-08-18--consul-service-mesh/2020-08-18">Consul Service Mesh</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2020-08-18--consul-mock-datacenter/2020-08-19">Joining Consul Clients</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2020-08-17--installing-consul-ubuntu/2020-08-17">Installing HashiCorp Consul on Ubuntu Server 20.04</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2020-08-16--nomad-cluster/2020-08-16">Nomad Server Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Hashicorp/2020-08-15--installing-nomad-ubuntu/2020-08-15">Installing HashiCorp Nomad on Ubuntu Server 20.04</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/zabbix">Zabbix</a><button aria-label="Toggle the collapsible sidebar category &#x27;Zabbix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/server-provisioning">Server Provisioning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Server Provisioning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/gitops">GitOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;GitOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/kubernetes">Kubernetes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/nginx">NGINX</a><button aria-label="Toggle the collapsible sidebar category &#x27;NGINX&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/elasticsearch">Elasticsearch</a><button aria-label="Toggle the collapsible sidebar category &#x27;Elasticsearch&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/ansible">Ansible</a><button aria-label="Toggle the collapsible sidebar category &#x27;Ansible&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/server-security">Server Security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Server Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/linux">Linux</a><button aria-label="Toggle the collapsible sidebar category &#x27;Linux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/windows">Windows</a><button aria-label="Toggle the collapsible sidebar category &#x27;Windows&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/tomcat">Tomcat</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tomcat&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/salt">Salt</a><button aria-label="Toggle the collapsible sidebar category &#x27;Salt&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/internet-of-things--machine-learning">Internet-of-Things &amp; Machine Learning</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internet-of-Things &amp; Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/devops"><span itemprop="name">DevOps</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/hashicorp"><span itemprop="name">Hashicorp</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Hashicorp Consul Refresher - Service Discovery</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Hashicorp Consul Refresher - Service Discovery</h1></header><p><img loading="lazy" alt="Cheung Chau, Hongkong" src="/assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-825ad0c1979a3b8d8834b2806be1b28e.jpg" width="1500" height="386" class="img_ev3q"></p><blockquote><p>This article is a bit messy... a lot of things changed since the <code>0.x</code> releases of Consul and I ran into a few bumps on the way. A lot of things learnt, errors and solution documented. But I will have to write up a clean version of this to have a step-by-step guide for future reference.</p></blockquote><ul><li><a href="#installation">Installation</a><ul><li><a href="#debian11">Debian11</a></li><li><a href="#rhel8">RHEL8</a><ul><li><a href="#consul-commandline-autocompletion">Consul Commandline Autocompletion</a></li></ul></li></ul></li><li><a href="#test-running">Test-Running</a></li><li><a href="#service-configuration">Service Configuration</a></li><li><a href="#run-consul-as-a-service">Run Consul as a Service</a><ul><li><a href="#needed-ports">Needed Ports</a></li></ul></li><li><a href="#service-configuration-1">Service Configuration</a><ul><li><a href="#problems">Problems</a></li></ul></li><li><a href="#registering-a-service-in-nomad">Registering a Service in Nomad</a></li><li><a href="#default-consul-configuration">Default Consul Configuration</a></li><li><a href="#consul-service-error-message">Consul Service Error Message</a></li></ul><p>Nomad schedules workloads of various types across a cluster of generic hosts. Because of this, placement is not known in advance and you will need to use service discovery to connect tasks to other services deployed across your cluster. Nomad integrates with Consul to provide service discovery and monitoring.</p><p><a href="https://www.consul.io/" target="_blank" rel="noopener noreferrer">Consul</a> allows services to easily register themselves in a central catalog when they start up. When an application or service needs to communicate with another component, the central catalog can be queried using either an API or DNS interface to provide the required addresses.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a class="hash-link" href="#installation" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="debian11">Debian11<a class="hash-link" href="#debian11" title="Direct link to heading">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> -fsSL https://apt.releases.hashicorp.com/gpg </span><span class="token operator">|</span><span class="token plain"> apt-key </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> -</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">apt-add-repository </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;deb [arch=amd64] https://apt.releases.hashicorp.com </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">lsb_release -cs</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> main&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> update </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> consul</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rhel8">RHEL8<a class="hash-link" href="#rhel8" title="Direct link to heading">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> yum </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> -y yum-utils</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> yum-config-manager --add-repo https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> yum -y </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> consul</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="consul-commandline-autocompletion">Consul Commandline Autocompletion<a class="hash-link" href="#consul-commandline-autocompletion" title="Direct link to heading">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul -autocomplete-install</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">complete -C /usr/bin/consul consul</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-running">Test-Running<a class="hash-link" href="#test-running" title="Direct link to heading">​</a></h2><p>You can start the Consul Agent with <a href="https://www.consul.io/docs/agent/options#command-line-options" target="_blank" rel="noopener noreferrer">configuration flags</a>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul agent -datacenter</span><span class="token operator">=</span><span class="token plain">instaryun -data-dir</span><span class="token operator">=</span><span class="token plain">/opt/consul -bind </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;{{ GetInterfaceIP &quot;enp2s0&quot; }}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To get started I will execute the service in DEV mode on my master:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul agent -dev -datacenter</span><span class="token operator">=</span><span class="token plain">instaryun -data-dir</span><span class="token operator">=</span><span class="token plain">/opt/consul -bind </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;{{ GetInterfaceIP &quot;enp3s0&quot; }}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The Consul server GUI will be available on Port <code>8500</code> and I can tunnel it through SSH with:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> myuser@192.168.2.110 -L8500:localhost:8500</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Hashicorp Consul" src="/assets/images/Hashicorp_Consul_01-7fe7c1a0275a1539d314e6887332c91b.png" width="1140" height="459" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="service-configuration">Service Configuration<a class="hash-link" href="#service-configuration" title="Direct link to heading">​</a></h2><p>Again - just like with Nomad - I discovered that the default config is missing on Debian11, while it is located in <code>/etc/consul.d/</code> on RHEL8. I will list the default <code>consul.hcl</code> config at <a href="#default-consul-configuration">end of this article</a>.</p><p>We can use this configuration file - instead of adding all variables to the <code>consul agent</code> command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/consul agent -config-file</span><span class="token operator">=</span><span class="token plain">/etc/consul.d/consul.hcl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/consul agent -config-dir</span><span class="token operator">=</span><span class="token plain">/etc/consul.d</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can now <a href="https://www.consul.io/docs/agent/options" target="_blank" rel="noopener noreferrer">add the our configuration</a> to <a href="#default-consul-configuration">/etc/consul.d/consul.hcl</a>:</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">node_name = &quot;consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">master&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">datacenter = &quot;instaryun&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data_dir = &quot;/opt/consul&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># allow all clients</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">client_addr = &quot;0.0.0.0&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># enable the ui</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ui_config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  enabled = true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># make this instance the master server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server = true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># add your servers IP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bind_addr = &quot;192.168.2.110&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">advertise_addr = &quot;192.168.2.110&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># For testing I only have 1 - later 5 master servers are recommended</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bootstrap_expect=1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># I only have 1 other client server. Set it to allow constant retries because it is not yet configured</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">retry_join = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;192.168.2.111&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">enable_syslog = true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">log_level = &quot;INFO&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># https://www.consul.io/docs/agent/options#performance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">performance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  raft_multiplier = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can test run the configuration file - see if it is throwing us any errors:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/consul agent -config-file</span><span class="token operator">=</span><span class="token plain">/etc/consul.d/consul.hcl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Or run the Test command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul validate /etc/consul.d/consul.hcl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">BootstrapExpect is </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> to </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> this is the same as Bootstrap mode.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bootstrap </span><span class="token operator">=</span><span class="token plain"> true: </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"> not </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">enable</span><span class="token plain"> unless necessary</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Configuration is valid</span><span class="token operator">!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="run-consul-as-a-service">Run Consul as a Service<a class="hash-link" href="#run-consul-as-a-service" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="needed-ports">Needed Ports<a class="hash-link" href="#needed-ports" title="Direct link to heading">​</a></h3><p>Consul uses 3 ports:</p><ol><li><code>8500</code> - Consul UI</li><li><code>8301</code> / <code>8300</code> - LAN Gossip</li><li><code>8600</code> - DNS</li></ol><p>I will open those ports in my firewall (except the UI):</p><p><strong>FirewallD</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> firewall-cmd --permanent --zone</span><span class="token operator">=</span><span class="token plain">public --add-port</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token number">8300</span><span class="token plain">/tcp,8301/tcp,8600/tcp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> firewall-cmd --reload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> firewall-cmd --zone</span><span class="token operator">=</span><span class="token plain">public --list-ports</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>ufw</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ufw allow </span><span class="token number">8301,8600</span><span class="token plain">/tcp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ufw reload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ufw status verbose</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>The documentation I found said that the Gossip port is <code>3001</code>. But when I started Consul up the first time it tried to connect through port <code>3000</code> and the cluster join failed. But the next day Consul started using <code>3001</code> ¯<!-- -->\<em>(ツ)</em>/¯</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent.client: RPC failed to server: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">method</span><span class="token operator">=</span><span class="token plain">KVS.List </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">server</span><span class="token operator">=</span><span class="token number">192.168</span><span class="token plain">.2.110:8300 </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">error</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;rpc error getting client: failed to get conn: dial tcp 192.168.2.111:0-&gt;192.168.2.110:8300: connect: no route to host&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>Update</strong>: See above - happened again. It seems that you need both port <code>8300</code> and <code>8301</code>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="service-configuration-1">Service Configuration<a class="hash-link" href="#service-configuration-1" title="Direct link to heading">​</a></h2><p>Create the <a href="https://learn.hashicorp.com/tutorials/consul/deployment-guide#configure-systemd" target="_blank" rel="noopener noreferrer">SystemD Service file</a> in <code>/etc/systemd/system/consul.service</code>:</p><div class="language-cfg codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cfg codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Description=&quot;HashiCorp Consul&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Documentation=https://www.consul.io/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Requires=network-online.target</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">After=network-online.target</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ConditionFileNotEmpty=/etc/consul.d/consul.hcl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Type=notify</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User=consul</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group=consul</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ExecStart=/usr/bin/consul agent -config-dir=/etc/consul.d/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ExecReload=/bin/kill --signal HUP $MAINPID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">KillMode=process</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">KillSignal=SIGTERM</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Restart=on-failure</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LimitNOFILE=65536</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WantedBy=multi-user.target</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> systemctl daemon-reload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">service</span><span class="token plain"> consul start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problems">Problems<a class="hash-link" href="#problems" title="Direct link to heading">​</a></h3><p>In the beginning I ran into a permission error:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:03:44 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">54505</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token plain"> failed to setup </span><span class="token function" style="color:rgb(80, 250, 123)">node</span><span class="token plain"> ID: </span><span class="token function" style="color:rgb(80, 250, 123)">open</span><span class="token plain"> /opt/consul/node-id: permission denied</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:03:44 nomad-master systemd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: consul.service: Main process exited, </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">code</span><span class="token operator">=</span><span class="token plain">exited, </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">status</span><span class="token operator">=</span><span class="token number">1</span><span class="token plain">/FAILURE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:03:44 nomad-master systemd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: consul.service: Failed with result </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;exit-code&#x27;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As a dirty fix I changed the entire data directory to <code>777</code> /The <a href="https://learn.hashicorp.com/tutorials/consul/deployment-guide#install-consul" target="_blank" rel="noopener noreferrer">deployment guide</a> creates an extra user for consul - I will go this route in the next test run.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> -R </span><span class="token number">777</span><span class="token plain"> /opt/consul</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now the service started but is failing because the Consul minion, that I did not configure yet, is not connecting - <a href="#consul-service-error-message">see Error Log</a>.</p><p>So now I added the identical <strong>Service file</strong> to my Debian11 minion and added the following <strong>Configuration</strong> <code>/etc/consul.d/consul.hcl</code>:</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">node_name = &quot;consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">minion&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">datacenter = &quot;instaryun&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data_dir = &quot;/opt/consul&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># allow all clients</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">client_addr = &quot;0.0.0.0&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># disable the ui</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ui = false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># make this instance the master server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server = false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># add your servers IP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bind_addr = &quot;192.168.2.111&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">advertise_addr = &quot;192.168.2.111&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">retry_join = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;192.168.2.110&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">enable_syslog = true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">log_level = &quot;INFO&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># https://www.consul.io/docs/agent/options#performance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">performance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  raft_multiplier = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that I set <code>server</code> to false, removed the <code>bootstap</code> variable and had to rewrite the <code>ui</code> variable - the latter might be because I am using version <code>Consul v1.8.7</code> while I am on <code>Consul v1.10.2</code> on my master server.</p><p>As an alternative to <code>retry_join</code> I can also manually join this client into an existing cluster with the join command (or leave):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul </span><span class="token function" style="color:rgb(80, 250, 123)">join</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">IP address or domain of one of your Consul servers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul leave</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>This time both services started successfully!</strong> And the UI shows me that both nodes successfully joined the Consul cluster:</p><p><img loading="lazy" alt="Hashicorp Consul" src="/assets/images/Hashicorp_Consul_03-c51dfacf36a0d58ee288f98d07553eb0.png" width="1137" height="388" class="img_ev3q"></p><p><strong>Note</strong>: The node name is taken from the server hostname instead of the Consul configuration file - hence I am having a <strong>Nomad Master</strong> instead of the <strong>consul-master</strong> I defined. To change your servers hostname run the following commands and restart the Consul service:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">hostname</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hostnamectl set-hostname consul-master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">hostname</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">service</span><span class="token plain"> consul restart</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now Consul displays the correct node name:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul operator raft list-peers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Node           ID                                    Address             State   Voter  RaftProtocol</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul-master  d561f8d4-9606-8c9c-40d4-a5350857801e  </span><span class="token number">192.168</span><span class="token plain">.2.110:8300  leader  </span><span class="token boolean">true</span><span class="token plain">   </span><span class="token number">3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul members</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Node           Address             Status  Type    Build   Protocol  DC         Segment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul-master  </span><span class="token number">192.168</span><span class="token plain">.2.110:8301  alive   server  </span><span class="token number">1.10</span><span class="token plain">.2  </span><span class="token number">2</span><span class="token plain">         instaryun  </span><span class="token operator">&lt;</span><span class="token plain">all</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul-minion  </span><span class="token number">192.168</span><span class="token plain">.2.111:8301  alive   client  </span><span class="token number">1.8</span><span class="token plain">.7   </span><span class="token number">2</span><span class="token plain">         instaryun  </span><span class="token operator">&lt;</span><span class="token plain">default</span><span class="token operator">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="registering-a-service-in-nomad">Registering a Service in Nomad<a class="hash-link" href="#registering-a-service-in-nomad" title="Direct link to heading">​</a></h2><p>There are <a href="https://learn.hashicorp.com/consul/getting-started/services" target="_blank" rel="noopener noreferrer">multiple ways to register a service in Consul</a>. Fortunately Nomad has a first class integration that makes it very simple to add a service stanza to a job file to perform this registration for us. To register our Nomad deployed <a href="/docs/DevOps/Hashicorp/2021-08-04--hashicorp-nomad-job-specifications/2021-08-04">http-echo application</a>, we simply add a <a href="https://www.nomadproject.io/docs/job-specification/service" target="_blank" rel="noopener noreferrer">service block</a> to the Nomad job file:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">service </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  name = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http-echo&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  port = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;heartbeat&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  tags = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;heartbeat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;urlprefix-/http-echo&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  check </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    type     = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    path     = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/health&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    interval = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2s&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    timeout  = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2s&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <a href="/docs/DevOps/Hashicorp/2021-08-04--hashicorp-nomad-job-specifications/2021-08-04">http-echo job file</a> now looks like:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> ~/nomad_jobs/http_echo_gui.nomad</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">job </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http-echo-gui&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  datacenters = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;instaryun&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  group </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;echo&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    network </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        port </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;heartbeat&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            static = </span><span class="token number">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    count = </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    task </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;server&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      driver = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;docker&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      config </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        image = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hashicorp/http-echo:latest&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ports = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;heartbeat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        args  = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-listen&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;:${NOMAD_PORT_heartbeat}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-text&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;${attr.os.name}: server running on ${NOMAD_IP_heartbeat} with port ${NOMAD_PORT_heartbeat}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      service </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http-echo&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        port = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;heartbeat&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tags = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;heartbeat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;urlprefix-/http-echo&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        check </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          type     = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          path     = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/health&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          interval = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2s&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          timeout  = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2s&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And can be directly updated from the Nomad GUI:</p><p><img loading="lazy" alt="Hashicorp Consul" src="/assets/images/Hashicorp_Consul_02-027e6c68c37b63220b83614d41c2c957.png" width="1135" height="865" class="img_ev3q"></p><p>First click on <strong>Plan</strong> and then <strong>Run</strong> to schedule the job. Once the task is running, check in Consul if the service <code>http-echo</code> registered itself:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul catalog services</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consul</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http-echo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nomad</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nomad-client</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the Consul UI I can see that the healthcheck URL is working:</p><p><img loading="lazy" alt="Hashicorp Consul" src="/assets/images/Hashicorp_Consul_04-e0e29a4ab71c214b38e276b952bf9272.png" width="1307" height="695" class="img_ev3q"></p><p>You can also test it from your browser with by visiting the URL listed by Consul <code>http://192.168.2.111:8080/health</code>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ok&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="default-consul-configuration">Default Consul Configuration<a class="hash-link" href="#default-consul-configuration" title="Direct link to heading">​</a></h2><p>From the default package manager installation of <em>Consul v1.10.2</em> on RHEL8 in <code>/etc/consul.d/consul.hcl</code>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Full configuration options can be found at https</span><span class="token operator">:</span><span class="token comment" style="color:rgb(98, 114, 164)">//www.consul.io/docs/agent/options.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># datacenter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># This flag controls the datacenter in which the agent is running. If not provided</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># it defaults to </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;dc1&quot;</span><span class="token plain">. Consul has first-class support for multiple datacenters</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> but</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># it relies on proper configuration. Nodes in the same datacenter should be on a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># single LAN.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#datacenter = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;my-dc-1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># data_dir</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># This flag provides a data directory for the agent to store state. This is required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># for all agents. The directory should be durable across reboots. This is especially</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># critical for agents that are running in server mode as they must be able to persist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># cluster state. Additionally</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> the directory must support the use of filesystem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># locking</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> meaning some types of mounted folders (e.g. VirtualBox shared folders) may</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># not be suitable.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data_dir = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/opt/consul&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># client_addr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># The address to which Consul will bind client interfaces</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> including the HTTP and DNS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># servers. By default</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> this is </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;127.0.0.1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> allowing only loopback connections. In</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Consul </span><span class="token number">1.0</span><span class="token plain"> and later this can be set to a space-separated list of addresses to bind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># to</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> or a go-sockaddr template that can potentially resolve to multiple addresses.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#client_addr = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0.0.0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># ui</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Enables the built-in web UI server and the required HTTP routes. This eliminates</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># the need to maintain the Consul web UI files separately from the binary.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Version </span><span class="token number">1.10</span><span class="token plain"> deprecated ui=</span><span class="token boolean">true</span><span class="token plain"> in favor of ui_config.enabled=</span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ui_config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#  enabled = </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># This flag is used to control if an agent is in server or client mode. When provided</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># an agent will act as a Consul server. Each Consul cluster must have at least one</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># server and ideally no more than </span><span class="token number">5</span><span class="token plain"> per datacenter. All servers participate in the Raft</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># consensus algorithm to ensure that transactions occur in a consistent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> linearizable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># manner. Transactions modify cluster state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> which is maintained on all server nodes to</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># ensure availability in the case of node failure. Server nodes also participate in a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># WAN gossip pool with server nodes in other datacenters. Servers act as gateways to</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># other datacenters and forward traffic as appropriate.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#server = </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Bind addr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># You may use IPv4 or IPv6 but if you have multiple interfaces you must be explicit.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#bind_addr = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[::]&quot;</span><span class="token plain"> # Listen on all IPv6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#bind_addr = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0.0.0.0&quot;</span><span class="token plain"> # Listen on all IPv4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Advertise addr - if you want to point clients to a different address than bind or LB.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#advertise_addr = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;127.0.0.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Enterprise License</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># As of </span><span class="token number">1.10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> Enterprise requires a license_path and does not have a short trial.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#license_path = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/etc/consul.d/consul.hclic&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># bootstrap_expect</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># This flag provides the number of expected servers in the datacenter. Either this value</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># should not be provided or the value must agree with other servers in the cluster. When</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># provided</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> Consul waits until the specified number of servers are available and then</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># bootstraps the cluster. This allows an initial leader to be elected automatically.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># This cannot be used in conjunction with the legacy -bootstrap flag. This flag requires</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># -server mode.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#bootstrap_expect=</span><span class="token number">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># encrypt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Specifies the secret key to use for encryption of Consul network traffic. This key must</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># be </span><span class="token number">32</span><span class="token plain">-bytes that are Base64-encoded. The easiest way to create an encryption key is to</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># use consul keygen. All nodes within a cluster must share the same encryption key to</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># communicate. The provided key is automatically persisted to the data directory and loaded</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># automatically whenever the agent is restarted. This means that to encrypt Consul&#x27;s gossip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># protocol</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> this option only needs to be provided once on each agent&#x27;s initial startup</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># sequence. If it is provided after Consul has been initialized with an encryption key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># then the provided key is ignored and a warning will be displayed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#encrypt = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># retry_join</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Similar to -join but allows retrying a join until it is successful. Once it joins</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># successfully to a member in a list of members it will never attempt to join again.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Agents will then solely maintain their membership via gossip. This is useful for</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># cases where you know the address will eventually be available. This option can be</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># specified multiple times to specify multiple agents to join. The value can contain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># IPv4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> IPv6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> or DNS addresses. In Consul </span><span class="token number">1.1</span><span class="token plain">.</span><span class="token number">0</span><span class="token plain"> and later this can be set to a go-sockaddr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># template. If Consul is running on the non-default Serf LAN port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> this must be specified</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># as well. IPv6 must use the </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;bracketed&quot;</span><span class="token plain"> syntax. If multiple values are given</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> they are</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># tried and retried in the order listed until the first succeeds. Here are some examples</span><span class="token operator">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#retry_join = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;consul.domain.internal&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#retry_join = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;10.0.4.67&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#retry_join = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[::1]:8301&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#retry_join = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;consul.domain.internal&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;10.0.4.67&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Cloud Auto-join examples</span><span class="token operator">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># More details - https</span><span class="token operator">:</span><span class="token comment" style="color:rgb(98, 114, 164)">//www.consul.io/docs/agent/cloud-auto-join</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#retry_join = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;provider=aws tag_key=... tag_value=...&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#retry_join = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;provider=azure tag_name=... tag_value=... tenant_id=... client_id=... subscription_id=... secret_access_key=...&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#retry_join = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;provider=gce project_name=... tag_value=...&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="consul-service-error-message">Consul Service Error Message<a class="hash-link" href="#consul-service-error-message" title="Direct link to heading">​</a></h2><p><em>see <a href="#problems">Problems</a></em></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">WARN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: DEPRECATED Backwards compatibil</span><span class="token operator">&gt;</span><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: Retry </span><span class="token function" style="color:rgb(80, 250, 123)">join</span><span class="token plain"> is supported </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> the</span><span class="token operator">&gt;</span><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: Joining cluster</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">cluster</span><span class="token operator">=</span><span class="token plain">LAN</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">LAN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> joining: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lan_addresses</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: started state syncer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: Consul agent running</span><span class="token operator">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">WARN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">LAN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> couldn</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;t join: number_of_&gt;Aug 31 14:12:08 nomad-master consul[60088]:         * Failed to join 192.168.2.111: dial tcp 192.168.2.111:8301: connec&gt;Aug 31 14:12:08 nomad-master consul[60088]: &quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:08 nomad-master consul[60088]: 2021-08-31T14:12:08.212+0800 [WARN]  agent: Join cluster failed, will retry&gt;Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.118+0800 [WARN]  agent.server.raft: heartbeat timeout r&gt;Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.118+0800 [INFO]  agent.server.raft: entering candidate &gt;Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.136+0800 [INFO]  agent.server.raft: election won: tally&gt;Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.136+0800 [INFO]  agent.server.raft: entering leader sta&gt;Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.136+0800 [INFO]  agent.server: cluster leadership acqui&gt;Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.136+0800 [INFO]  agent.server: New leader elected: payl&gt;Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.151+0800 [INFO]  agent.leader: started routine: routine&gt;Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.151+0800 [INFO]  agent.leader: started routine: routine&gt;Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.367+0800 [INFO]  agent: Synced node info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:38 nomad-master consul[60088]: 2021-08-31T14:12:38.213+0800 [INFO]  agent: (LAN) joining: lan_addresses=[1&gt;Aug 31 14:12:38 nomad-master consul[60088]: 2021-08-31T14:12:38.214+0800 [WARN]  agent: (LAN) couldn&#x27;</span><span class="token plain">t join: number_of_</span><span class="token operator">&gt;</span><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:38 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">:         * Failed to </span><span class="token function" style="color:rgb(80, 250, 123)">join</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.2.111: dial tcp </span><span class="token number">192.168</span><span class="token plain">.2.111:8301: connec</span><span class="token operator">&gt;</span><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:38 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:38 nomad-master consul[60088]: 2021-08-31T14:12:38.214+0800 [WARN]  agent: Join cluster failed, will retry&gt;Aug 31 14:13:08 nomad-master consul[60088]: 2021-08-31T14:13:08.214+0800 [INFO]  agent: (LAN) joining: lan_addresses=[1&gt;Aug 31 14:13:08 nomad-master consul[60088]: 2021-08-31T14:13:08.214+0800 [WARN]  agent: (LAN) couldn&#x27;t join: number_of_&gt;Aug 31 14:13:08 nomad-master consul[60088]:         * Failed to join 192.168.2.111: dial tcp 192.168.2.111:8301: connec&gt;Aug 31 14:13:08 nomad-master consul[60088]: &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:13:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:13:08.214+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">WARN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: Join cluster failed, will retry</span><span class="token operator">&gt;</span><span class="token plain">lines </span><span class="token number">3908</span><span class="token plain">-3936/3936 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">END</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">WARN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: DEPRECATED Backwards compatibility with pre-1.9 metrics enabled. These metrics will be removed </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> a future version of Consul. Set </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">telemetry </span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">{</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> disable_compat_1.9 </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable boolean" style="color:rgb(189, 147, 249);font-style:italic">true</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">}</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token plain"> to disable them.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: Retry </span><span class="token function" style="color:rgb(80, 250, 123)">join</span><span class="token plain"> is supported </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> the following discovery methods: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">cluster</span><span class="token operator">=</span><span class="token plain">LAN </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">discovery_methods</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;aliyun aws azure digitalocean gce k8s linode mdns os packet scaleway softlayer tencentcloud triton vsphere&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: Joining cluster</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">cluster</span><span class="token operator">=</span><span class="token plain">LAN</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">LAN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> joining: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lan_addresses</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">192.168</span><span class="token plain">.2.111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: started state syncer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: Consul agent running</span><span class="token operator">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:08.212+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">WARN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">LAN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> couldn</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;t join: number_of_nodes=0 error=&quot;1 error occurred:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:08 nomad-master consul[60088]:         * Failed to join 192.168.2.111: dial tcp 192.168.2.111:8301: connect: connection refused</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:08 nomad-master consul[60088]: &quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:08 nomad-master consul[60088]: 2021-08-31T14:12:08.212+0800 [WARN]  agent: Join cluster failed, will retry: cluster=LAN retry_interval=30s error=&lt;nil&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.118+0800 [WARN]  agent.server.raft: heartbeat timeout reached, starting election: last-leader=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.118+0800 [INFO]  agent.server.raft: entering candidate state: node=&quot;Node at 192.168.2.110:8300 [Candidate]&quot; term=5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.136+0800 [INFO]  agent.server.raft: election won: tally=1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.136+0800 [INFO]  agent.server.raft: entering leader state: leader=&quot;Node at 192.168.2.110:8300 [Leader]&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.136+0800 [INFO]  agent.server: cluster leadership acquired</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.136+0800 [INFO]  agent.server: New leader elected: payload=nomad-master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.151+0800 [INFO]  agent.leader: started routine: routine=&quot;federation state anti-entropy&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.151+0800 [INFO]  agent.leader: started routine: routine=&quot;federation state pruning&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:15 nomad-master consul[60088]: 2021-08-31T14:12:15.367+0800 [INFO]  agent: Synced node info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:38 nomad-master consul[60088]: 2021-08-31T14:12:38.213+0800 [INFO]  agent: (LAN) joining: lan_addresses=[192.168.2.111]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:38 nomad-master consul[60088]: 2021-08-31T14:12:38.214+0800 [WARN]  agent: (LAN) couldn&#x27;</span><span class="token plain">t join: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">number_of_nodes</span><span class="token operator">=</span><span class="token number">0</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">error</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1 error occurred:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:38 nomad-master consul[60088]:         * Failed to join 192.168.2.111: dial tcp 192.168.2.111:8301: connect: connection refused</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:12:38 nomad-master consul[60088]: &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:12:38 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:12:38.214+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">WARN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: Join cluster failed, will retry: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">cluster</span><span class="token operator">=</span><span class="token plain">LAN </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">retry_interval</span><span class="token operator">=</span><span class="token plain">30s </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">error</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token plain">nil</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:13:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:13:08.214+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">LAN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> joining: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lan_addresses</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">192.168</span><span class="token plain">.2.111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:13:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:13:08.214+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">WARN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">LAN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> couldn&#x27;t join: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">number_of_nodes</span><span class="token operator">=</span><span class="token number">0</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">error</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1 error occurred:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:13:08 nomad-master consul[60088]:         * Failed to join 192.168.2.111: dial tcp 192.168.2.111:8301: connect: connection refused</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Aug 31 14:13:08 nomad-master consul[60088]: &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aug </span><span class="token number">31</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:13:08 nomad-master consul</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">60088</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: </span><span class="token number">2021</span><span class="token plain">-08-31T14:13:08.214+0800 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">WARN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  agent: Join cluster failed, will retry: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">cluster</span><span class="token operator">=</span><span class="token plain">LAN </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">retry_interval</span><span class="token operator">=</span><span class="token plain">30s </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">error</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token plain">nil</span><span class="token operator">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/consul">Consul</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/linux">Linux</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Hashicorp/2021-08-05--hashicorp-consul-service-discovery/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/DevOps/Hashicorp/2021-08-06--hashicorp-consul-fabio-loadbalancing/2021-08-06"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Hashicorp Consul Refresher - Loadbalancing with Fabio</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/DevOps/Hashicorp/2021-08-04--hashicorp-nomad-job-specifications/2021-08-04"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Hashicorp Nomad Refresher - Job Specifications</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installation" class="table-of-contents__link toc-highlight">Installation</a><ul><li><a href="#debian11" class="table-of-contents__link toc-highlight">Debian11</a></li><li><a href="#rhel8" class="table-of-contents__link toc-highlight">RHEL8</a></li></ul></li><li><a href="#test-running" class="table-of-contents__link toc-highlight">Test-Running</a></li><li><a href="#service-configuration" class="table-of-contents__link toc-highlight">Service Configuration</a></li><li><a href="#run-consul-as-a-service" class="table-of-contents__link toc-highlight">Run Consul as a Service</a><ul><li><a href="#needed-ports" class="table-of-contents__link toc-highlight">Needed Ports</a></li></ul></li><li><a href="#service-configuration-1" class="table-of-contents__link toc-highlight">Service Configuration</a><ul><li><a href="#problems" class="table-of-contents__link toc-highlight">Problems</a></li></ul></li><li><a href="#registering-a-service-in-nomad" class="table-of-contents__link toc-highlight">Registering a Service in Nomad</a></li><li><a href="#default-consul-configuration" class="table-of-contents__link toc-highlight">Default Consul Configuration</a></li><li><a href="#consul-service-error-message" class="table-of-contents__link toc-highlight">Consul Service Error Message</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.23698315.js"></script>
<script src="/assets/js/main.2d20e69f.js"></script>
</body>
</html>